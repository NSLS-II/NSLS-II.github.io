


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>DataBroker Basics &mdash; DataBroker and DataMuxer 0.0.6 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="DataBroker and DataMuxer 0.0.6 documentation" href="index.html"/>
        <link rel="prev" title="What’s new" href="whats_new.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> DataBroker and DataMuxer</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api.html">API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#data-broker">Data Broker</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#data-muxer">Data Muxer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="whats_new.html">What&#8217;s new</a><ul>
<li class="toctree-l2"><a class="reference internal" href="whats_new.html#dataportal-v0-2-2">Dataportal v0.2.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="whats_new.html#dataportal-v0-2-1">Dataportal v0.2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="whats_new.html#dataportal-v0-2-0">Dataportal v0.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="whats_new.html#dataportal-v0-0-6">Dataportal v0.0.6</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">DataBroker Basics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-is-the-data-broker">What is the Data Broker?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quick-start">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-example-plotting-the-most-recent-scan">Basic Example: Plotting The Most Recent Scan</a></li>
<li class="toctree-l2"><a class="reference internal" href="#more-ways-to-look-up-scans">More Ways to Look Up Scans</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">DataBroker and DataMuxer</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>DataBroker Basics</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/basics.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="databroker-basics">
<h1>DataBroker Basics<a class="headerlink" href="#databroker-basics" title="Permalink to this headline">¶</a></h1>
<div class="section" id="what-is-the-data-broker">
<h2>What is the Data Broker?<a class="headerlink" href="#what-is-the-data-broker" title="Permalink to this headline">¶</a></h2>
<p>The Data Broker prodives one interface for retrieving data from all sources.</p>
<p>You, the user, don&#8217;t have to know where the data is stored or in what format
it is stored. The Data Broker returns all the data in one simply-structured
bundle. All measurements are given as standard Python data types (integer,
float, or string) or numpy arrays.</p>
</div>
<div class="section" id="quick-start">
<h2>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h2>
<p>This demonstrates the basic usage with minimal explanation. To understand what
is being done, read the next section.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">dataportal.broker</span> <span class="kn">import</span> <span class="n">DataBroker</span>

<span class="gp">In [2]: </span><span class="kn">from</span> <span class="nn">dataportal.muxer</span> <span class="kn">import</span> <span class="n">DataMuxer</span>

<span class="gp">In [3]: </span><span class="n">header</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c"># get most recent run</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">StopIteration</span><span class="g-Whitespace">                             </span>Traceback (most recent call last)
<span class="nn">/Users/dallan/Documents/Repos/dataportal/dataportal/broker/simple_broker.py</span> in <span class="ni">__getitem__</span><span class="nt">(self, key)</span>
<span class="g-Whitespace">     </span><span class="mi">61</span>                     <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">62</span>                         <span class="n">result</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
<span class="g-Whitespace">     </span><span class="mi">63</span>                     <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>

<span class="ne">StopIteration</span>: 

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">IndexError</span><span class="g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-3-40ed62db5c60&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">header</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c"># get most recent run</span>

<span class="nn">/Users/dallan/Documents/Repos/dataportal/dataportal/broker/simple_broker.py</span> in <span class="ni">__getitem__</span><span class="nt">(self, key)</span>
<span class="g-Whitespace">     </span><span class="mi">63</span>                     <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
<span class="g-Whitespace">     </span><span class="mi">64</span>                         <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
<span class="ne">---&gt; </span><span class="mi">65</span>                             <span class="s">&quot;There are only {0} runs.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="g-Whitespace">     </span><span class="mi">66</span>                 <span class="n">header</span> <span class="o">=</span> <span class="n">Header</span><span class="o">.</span><span class="n">from_run_start</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="g-Whitespace">     </span><span class="mi">67</span>         <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>

<span class="ne">IndexError</span>: There are only 0 runs.

<span class="gp">In [4]: </span><span class="n">events</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="o">.</span><span class="n">fetch_events</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-4-8927db3c3d9f&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 events = DataBroker.fetch_events(header)</span>

<span class="go">NameError: name &#39;header&#39; is not defined</span>

<span class="gp">In [5]: </span><span class="n">dm</span> <span class="o">=</span> <span class="n">DataMuxer</span><span class="o">.</span><span class="n">from_events</span><span class="p">(</span><span class="n">events</span><span class="p">)</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-5-3cf5850c05d5&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 dm = DataMuxer.from_events(events)</span>

<span class="go">NameError: name &#39;events&#39; is not defined</span>

<span class="gp">In [6]: </span><span class="n">dm</span><span class="o">.</span><span class="n">sources</span>  <span class="c"># to review list of data sources</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-6-2cb4e71e1f7c&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 dm.sources  # to review list of data sources</span>

<span class="go">NameError: name &#39;dm&#39; is not defined</span>
</pre></div>
</div>
<p>You can plot individual data sources against time...</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [7]: </span><span class="n">dm</span><span class="p">[</span><span class="s">&#39;Tsam&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>  <span class="c"># or the name of any data source</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-7-2a20c70a1259&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">dm</span><span class="p">[</span><span class="s">&#39;Tsam&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>  <span class="c"># or the name of any data source</span>

<span class="ne">NameError</span>: name &#39;dm&#39; is not defined
</pre></div>
</div>
<p>Or bin the data to plot sources against each other...</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [8]: </span><span class="n">binned_data</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">bin_on</span><span class="p">(</span><span class="s">&#39;point_det&#39;</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-8-5b651beb765a&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">binned_data</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">bin_on</span><span class="p">(</span><span class="s">&#39;point_det&#39;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;dm&#39; is not defined

<span class="gp">In [9]: </span><span class="n">binned_data</span>
<span class="go">                                                                                                                                                                                                                                                                                       ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-9-30d1318b2999&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 binned_data</span>

<span class="go">NameError: name &#39;binned_data&#39; is not defined</span>

<span class="gp">In [10]: </span><span class="n">binned_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&#39;Tsam&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">&#39;point_det&#39;</span><span class="p">)</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-10-0b810db50efb&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 binned_data.plot(x=&#39;Tsam&#39;, y=&#39;point_det&#39;)</span>

<span class="go">NameError: name &#39;binned_data&#39; is not defined</span>
</pre></div>
</div>
<p>And you can easily export to common formats. Among them:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [11]: </span><span class="n">binned_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">&#39;myfile.csv&#39;</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-11-4dc5892d59db&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">binned_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">&#39;myfile.csv&#39;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;binned_data&#39; is not defined

<span class="gp">In [12]: </span><span class="n">binned_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s">&#39;myfile.xlsx&#39;</span><span class="p">)</span>
<span class="go">                                                                                                                                                                                                                                                                                             ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-12-d90efd455eff&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 binned_data.to_excel(&#39;myfile.xlsx&#39;)</span>

<span class="go">NameError: name &#39;binned_data&#39; is not defined</span>
</pre></div>
</div>
</div>
<div class="section" id="basic-example-plotting-the-most-recent-scan">
<h2>Basic Example: Plotting The Most Recent Scan<a class="headerlink" href="#basic-example-plotting-the-most-recent-scan" title="Permalink to this headline">¶</a></h2>
<div class="section" id="looking-at-a-scan">
<h3>Looking at a Scan<a class="headerlink" href="#looking-at-a-scan" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s inspect the most recent run. To get the Nth most recent run,
type <tt class="docutils literal"><span class="pre">DataBroker[-N]</span></tt>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [13]: </span><span class="kn">from</span> <span class="nn">dataportal.broker</span> <span class="kn">import</span> <span class="n">DataBroker</span>

<span class="gp">In [14]: </span><span class="n">header</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">StopIteration</span><span class="g-Whitespace">                             </span>Traceback (most recent call last)
<span class="nn">/Users/dallan/Documents/Repos/dataportal/dataportal/broker/simple_broker.py</span> in <span class="ni">__getitem__</span><span class="nt">(self, key)</span>
<span class="g-Whitespace">     </span><span class="mi">61</span>                     <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">62</span>                         <span class="n">result</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
<span class="g-Whitespace">     </span><span class="mi">63</span>                     <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>

<span class="ne">StopIteration</span>: 

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">IndexError</span><span class="g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-14-7b3cc0ce866a&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">header</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="nn">/Users/dallan/Documents/Repos/dataportal/dataportal/broker/simple_broker.py</span> in <span class="ni">__getitem__</span><span class="nt">(self, key)</span>
<span class="g-Whitespace">     </span><span class="mi">63</span>                     <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
<span class="g-Whitespace">     </span><span class="mi">64</span>                         <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
<span class="ne">---&gt; </span><span class="mi">65</span>                             <span class="s">&quot;There are only {0} runs.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="g-Whitespace">     </span><span class="mi">66</span>                 <span class="n">header</span> <span class="o">=</span> <span class="n">Header</span><span class="o">.</span><span class="n">from_run_start</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="g-Whitespace">     </span><span class="mi">67</span>         <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>

<span class="ne">IndexError</span>: There are only 0 runs.
</pre></div>
</div>
<p>What we get is a Header, a dictionary-like (for C programmers, struct-like)
object with all the information pertaining to a run.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [15]: </span><span class="n">header</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-15-71a15b456dab&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">header</span>

<span class="ne">NameError</span>: name &#39;header&#39; is not defined
</pre></div>
</div>
<p>We can view its complete contents with <tt class="docutils literal"><span class="pre">print</span></tt> or, equivalently,
<tt class="docutils literal"><span class="pre">str(header)</span></tt>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [16]: </span><span class="k">print</span> <span class="n">header</span>
<span class="gt">  File</span><span class="nn"> &quot;&lt;ipython-input-16-1f06858d6d82&gt;&quot;</span><span class="gt">, line </span><span class="mi">1</span>
    <span class="k">print</span> <span class="n">header</span>
               <span class="o">^</span>
<span class="ne">SyntaxError</span>: Missing parentheses in call to &#39;print&#39;
</pre></div>
</div>
<p>You can access the contents like a Python dictionary</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [17]: </span><span class="n">header</span><span class="p">[</span><span class="s">&#39;owner&#39;</span><span class="p">]</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-17-0ca857377bba&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">header</span><span class="p">[</span><span class="s">&#39;owner&#39;</span><span class="p">]</span>

<span class="ne">NameError</span>: name &#39;header&#39; is not defined
</pre></div>
</div>
<p>or, equivalently, an attribute. In IPython, use tab-completion to explore.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [18]: </span><span class="n">header</span><span class="o">.</span><span class="n">owner</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-18-64f2d83cbc3d&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">header</span><span class="o">.</span><span class="n">owner</span>

<span class="ne">NameError</span>: name &#39;header&#39; is not defined
</pre></div>
</div>
</div>
<div class="section" id="getting-the-data-in-its-rawest-form">
<h3>Getting the Data in its Rawest Form<a class="headerlink" href="#getting-the-data-in-its-rawest-form" title="Permalink to this headline">¶</a></h3>
<p>The Header does not contain any of the actual measurements from a run. To get
the data itself, pass <tt class="docutils literal"><span class="pre">header</span></tt> (or a list of several Headers) to <tt class="docutils literal"><span class="pre">fetch_events</span></tt>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [19]: </span><span class="n">events</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="o">.</span><span class="n">fetch_events</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-19-8927db3c3d9f&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">events</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="o">.</span><span class="n">fetch_events</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;header&#39; is not defined
</pre></div>
</div>
<p>The result is a list of Events, each one representing a measurement or
measurements that took place at a given time. (Exactly what we mean
by &#8220;Event&#8221; and &#8220;a given time&#8221; is documented elsewhere in both medium and
excruciating detail.)</p>
<p>Consider this an intermediate step. The data is structured in a generic way
that is wonderfully fleixble but not especially convenient. To get a more
useful view of the data, read on.</p>
</div>
<div class="section" id="putting-the-data-into-a-more-useful-form">
<h3>Putting the Data into a More Useful Form<a class="headerlink" href="#putting-the-data-into-a-more-useful-form" title="Permalink to this headline">¶</a></h3>
<p>One level above the DataBroker sits the DataMuxer, an object for merging and
aligning streams of Events from mamy sources into a table. Build a DataMuxer
like so:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [20]: </span><span class="kn">from</span> <span class="nn">dataportal.muxer</span> <span class="kn">import</span> <span class="n">DataMuxer</span>

<span class="gp">In [21]: </span><span class="n">dm</span> <span class="o">=</span> <span class="n">DataMuxer</span><span class="o">.</span><span class="n">from_events</span><span class="p">(</span><span class="n">events</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-21-3cf5850c05d5&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">dm</span> <span class="o">=</span> <span class="n">DataMuxer</span><span class="o">.</span><span class="n">from_events</span><span class="p">(</span><span class="n">events</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;events&#39; is not defined
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">events</span></tt> can be from one scan or from many scans together. Then, the
simplest task is to simply look at the data from one source &#8211; say, sample
temperature.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [22]: </span><span class="n">dm</span><span class="p">[</span><span class="s">&#39;Tsam&#39;</span><span class="p">]</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-22-caacaf9fabf5&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">dm</span><span class="p">[</span><span class="s">&#39;Tsam&#39;</span><span class="p">]</span>

<span class="ne">NameError</span>: name &#39;dm&#39; is not defined
</pre></div>
</div>
<p>Incidentally, to save a litte typing, <tt class="docutils literal"><span class="pre">dm.Tsam</span></tt> accomplishes the same thing.
At any rate, the output gives the measured data at each time.</p>
<p>Next, let&#8217;s obtain a table showing data from multiple sources. Strictly
speaking, measurements recorded by different equipment are not in general
synchronized, but in practice one usually ignores small differences in time.
For instance, we might want to plot &#8220;temperature&#8221; versus &#8220;intensity&#8221; even if
the temperature and intesity sensors never happened to take a simultaneous
measurement. Doing so, we would be implicitly <em>binning</em> those measurements
in time.</p>
<p>Therefore, plotting one dependent variable against another usually requires
binning to effectively &#8220;align&#8221; the measurements against each other in time.
This is the problem that DataMuxer is designed to solve. On the simplest level,
it takes the stream of events and creates the table of data you probably
expected in the first place. But it is also capable of fully exploiting the
asynchronous stream of measurements, grouping them in different ways to answer
different questions.</p>
<p>To begin, we bin the data by centering one bin at each  <tt class="docutils literal"><span class="pre">point_det</span></tt>
measurement.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [23]: </span><span class="n">binned_data</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">bin_on</span><span class="p">(</span><span class="s">&#39;point_det&#39;</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-23-5b651beb765a&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">binned_data</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">bin_on</span><span class="p">(</span><span class="s">&#39;point_det&#39;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;dm&#39; is not defined

<span class="gp">In [24]: </span><span class="n">binned_data</span>
<span class="go">                                                                                                                                                                                                                                                                                        ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-24-30d1318b2999&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 binned_data</span>

<span class="go">NameError: name &#39;binned_data&#39; is not defined</span>
</pre></div>
</div>
<p>Wherever there is <tt class="docutils literal"><span class="pre">point_det</span></tt> measurement but no <tt class="docutils literal"><span class="pre">Tsam</span></tt> measurement within
the time window, NaN indicates the missing data. (You may object that &#8220;NaN&#8221;
is not really the same as &#8220;missing.&#8221; This is a convention borrowed from the
widely-used pandas package, and the reasons for using NaN to mean &#8220;missing&#8221;
have to do with the limitations of numpy in handling missing data.)</p>
<p>The <tt class="docutils literal"><span class="pre">count</span></tt> sub-column indicates the number of <tt class="docutils literal"><span class="pre">Tsam</span></tt> measurements in
each bin. There is exactly one <tt class="docutils literal"><span class="pre">point_det</span></tt> measurement in every bin, by
definition, so no <tt class="docutils literal"><span class="pre">count</span></tt> is shown there.</p>
<p>Sometimes, one can interpolate the missing values according to some rule, such
as linear interpolation.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [25]: </span><span class="n">binned_data</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">bin_on</span><span class="p">(</span><span class="s">&#39;point_det&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;Tsam&#39;</span><span class="p">:</span> <span class="s">&#39;linear&#39;</span><span class="p">})</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-25-75376ab7c551&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">binned_data</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">bin_on</span><span class="p">(</span><span class="s">&#39;point_det&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;Tsam&#39;</span><span class="p">:</span> <span class="s">&#39;linear&#39;</span><span class="p">})</span>

<span class="ne">NameError</span>: name &#39;dm&#39; is not defined

<span class="gp">In [26]: </span><span class="n">binned_data</span>
<span class="go">                                                                                                                                                                                                                                                                                                                          ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-26-30d1318b2999&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 binned_data</span>

<span class="go">NameError: name &#39;binned_data&#39; is not defined</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">count</span></tt> column, still present, indicates which values are measured (1)
and which are interpolated (0).</p>
<p>If instead we bin the other way, defining one bin per <tt class="docutils literal"><span class="pre">Tsam</span></tt> data point,
we must provide a rule for combining multiple <tt class="docutils literal"><span class="pre">point_det</span></tt> measurements in
the same bin into one representative value. Now, along with the <tt class="docutils literal"><span class="pre">count</span></tt>
sub-column, other summary statistics are automatically generated.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [27]: </span><span class="n">binned_data</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">bin_on</span><span class="p">(</span><span class="s">&#39;Tsam&#39;</span><span class="p">,</span> <span class="n">agg</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;point_det&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">})</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-27-0dc2b0e44a8f&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">binned_data</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">bin_on</span><span class="p">(</span><span class="s">&#39;Tsam&#39;</span><span class="p">,</span> <span class="n">agg</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;point_det&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">})</span>

<span class="ne">NameError</span>: name &#39;dm&#39; is not defined

<span class="gp">In [28]: </span><span class="n">binned_data</span>
<span class="go">                                                                                                                                                                                                                                                                                                               ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-28-30d1318b2999&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 binned_data</span>

<span class="go">NameError: name &#39;binned_data&#39; is not defined</span>
</pre></div>
</div>
<p>To discard the extra statistics and keep the values only, use this syntax.
(<tt class="docutils literal"><span class="pre">xs</span></tt> stands for cross-section, a sophisticated pandas method.)</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [29]: </span><span class="n">binned_data</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s">&#39;val&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-29-86beb7b60a6d&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">binned_data</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s">&#39;val&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;binned_data&#39; is not defined
</pre></div>
</div>
</div>
<div class="section" id="exporting-the-data-for-use-outside-of-python">
<h3>Exporting the Data for Use Outside of Python<a class="headerlink" href="#exporting-the-data-for-use-outside-of-python" title="Permalink to this headline">¶</a></h3>
<p>The tabular results from the DataMuxer are DataFrames, objects from the widely-
used and well-documented package pandas, and there are many convenient
methods for exporting them to common formats. For example:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [30]: </span><span class="n">binned_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">&#39;myfile.csv&#39;</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-30-4dc5892d59db&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">binned_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">&#39;myfile.csv&#39;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;binned_data&#39; is not defined

<span class="gp">In [31]: </span><span class="n">binned_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s">&#39;myfile.xlsx&#39;</span><span class="p">)</span>
<span class="go">                                                                                                                                                                                                                                                                                             ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-31-d90efd455eff&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 binned_data.to_excel(&#39;myfile.xlsx&#39;)</span>

<span class="go">NameError: name &#39;binned_data&#39; is not defined</span>
</pre></div>
</div>
<p>More methods are described in the pandas documention, and can easily be
explored by typing <tt class="docutils literal"><span class="pre">binned_data.to_</span></tt> &lt;tab&gt;.</p>
<p>This quick-and-dirty export is really only useful if the data of interest
is scalar (e.g., not images) and not very large. For other applications,
different tools should be used. As of this writing, these tools are in
development and not yet documented.</p>
</div>
</div>
<div class="section" id="more-ways-to-look-up-scans">
<h2>More Ways to Look Up Scans<a class="headerlink" href="#more-ways-to-look-up-scans" title="Permalink to this headline">¶</a></h2>
<p>To quickly look up recent scans, use the standard Python slicing syntax for
indexing from the end of a list.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [32]: </span><span class="n">header</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c"># most recent scan</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">StopIteration</span><span class="g-Whitespace">                             </span>Traceback (most recent call last)
<span class="nn">/Users/dallan/Documents/Repos/dataportal/dataportal/broker/simple_broker.py</span> in <span class="ni">__getitem__</span><span class="nt">(self, key)</span>
<span class="g-Whitespace">     </span><span class="mi">61</span>                     <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">62</span>                         <span class="n">result</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
<span class="g-Whitespace">     </span><span class="mi">63</span>                     <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>

<span class="ne">StopIteration</span>: 

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">IndexError</span><span class="g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-32-1b16e9bd6325&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">header</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c"># most recent scan</span>

<span class="nn">/Users/dallan/Documents/Repos/dataportal/dataportal/broker/simple_broker.py</span> in <span class="ni">__getitem__</span><span class="nt">(self, key)</span>
<span class="g-Whitespace">     </span><span class="mi">63</span>                     <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
<span class="g-Whitespace">     </span><span class="mi">64</span>                         <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
<span class="ne">---&gt; </span><span class="mi">65</span>                             <span class="s">&quot;There are only {0} runs.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="g-Whitespace">     </span><span class="mi">66</span>                 <span class="n">header</span> <span class="o">=</span> <span class="n">Header</span><span class="o">.</span><span class="n">from_run_start</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="g-Whitespace">     </span><span class="mi">67</span>         <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>

<span class="ne">IndexError</span>: There are only 0 runs.

<span class="gp">In [33]: </span><span class="n">header</span><span class="o">.</span><span class="n">scan_id</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-33-568d15f1f12c&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 header.scan_id</span>

<span class="go">NameError: name &#39;header&#39; is not defined</span>

<span class="gp">In [34]: </span><span class="n">header</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c"># next to last scan</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ---------------------------------------------------------------------------</span>
<span class="go">StopIteration                             Traceback (most recent call last)</span>
<span class="go">/Users/dallan/Documents/Repos/dataportal/dataportal/broker/simple_broker.py in __getitem__(self, key)</span>
<span class="go">     61                     try:</span>
<span class="go">---&gt; 62                         result = next(gen)</span>
<span class="go">     63                     except StopIteration:</span>

<span class="go">StopIteration: </span>

<span class="go">During handling of the above exception, another exception occurred:</span>

<span class="go">IndexError                                Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-34-36cc6e9f562c&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 header = DataBroker[-2]  # next to last scan</span>

<span class="go">/Users/dallan/Documents/Repos/dataportal/dataportal/broker/simple_broker.py in __getitem__(self, key)</span>
<span class="go">     63                     except StopIteration:</span>
<span class="go">     64                         raise IndexError(</span>
<span class="go">---&gt; 65                             &quot;There are only {0} runs.&quot;.format(i))</span>
<span class="go">     66                 header = Header.from_run_start(result)</span>
<span class="go">     67         elif isinstance(key, six.string_types):</span>

<span class="go">IndexError: There are only 0 runs.</span>

<span class="gp">In [35]: </span><span class="n">header</span><span class="o">.</span><span class="n">scan_id</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-35-568d15f1f12c&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 header.scan_id</span>

<span class="go">NameError: name &#39;header&#39; is not defined</span>

<span class="gp">In [36]: </span><span class="n">headers</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>  <span class="c"># all of the last five scans</span>

<span class="gp">In [37]: </span><span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">scan_id</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">]</span>
<span class="gh">Out[37]: </span><span class="go">[]</span>

<span class="gp">In [38]: </span><span class="n">headers</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="p">[</span><span class="o">-</span><span class="mi">1000</span><span class="p">::</span><span class="mi">100</span><span class="p">]</span>  <span class="c"># sample every 100th of the last (up to) 1000 scans</span>
</pre></div>
</div>
<p>Or give the scan ID, which is always a positive integer.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [39]: </span><span class="n">header</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>  <span class="c"># scan ID 4</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">StopIteration</span><span class="g-Whitespace">                             </span>Traceback (most recent call last)
<span class="nn">/Users/dallan/Documents/Repos/dataportal/dataportal/broker/simple_broker.py</span> in <span class="ni">__getitem__</span><span class="nt">(self, key)</span>
<span class="g-Whitespace">     </span><span class="mi">52</span>                 <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">53</span>                     <span class="n">result</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>  <span class="c"># most recent match</span>
<span class="g-Whitespace">     </span><span class="mi">54</span>                 <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>

<span class="ne">StopIteration</span>: 

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">ValueError</span><span class="g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-39-c42deee19cfc&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">header</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>  <span class="c"># scan ID 4</span>

<span class="nn">/Users/dallan/Documents/Repos/dataportal/dataportal/broker/simple_broker.py</span> in <span class="ni">__getitem__</span><span class="nt">(self, key)</span>
<span class="g-Whitespace">     </span><span class="mi">53</span>                     <span class="n">result</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>  <span class="c"># most recent match</span>
<span class="g-Whitespace">     </span><span class="mi">54</span>                 <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">55</span>                     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;No such run found.&quot;</span><span class="p">)</span>
<span class="g-Whitespace">     </span><span class="mi">56</span>                 <span class="n">header</span> <span class="o">=</span> <span class="n">Header</span><span class="o">.</span><span class="n">from_run_start</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="g-Whitespace">     </span><span class="mi">57</span>             <span class="k">else</span><span class="p">:</span>

<span class="ne">ValueError</span>: No such run found.

<span class="gp">In [40]: </span><span class="n">header</span><span class="o">.</span><span class="n">scan_id</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-40-568d15f1f12c&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 header.scan_id</span>

<span class="go">NameError: name &#39;header&#39; is not defined</span>
</pre></div>
</div>
<p>If you know the unique id (uid) of a Header, you can use the first few
characters to find it.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [41]: </span><span class="n">header</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="p">[</span><span class="s">&#39;a5fbde&#39;</span><span class="p">]</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-41-f24635177cf4&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">header</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="p">[</span><span class="s">&#39;a5fbde&#39;</span><span class="p">]</span>

<span class="nn">/Users/dallan/Documents/Repos/dataportal/dataportal/broker/simple_broker.py</span> in <span class="ni">__getitem__</span><span class="nt">(self, key)</span>
<span class="g-Whitespace">     </span><span class="mi">74</span>                 <span class="n">results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
<span class="g-Whitespace">     </span><span class="mi">75</span>             <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">76</span>                 <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;No such run found.&quot;</span><span class="p">)</span>
<span class="g-Whitespace">     </span><span class="mi">77</span>             <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g-Whitespace">     </span><span class="mi">78</span>                 <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;That partial uid matches multiple runs. &quot;</span>

<span class="ne">ValueError</span>: No such run found.
</pre></div>
</div>
<p>For advanced searches, use <tt class="docutils literal"><span class="pre">find_headers</span></tt>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [42]: </span><span class="n">neds_headers</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="o">.</span><span class="n">find_headers</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="s">&#39;nedbrainard&#39;</span><span class="p">)</span>

<span class="gp">In [43]: </span><span class="n">headers_measuring_temperature</span> <span class="o">=</span> <span class="n">DataBroker</span><span class="o">.</span><span class="n">find_headers</span><span class="p">(</span><span class="n">data_key</span><span class="o">=</span><span class="s">&#39;Tsam&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Any of these results, whether a single Header or a list of Headers, can be
passed to <tt class="docutils literal"><span class="pre">DataBroker.fetch_events()</span></tt> as shown in the previous sections above.</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="whats_new.html" class="btn btn-neutral" title="What’s new"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015 Brookhaven National Lab.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.6',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>