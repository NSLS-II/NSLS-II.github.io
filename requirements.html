


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Design Requirements &mdash; NSLS-II Software Documentation  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Meetings" href="meetings/index.html" />
    <link rel="prev" title="Releases and Deployment" href="deployment-howto.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> NSLS-II Software Documentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="architecture-overview.html">Event-Based Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookbook/index.html">Cookbook (Examples)</a></li>
<li class="toctree-l1"><a class="reference internal" href="remote-access.html">Remote Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="sandbox.html">Sandbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History of Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="conda.html">Software Deployment with Conda</a></li>
<li class="toctree-l1"><a class="reference internal" href="fresh-installation.html">Installation at a Beamline</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Recommended Resources</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="internal_index.html">Internal Notes</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="internal_index.html#out-of-date">Out of date</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="deployment-howto.html">Releases and Deployment</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Design Requirements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#data-model">Data Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-storage-and-access">Data Storage and Access</a></li>
<li class="toctree-l4"><a class="reference internal" href="#python-software-dependencies">Python Software Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#python-software-apis">Python Software APIs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="meetings/index.html">Meetings</a></li>
</ul>
<p class="caption"><span class="caption-text">Data Collection</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://nsls-ii.github.io/bluesky">bluesky</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nsls-ii.github.io/ophyd">ophyd</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nsls-ii.github.io/caproto">caproto</a></li>
</ul>
<p class="caption"><span class="caption-text">Data Access and Management</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://nsls-ii.github.io/databroker">databroker</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nsls-ii.github.io/suitcase">suitcase</a></li>
</ul>
<p class="caption"><span class="caption-text">Data Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="http://scikit-beam.github.io/scikit-beam">scikit-beam</a></li>
</ul>
<p class="caption"><span class="caption-text">GitHub Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NSLS-II/">NSLS-II Repositories</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NSLS-II/wishlist/issues">Wish List</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NSLS-II/Bug-Reports/issues">Bug Reports</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NSLS-II Software Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="internal_index.html">Internal Notes</a> &raquo;</li>
        
      <li>Design Requirements</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/requirements.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="design-requirements">
<h1>Design Requirements<a class="headerlink" href="#design-requirements" title="Permalink to this headline">¶</a></h1>
<p>The design requirements have been developed iteratively through testing with
beamline scientists and users at NSLS-II. They will continue to change as we
learn.</p>
<div class="section" id="data-model">
<h2>Data Model<a class="headerlink" href="#data-model" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>The event-based document model is the core of the project. It is not tied to
any specific language or storage technology.</li>
<li>Nothing in the schema will be specific to NSLS-II or synchrotron science. It
will be kept general to experimental science.</li>
<li>A facility or a beamline can impose extra required fields in the schema at
configuration time (e.g. requiring username, SAF number, proposal ID, or some
beamline-specific metadata).</li>
<li>At NSLS-II, there is yet no facility-wide standard for collecting information
identifying the owner of a data set. We await guidance from the user task
force on this issue. Ultimately, we expect that a set of required fields will
likely be imposed at the facility level, once the tooling is in place to
authenticate the user and validate their inputs.</li>
<li>At NSLS-II, there is no facility-wide standard for collecting sample
information. We expect that sample metadata fields will <em>never</em> be required at the
facility level (beyond the general SAF number) because some beamlines would
find such a requirement onerous and unhelpful. But a suggested set of prompts
and names should be made available for user groups or beamlines that wish to
opt in to imposing requirements.</li>
<li>The dynamic documents (‘start’, ‘stop’, ‘descriptor’) should support rich
search, akin to mongo queries. The ‘event’ documents may not support fast
rich queries.</li>
</ul>
</div>
<div class="section" id="data-storage-and-access">
<h2>Data Storage and Access<a class="headerlink" href="#data-storage-and-access" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Each beamline will run separate instances of the document databases and
maintain separate large file storage capability.</li>
<li>All data should be accessed through the databroker, not by directly using the
files indexed by filestore.</li>
<li>For the present, all of the document databases in production run an
implementation backed by MongoDB. Other implementations will be explored
with performance and portability in mind. In the future, different beamlines
may run different database implementations to meet their particular
requirements. All will satisfy the same schema and present the
metadatastore/filestore object API.</li>
<li>In the future, we hope a tiered storage system will be proided, whereby
older or less frequently accessed large files can be transparently migrated
to other physical storage but still accessible using the same POSIX path.</li>
<li>For the present, nothing is ever deleted. In the future, we will add the
capability for beamline scientists to selectively delete data or for the
facility to “garbage collect” old data that has not speicfically been marked
for long-term archival. However, this will not be implemented until all runs
are clearly identified with an owner, which relies on guidance from the user
task force, as outlined previously.</li>
<li>Suitcase will provide tools for exporting from the databroker to various file
formats (SPEC files and HDF5 are currently support). We are not advocating
these formats as standards in any way: they are merely conveniences for users
who rely on a file-based workflow and are not prepared to write their own
custom export code. In general they are lossy and do not capture the full
information or structure of the original documents.</li>
</ul>
</div>
<div class="section" id="python-software-dependencies">
<h2>Python Software Dependencies<a class="headerlink" href="#python-software-dependencies" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Data collection software will require Python 3. Presently it requires
3.4 or greater, but may be updated to rely on later minor releases
(e.g. Python 3.6). Minor upgrades are expected to require little or no
change to user code.</li>
<li>Data analysis software will support both Python 2.7 and Python 3.4+ for now.
Following the lead of the
<a class="reference external" href="http://www.python3statement.org/">scientific Python community at large</a>,
support for 2.7 will be dropped before 2020, when Python 2.7 itself will stop
receiving security patches.</li>
<li>Users often interact with the software using IPython, but no core
functionality should rely on IPython. Though IPython integration such as
“magics” may be created for convenience and packaged with the software, all
important functions should be runnable from a plain Python script and should
not assume IPython is installed.</li>
<li>In general, if an acceptable implementation of some functionality exists in a
widely-used and actively-supported library, we prefer reusing that
implementation over rewriting. In evaluating an implementation, we look for
separation of I/O and visualization code from the core scientific logic, good
community practices like open development and automated unit testing,
reasonable packaging and dependencies, and a design that makes individual
components easy to pick apart.</li>
</ul>
</div>
<div class="section" id="python-software-apis">
<h2>Python Software APIs<a class="headerlink" href="#python-software-apis" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Ophyd will provide a low-level API for debugging hardware and whatever
high-level API is needed by bluesky.</li>
<li>Bluesky will interact with hardware only through ophyd’s high-level API. It
will provide general-purpose “plans” and the tools to assemble more
beamline- and experiment-specific plans.</li>
<li>Databroker will provide a user-friendly programmatic interface for retrieval
documents and deferencing data from files indexed by filestore.</li>
<li>The documents emmited by bluesky and the documents returned by databroker
should be compatible (i.e., equal).</li>
<li>Amostra will provide separate document collection, outside the core document
schema, intended to store sample information. Its main technical feature is
that it provides a way to <em>deference</em> sample information rather than store a
separate copy of the information in every run.</li>
<li>Datamuxer will provide tooling for de-multiplexing asynchronous event
streams. (The project has not been actively developed since early 2015 and
will need to be revisited, maybe rewritten, in light of subsequent
developments in the document model and bluesky.)</li>
<li>Scikit-beam is the name of a github organization and a Python project
providing “core” code for projects in that organization. Any analysis code
written at or for the beamlines that can be of general use should be refined,
documented, and moved into scikit-beam (or some other external scipy project,
such as scikit-image, if it is sufficiently general).</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="meetings/index.html" class="btn btn-neutral float-right" title="Meetings" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="deployment-howto.html" class="btn btn-neutral" title="Releases and Deployment" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015 Brookhaven National Lab.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>