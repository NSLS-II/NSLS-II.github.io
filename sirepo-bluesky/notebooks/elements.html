<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Optical Elements as Ophyd Objects &mdash; sirepo-bluesky 0.post1+gb044ed1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="List of predefined simulations in Sirepo" href="../simulations.html" />
    <link rel="prev" title="Notebooks (new API)" href="../notebooks-new-api.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> sirepo-bluesky
          </a>
              <div class="version">
                0.post1+gb044ed1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks-old-api.html">Notebooks (old API)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks-new-api.html">Notebooks (new API)</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Optical Elements as Ophyd Objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Run-“Beamline”-SRW-simulations">Run “Beamline” SRW simulations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Run-“Beam-Statistics”-Sirepo/Shadow-app-simulations">Run “Beam Statistics” Sirepo/Shadow app simulations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../simulations.html">List of predefined simulations in Sirepo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-history.html">Release History</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sirepo-bluesky</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../notebooks-new-api.html">Notebooks (new API)</a> &raquo;</li>
      <li>Optical Elements as Ophyd Objects</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/elements.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Optical-Elements-as-Ophyd-Objects">
<h1>Optical Elements as Ophyd Objects<a class="headerlink" href="#Optical-Elements-as-Ophyd-Objects" title="Permalink to this headline">¶</a></h1>
<p>This section is based on the <strong>TES</strong> beamline example.</p>
<p><strong>Hint</strong>: See the <a class="reference internal" href="../simulations.html"><span class="doc">List of predefined simulations in Sirepo</span></a> for examples of identifiers for different beamlines.</p>
<section id="Run-“Beamline”-SRW-simulations">
<h2>Run “Beamline” SRW simulations<a class="headerlink" href="#Run-“Beamline”-SRW-simulations" title="Permalink to this headline">¶</a></h2>
<p>In this example, we scan the horizontal size of the aperture and collect the resulting averaged intensities and corresponding 2D intensity distributions from the “Watchpoint” report on the “Beamline” page of Sirepo/SRW app.</p>
<p>Start <code class="docutils literal notranslate"><span class="pre">ipython</span></code> and run the following where <code class="docutils literal notranslate"><span class="pre">sim_id</span></code> is the UID for the simulation we are working with:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">run</span> -i ../../../examples/prepare_det_env.py

<span class="kn">from</span> <span class="nn">sirepo_bluesky.sirepo_bluesky</span> <span class="kn">import</span> <span class="n">SirepoBluesky</span>
<span class="kn">from</span> <span class="nn">sirepo_bluesky.sirepo_ophyd</span> <span class="kn">import</span> <span class="n">create_classes</span>

<span class="n">connection</span> <span class="o">=</span> <span class="n">SirepoBluesky</span><span class="p">(</span><span class="s2">&quot;http://localhost:8000&quot;</span><span class="p">)</span>

<span class="n">data</span><span class="p">,</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">auth</span><span class="p">(</span><span class="s2">&quot;srw&quot;</span><span class="p">,</span> <span class="s2">&quot;00000002&quot;</span><span class="p">)</span>
<span class="n">classes</span><span class="p">,</span> <span class="n">objects</span> <span class="o">=</span> <span class="n">create_classes</span><span class="p">(</span><span class="n">connection</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                  <span class="n">connection</span><span class="o">=</span><span class="n">connection</span><span class="p">)</span>
<span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">objects</span><span class="p">)</span>

<span class="n">aperture</span><span class="o">.</span><span class="n">horizontalSize</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;hinted&quot;</span>
<span class="n">w9</span><span class="o">.</span><span class="n">duration</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;hinted&quot;</span>

<span class="p">(</span><span class="n">uid</span><span class="p">,)</span> <span class="o">=</span> <span class="n">RE</span><span class="p">(</span><span class="n">bp</span><span class="o">.</span><span class="n">scan</span><span class="p">([</span><span class="n">w9</span><span class="p">],</span> <span class="n">aperture</span><span class="o">.</span><span class="n">horizontalSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">hdr</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="n">uid</span><span class="p">]</span>
<span class="n">tbl</span> <span class="o">=</span> <span class="n">hdr</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tbl</span><span class="p">)</span>

<span class="n">w9_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">hdr</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s2">&quot;w9_image&quot;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


Transient Scan ID: 1     Time: 2022-03-11 17:51:49
Persistent Unique Scan ID: &#39;58097efe-fa62-4855-a9d6-6ee0304efb95&#39;
New stream: &#39;primary&#39;
+-----------+------------+-------------------------+-------------+------------+
|   seq_num |       time | aperture_horizontalSize | w9_duration |    w9_mean |
+-----------+------------+-------------------------+-------------+------------+
|         1 | 17:52:20.0 |                   0.000 |      30.628 |      0.000 |
|         2 | 17:52:45.5 |                   0.500 |      25.345 | 2510544190625.287 |
|         3 | 17:53:11.0 |                   1.000 |      25.334 | 41560782559219.422 |
|         4 | 17:53:36.5 |                   1.500 |      25.312 | 136793792948293.203 |
|         5 | 17:54:02.0 |                   2.000 |      25.317 | 346875726031568.125 |
+-----------+------------+-------------------------+-------------+------------+
generator scan [&#39;58097efe&#39;] (scan num: 1)



                                 time  aperture_horizontalSize  \
seq_num
1       2022-03-11 17:52:20.079435349                      0.0
2       2022-03-11 17:52:45.577368498                      0.5
3       2022-03-11 17:53:11.061379433                      1.0
4       2022-03-11 17:53:36.586285353                      1.5
5       2022-03-11 17:54:02.052179098                      2.0

                                       w9_sirepo_data_json  \
seq_num
1        {&#34;models&#34;: {&#34;arbitraryMagField&#34;: {&#34;interpolati...
2        {&#34;models&#34;: {&#34;arbitraryMagField&#34;: {&#34;interpolati...
3        {&#34;models&#34;: {&#34;arbitraryMagField&#34;: {&#34;interpolati...
4        {&#34;models&#34;: {&#34;arbitraryMagField&#34;: {&#34;interpolati...
5        {&#34;models&#34;: {&#34;arbitraryMagField&#34;: {&#34;interpolati...

                                       w9_sirepo_data_hash  w9_duration  \
seq_num
1        2b3f5ce220ab39c9d820de1f1ff7330b855ed3a426bd95...    30.627986
2        6a08399b7162ddc79798e8c0f7d2b60b35e33e0b43302c...    25.344732
3        4863d79c37068bab29c42a3f9234f789886ccc677cbf31...    25.333952
4        002c5e780dc38446c09ba2dd55b46b67b5f13bef3a74c7...    25.311696
5        cc2e1871b4714d3fc1588d41ac35de6ddf7e73546dcefb...    25.316836

                                                  w9_image   w9_shape  \
seq_num
1        [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...  [42, 960]
2        [[926.6341552734375, 935.7051391601562, 954.32...  [42, 960]
3        [[1142696.125, 1127239.25, 1114390.125, 116813...  [42, 960]
4        [[114820112.0, 116992512.0, 116708392.0, 11891...  [42, 960]
5        [[980582272.0, 1007160704.0, 1032941312.0, 103...  [42, 960]

              w9_mean  w9_photon_energy  \
seq_num
1        0.000000e+00            2500.0
2        2.510544e+12            2500.0
3        4.156078e+13            2500.0
4        1.367938e+14            2500.0
5        3.468757e+14            2500.0

                                      w9_horizontal_extent  \
seq_num
1        [-2.1254114436366436e-06, -9.098470371627117e-07]
2         [-0.0002015893619838878, 0.00019947725636508496]
3          [-6.523977670846958e-05, 6.234960530300249e-05]
4          [-3.183281321719476e-05, 2.883299625123156e-05]
5         [-1.880166551489609e-05, 1.5761422719808468e-05]

                                       w9_vertical_extent  w9_id w9_title  \
seq_num
1          [-6.735306985152392e-07, 6.90416995865796e-07]     15       W9
2        [-1.789280408182185e-05, 1.7455179846077244e-05]     15       W9
3        [-1.747167489540234e-05, 1.7044350685160325e-05]     15       W9
4         [-1.680649675386221e-05, 1.639544154620327e-05]     15       W9
5        [-1.556056188360331e-05, 1.5179979892601324e-05]     15       W9

        w9_type  w9_element_position
seq_num
1         watch               57.142
2         watch               57.142
3         watch               57.142
4         watch               57.142
5         watch               57.142
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_3_1.png" src="../_images/notebooks_elements_3_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">ImageGrid</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data shape: </span><span class="si">{</span><span class="n">w9_image</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">num_frames</span> <span class="o">=</span> <span class="n">w9_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num_frames</span> <span class="o">/</span> <span class="n">ncols</span><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
                 <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span>
                 <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                 <span class="n">aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">im</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">w9_image</span><span class="p">[:,</span> <span class="o">...</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Data shape: (5, 42, 960)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_4_1.png" src="../_images/notebooks_elements_4_1.png" />
</div>
</div>
</section>
<section id="Run-“Beam-Statistics”-Sirepo/Shadow-app-simulations">
<h2>Run “Beam Statistics” Sirepo/Shadow app simulations<a class="headerlink" href="#Run-“Beam-Statistics”-Sirepo/Shadow-app-simulations" title="Permalink to this headline">¶</a></h2>
<p>In this example, we scan the toroidal mirror’s radius and collect the results of the “Beam Statistics” report on the “Beamline” page of Sirepo/Shadow app. At the end of the execution, we provide the timing report for these simulations.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">run</span> -i ../../../examples/prepare_det_env.py

<span class="kn">from</span> <span class="nn">sirepo_bluesky.sirepo_bluesky</span> <span class="kn">import</span> <span class="n">SirepoBluesky</span>
<span class="kn">from</span> <span class="nn">sirepo_bluesky.sirepo_ophyd</span> <span class="kn">import</span> <span class="n">BeamStatisticsReport</span><span class="p">,</span> <span class="n">create_classes</span>

<span class="n">connection</span> <span class="o">=</span> <span class="n">SirepoBluesky</span><span class="p">(</span><span class="s2">&quot;http://localhost:8000&quot;</span><span class="p">)</span>

<span class="n">data</span><span class="p">,</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">auth</span><span class="p">(</span><span class="s2">&quot;shadow&quot;</span><span class="p">,</span> <span class="s2">&quot;00000002&quot;</span><span class="p">)</span>

<span class="n">classes</span><span class="p">,</span> <span class="n">objects</span> <span class="o">=</span> <span class="n">create_classes</span><span class="p">(</span><span class="n">connection</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                  <span class="n">connection</span><span class="o">=</span><span class="n">connection</span><span class="p">)</span>
<span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">objects</span><span class="p">)</span>

<span class="n">bsr</span> <span class="o">=</span> <span class="n">BeamStatisticsReport</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;bsr&quot;</span><span class="p">,</span> <span class="n">connection</span><span class="o">=</span><span class="n">connection</span><span class="p">)</span>

<span class="n">toroid</span><span class="o">.</span><span class="n">r_maj</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;hinted&quot;</span>
<span class="n">bsr</span><span class="o">.</span><span class="n">duration</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;hinted&quot;</span>

<span class="n">scan_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10_000</span><span class="p">,</span> <span class="mi">50_000</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>

<span class="p">(</span><span class="n">uid</span><span class="p">,)</span> <span class="o">=</span> <span class="n">RE</span><span class="p">(</span><span class="n">bp</span><span class="o">.</span><span class="n">scan</span><span class="p">([</span><span class="n">bsr</span><span class="p">],</span> <span class="n">toroid</span><span class="o">.</span><span class="n">r_maj</span><span class="p">,</span> <span class="o">*</span><span class="n">scan_range</span><span class="p">))</span>

<span class="n">hdr</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="n">uid</span><span class="p">]</span>
<span class="n">tbl</span> <span class="o">=</span> <span class="n">hdr</span><span class="o">.</span><span class="n">table</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tbl</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


Transient Scan ID: 1     Time: 2022-03-11 17:54:03
Persistent Unique Scan ID: &#39;8ec327e9-9584-4493-83e2-2fd904fdd583&#39;
New stream: &#39;primary&#39;
+-----------+------------+--------------+--------------+
|   seq_num |       time | toroid_r_maj | bsr_duration |
+-----------+------------+--------------+--------------+
|         1 | 17:54:08.7 |    10000.000 |        5.087 |
|         2 | 17:54:12.9 |    12000.000 |        4.072 |
|         3 | 17:54:17.0 |    14000.000 |        4.074 |
|         4 | 17:54:21.1 |    16000.000 |        4.082 |
|         5 | 17:54:25.3 |    18000.000 |        4.073 |
|         6 | 17:54:29.4 |    20000.000 |        4.084 |
|         7 | 17:54:33.6 |    22000.000 |        4.099 |
|         8 | 17:54:37.7 |    24000.000 |        4.096 |
|         9 | 17:54:41.9 |    26000.000 |        4.083 |
|        10 | 17:54:46.0 |    28000.000 |        4.076 |
|        11 | 17:54:50.1 |    30000.000 |        4.082 |
|        12 | 17:54:54.3 |    32000.000 |        4.079 |
|        13 | 17:54:58.4 |    34000.000 |        4.084 |
|        14 | 17:55:02.5 |    36000.000 |        4.078 |
|        15 | 17:55:06.7 |    38000.000 |        4.073 |
|        16 | 17:55:10.8 |    40000.000 |        4.074 |
|        17 | 17:55:14.9 |    42000.000 |        4.077 |
|        18 | 17:55:19.1 |    44000.000 |        4.077 |
|        19 | 17:55:23.2 |    46000.000 |        4.074 |
|        20 | 17:55:27.3 |    48000.000 |        4.073 |
|        21 | 17:55:31.4 |    50000.000 |        4.073 |
+-----------+------------+--------------+--------------+
generator scan [&#39;8ec327e9&#39;] (scan num: 1)



                                 time  \
seq_num
1       2022-03-11 17:54:08.784183979
2       2022-03-11 17:54:12.917770147
3       2022-03-11 17:54:17.048403978
4       2022-03-11 17:54:21.183239937
5       2022-03-11 17:54:25.312236547
6       2022-03-11 17:54:29.448642254
7       2022-03-11 17:54:33.613842964
8       2022-03-11 17:54:37.768995762
9       2022-03-11 17:54:41.909113884
10      2022-03-11 17:54:46.042707443
11      2022-03-11 17:54:50.179719925
12      2022-03-11 17:54:54.313590527
13      2022-03-11 17:54:58.450285673
14      2022-03-11 17:55:02.583453655
15      2022-03-11 17:55:06.708819389
16      2022-03-11 17:55:10.836931229
17      2022-03-11 17:55:14.968356609
18      2022-03-11 17:55:19.100056171
19      2022-03-11 17:55:23.228413105
20      2022-03-11 17:55:27.355767727
21      2022-03-11 17:55:31.481804609

                                      bsr_sirepo_data_json  \
seq_num
1        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
2        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
3        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
4        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
5        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
6        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
7        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
8        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
9        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
10       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
11       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
12       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
13       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
14       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
15       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
16       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
17       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
18       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
19       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
20       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
21       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...

                                      bsr_sirepo_data_hash  bsr_duration  \
seq_num
1        dc91337c1a2c50f2cc7831bf7c9b66c3b78491735eb762...      5.087230
2        7e69b60ec8facd7254c8193e87cbae435803aa0c3bde4c...      4.072245
3        230226a874691037a0617b25a187d8a5809be627c3a396...      4.074444
4        c96b96c7e8b9df5b3404233afd17462f6e5e311363789d...      4.082255
5        f6067bf8a153b93a48e27761e21f77043fd17e681ed3fe...      4.073463
6        c518d9b5c50d34a528fd7eba82b86395279741b18e0d18...      4.083801
7        804deb56ad92001314a70e845f9fa1acb211458b5f2aee...      4.098931
8        af9d9fd48067507fdf8b84237a979121806be896849bff...      4.095731
9        7403f828704f61e9314e2fe49f6ee054bbac271f5aa786...      4.083204
10       523e971a1b68ef9439150819560b5a68259a57c7a04520...      4.075914
11       3d6be861c5fab02e4a7471361ff3b43dfd1795ff703897...      4.082481
12       8c82a7f16d8239d5b3263571c58d60f62d01fa1c843013...      4.078824
13       324f1c983d96be07609759d883d361cf4fc8c9555f66d3...      4.083819
14       080ba1212877753b9823763d4734f6c4d5a7814de2716b...      4.078392
15       27d7950afb55e9ff3ef18dff362cf762e3be43691391b2...      4.073015
16       c30efab9bb055bdc759192494066780eedb1b8e0f07ee0...      4.073695
17       179fba44bff1ccf520728eecb1e2bfd0712bc00e6b3ec6...      4.076704
18       e454f3ebfbe0b6f0e3c40a81b62f1bd3adcc7b729f1772...      4.076939
19       dcd3e4a1c7ad2998801e09acbd30583ad314ba493371b2...      4.073627
20       16e03bb11066ea5e8514b8b39fcc7a1ceb66196e1f259b...      4.073085
21       4bdbe509c1156c5b2980cb360f3c8bc1337cfd7ea3c399...      4.073182

                                                bsr_report  toroid_r_maj
seq_num
1        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       10000.0
2        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       12000.0
3        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       14000.0
4        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       16000.0
5        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       18000.0
6        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       20000.0
7        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       22000.0
8        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       24000.0
9        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       26000.0
10       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       28000.0
11       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       30000.0
12       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       32000.0
13       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       34000.0
14       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       36000.0
15       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       38000.0
16       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       40000.0
17       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       42000.0
18       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       44000.0
19       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       46000.0
20       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       48000.0
21       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....       50000.0
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_6_1.png" src="../_images/notebooks_elements_6_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;toroid_r_maj&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;bsr_report&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;s&quot;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;sigmax&quot;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;s&quot;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;sigmaz&quot;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;toroid_r_maj = </span><span class="si">{</span><span class="n">tbl</span><span class="p">[</span><span class="s1">&#39;toroid_r_maj&#39;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/tmp/ipykernel_5417/1375322784.py:6: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  plt.figure(figsize=(16, 4))
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_1.png" src="../_images/notebooks_elements_7_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_2.png" src="../_images/notebooks_elements_7_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_3.png" src="../_images/notebooks_elements_7_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_4.png" src="../_images/notebooks_elements_7_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_5.png" src="../_images/notebooks_elements_7_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_6.png" src="../_images/notebooks_elements_7_6.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_7.png" src="../_images/notebooks_elements_7_7.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_8.png" src="../_images/notebooks_elements_7_8.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_9.png" src="../_images/notebooks_elements_7_9.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_10.png" src="../_images/notebooks_elements_7_10.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_11.png" src="../_images/notebooks_elements_7_11.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_12.png" src="../_images/notebooks_elements_7_12.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_13.png" src="../_images/notebooks_elements_7_13.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_14.png" src="../_images/notebooks_elements_7_14.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_15.png" src="../_images/notebooks_elements_7_15.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_16.png" src="../_images/notebooks_elements_7_16.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_17.png" src="../_images/notebooks_elements_7_17.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_18.png" src="../_images/notebooks_elements_7_18.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_19.png" src="../_images/notebooks_elements_7_19.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_20.png" src="../_images/notebooks_elements_7_20.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_7_21.png" src="../_images/notebooks_elements_7_21.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/</span> <span class="mf">1e9</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">scan_range</span><span class="p">)[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Duration of simulations&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Duration of simulations [s]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Torus Major Radius [m]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Averaged duration&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">title</span> <span class="o">=</span> <span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Shadow TES simulation</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot;RE(bp.scan([bsr], toroid.r_maj, &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">scan_range</span><span class="p">])</span><span class="si">}</span><span class="s2">))&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elements_8_0.png" src="../_images/notebooks_elements_8_0.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../notebooks-new-api.html" class="btn btn-neutral float-left" title="Notebooks (new API)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../simulations.html" class="btn btn-neutral float-right" title="List of predefined simulations in Sirepo" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Brookhaven National Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>