<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="MAD-X Simulations" href="madx.html" /><link rel="prev" title="SRW Simulations" href="srw.html" />

    <!-- Generated with Sphinx 7.2.2 and Furo 2023.08.19 -->
        <title>Shadow Simulations - sirepo-bluesky 0.7.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">sirepo-bluesky 0.7.2 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">sirepo-bluesky 0.7.2 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation instructions</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../examples.html">Examples</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="srw.html">SRW Simulations</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Shadow Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="madx.html">MAD-X Simulations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../simulations.html">List of predefined simulations in Sirepo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-history.html">Release History</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NSLS-II/sirepo-bluesky">Sirepo-Bluesky on GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io">Bluesky Project</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/radiasoft/sirepo">Sirepo on GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.sirepo.com">Public Sirepo Server</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NSLS-II/bloptools">Beamline Optimization Tools</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="Shadow-Simulations">
<h1>Shadow Simulations<a class="headerlink" href="#Shadow-Simulations" title="Link to this heading">#</a></h1>
<p>This section is based on the <strong>TES</strong> beamline example.</p>
<p><strong>Hint</strong>: See the <a class="reference internal" href="../simulations.html"><span class="doc">List of predefined simulations in Sirepo</span></a> for examples of identifiers for different beamlines.</p>
<section id="Run-%22Beamline%22-Shadow3-simulations">
<h2>Run “Beamline” Shadow3 simulations<a class="headerlink" href="#Run-%22Beamline%22-Shadow3-simulations" title="Link to this heading">#</a></h2>
<p>This example repeats the first simulation in “Optical Elements as Ophyd Objects”, but instead uses Shadow3 to run the simulation.</p>
<p>Start <code class="docutils literal notranslate"><span class="pre">ipython</span></code> and run the following where <code class="docutils literal notranslate"><span class="pre">sim_id</span></code> is the UID for the simulation we are working with:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sirepo_bluesky</span> <span class="kn">import</span> <span class="n">prepare_re_env</span>

<span class="o">%</span><span class="k">run</span> -i $prepare_re_env.__file__

<span class="kn">from</span> <span class="nn">sirepo_bluesky.sirepo_bluesky</span> <span class="kn">import</span> <span class="n">SirepoBluesky</span>
<span class="kn">from</span> <span class="nn">sirepo_bluesky.sirepo_ophyd</span> <span class="kn">import</span> <span class="n">BeamStatisticsReport</span><span class="p">,</span> <span class="n">create_classes</span>

<span class="n">connection</span> <span class="o">=</span> <span class="n">SirepoBluesky</span><span class="p">(</span><span class="s2">&quot;http://localhost:8000&quot;</span><span class="p">)</span>

<span class="n">data</span><span class="p">,</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">auth</span><span class="p">(</span><span class="s2">&quot;shadow&quot;</span><span class="p">,</span> <span class="n">sim_id</span><span class="o">=</span><span class="s2">&quot;00000002&quot;</span><span class="p">)</span>
<span class="n">classes</span><span class="p">,</span> <span class="n">objects</span> <span class="o">=</span> <span class="n">create_classes</span><span class="p">(</span><span class="n">connection</span><span class="o">=</span><span class="n">connection</span><span class="p">)</span>
<span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">objects</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of points before change: </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;models&#39;</span><span class="p">][</span><span class="s1">&#39;simulation&#39;</span><span class="p">][</span><span class="s1">&#39;npoint&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">][</span><span class="s2">&quot;simulation&quot;</span><span class="p">][</span><span class="s2">&quot;npoint&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1000000</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of points after change: </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;models&#39;</span><span class="p">][</span><span class="s1">&#39;simulation&#39;</span><span class="p">][</span><span class="s1">&#39;npoint&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">aperture</span><span class="o">.</span><span class="n">horizontalSize</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;hinted&quot;</span>
<span class="n">w9</span><span class="o">.</span><span class="n">duration</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;hinted&quot;</span>

<span class="p">(</span><span class="n">uid</span><span class="p">,)</span> <span class="o">=</span> <span class="n">RE</span><span class="p">(</span><span class="n">bp</span><span class="o">.</span><span class="n">scan</span><span class="p">([</span><span class="n">w9</span><span class="p">],</span> <span class="n">aperture</span><span class="o">.</span><span class="n">horizontalSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">hdr</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="n">uid</span><span class="p">]</span>
<span class="n">tbl</span> <span class="o">=</span> <span class="n">hdr</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tbl</span><span class="p">)</span>

<span class="n">w9_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">hdr</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s2">&quot;w9_image&quot;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of points before change: 100000
Number of points after change: 1000000


Transient Scan ID: 1     Time: 2023-08-19 16:54:12
Persistent Unique Scan ID: &#39;37b7be0b-dd3a-45ce-b135-5ca6f4e4409c&#39;
New stream: &#39;primary&#39;
+-----------+------------+-------------------------+-------------+------------+
|   seq_num |       time | aperture_horizontalSize | w9_duration |    w9_flux |
+-----------+------------+-------------------------+-------------+------------+
|         1 | 16:54:33.8 |                   0.000 |      19.323 |      0.000 |
|         2 | 16:54:52.1 |                   0.400 |      16.232 |   5138.520 |
|         3 | 16:55:10.5 |                   0.800 |      16.225 |  10251.164 |
|         4 | 16:55:28.9 |                   1.200 |      16.284 |  15406.536 |
|         5 | 16:55:47.4 |                   1.600 |      16.243 |  20619.667 |
|         6 | 16:56:05.7 |                   2.000 |      16.231 |  25819.524 |
+-----------+------------+-------------------------+-------------+------------+
generator scan [&#39;37b7be0b&#39;] (scan num: 1)



                                 time  \
seq_num
1       2023-08-19 16:54:33.845823765
2       2023-08-19 16:54:52.169906378
3       2023-08-19 16:55:10.515789747
4       2023-08-19 16:55:28.922255754
5       2023-08-19 16:55:47.416069984
6       2023-08-19 16:56:05.779393435

                                       w9_sirepo_data_json  \
seq_num
1        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
2        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
3        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
4        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
5        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
6        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...

                                       w9_sirepo_data_hash  w9_duration  \
seq_num
1        b21f59de0f2a128774aa69e087d8d88f0ab9550be9fd2c...    19.322850
2        864811b059113828eb518392d146dbb54038113349986b...    16.232152
3        1173d167fcee94f49ca78a7e5ed8fe7b18acd1c2acb1f4...    16.225222
4        41596e16c15c160b3c583046992f9862d540682e059e30...    16.284376
5        3f4a3bef8d820d8a683aec278b6ee918c3d56c6e5f5386...    16.243160
6        5cdff1353a7620b0feb848b2e0f296bfeb07d2e33feee3...    16.230777

                                                  w9_image    w9_shape  \
seq_num
1        [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...  [100, 100]
2        [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...  [100, 100]
3        [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...  [100, 100]
4        [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...  [100, 100]
5        [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...  [100, 100]
6        [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...  [100, 100]

              w9_flux   w9_mean      w9_x      w9_y  w9_fwhm_x  w9_fwhm_y  \
seq_num
1            0.000000  0.000000       NaN       NaN        NaN        NaN
2         5138.520058  0.513852  0.197259 -0.152572   1.108809   0.701000
3        10251.164164  1.025116  0.196433 -0.145201   1.141733   0.681383
4        15406.536271  1.540654  0.201374 -0.137640   1.186571   0.659964
5        20619.667190  2.061967  0.232234 -0.137607   1.242215   0.634798
6        25819.524119  2.581952  0.264168 -0.132240   1.296800   0.613439

         w9_photon_energy                       w9_horizontal_extent  \
seq_num
1              2500.00041                          [-1000.0, 1000.0]
2              2500.00041   [-1.2336298496814044, 1.405929122101391]
3              2500.00041  [-1.3001551718158006, 1.4759384530988693]
4              2500.00041  [-1.3684114360191872, 1.5466178480457953]
5              2500.00041  [-1.4309472940233552, 1.6109566331651013]
6              2500.00041   [-1.5036858677506284, 1.695592271987839]

                                 w9_vertical_extent  w9_id w9_title w9_type  \
seq_num
1                                 [-1000.0, 1000.0]   12.0       W9   watch
2         [-0.7103102913794072, 0.4591117629407924]   12.0       W9   watch
3        [-0.7162298148739806, 0.47877690974846177]   12.0       W9   watch
4        [-0.7162298148739806, 0.49331718361385357]   12.0       W9   watch
5        [-0.7162298148739806, 0.49331718361385357]   12.0       W9   watch
6         [-0.7162298148739806, 0.5058855096921268]   12.0       W9   watch

         w9_element_position  aperture_horizontalSize
seq_num
1                     57.142                      0.0
2                     57.142                      0.4
3                     57.142                      0.8
4                     57.142                      1.2
5                     57.142                      1.6
6                     57.142                      2.0
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_3_1.png" src="../_images/notebooks_shadow_3_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">ImageGrid</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data shape: </span><span class="si">{</span><span class="n">w9_image</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">num_frames</span> <span class="o">=</span> <span class="n">w9_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num_frames</span> <span class="o">/</span> <span class="n">ncols</span><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span>
    <span class="n">fig</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
    <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span>
    <span class="n">axes_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">im</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">w9_image</span><span class="p">[:,</span> <span class="o">...</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Data shape: (6, 100, 100)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_4_1.png" src="../_images/notebooks_shadow_4_1.png" />
</div>
</div>
</section>
<section id="Run-%22Beam-Statistics%22-Sirepo/Shadow-app-simulations">
<h2>Run “Beam Statistics” Sirepo/Shadow app simulations<a class="headerlink" href="#Run-%22Beam-Statistics%22-Sirepo/Shadow-app-simulations" title="Link to this heading">#</a></h2>
<p>In this example, we scan the toroidal mirror’s radius and collect the results of the “Beam Statistics” report on the “Beamline” page of Sirepo/Shadow app. At the end of the execution, we provide the timing report for these simulations.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sirepo_bluesky</span> <span class="kn">import</span> <span class="n">prepare_re_env</span>

<span class="o">%</span><span class="k">run</span> -i $prepare_re_env.__file__

<span class="kn">from</span> <span class="nn">sirepo_bluesky.sirepo_bluesky</span> <span class="kn">import</span> <span class="n">SirepoBluesky</span>
<span class="kn">from</span> <span class="nn">sirepo_bluesky.sirepo_ophyd</span> <span class="kn">import</span> <span class="n">BeamStatisticsReport</span><span class="p">,</span> <span class="n">create_classes</span>

<span class="n">connection</span> <span class="o">=</span> <span class="n">SirepoBluesky</span><span class="p">(</span><span class="s2">&quot;http://localhost:8000&quot;</span><span class="p">)</span>

<span class="n">data</span><span class="p">,</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">auth</span><span class="p">(</span><span class="s2">&quot;shadow&quot;</span><span class="p">,</span> <span class="n">sim_id</span><span class="o">=</span><span class="s2">&quot;00000002&quot;</span><span class="p">)</span>

<span class="n">classes</span><span class="p">,</span> <span class="n">objects</span> <span class="o">=</span> <span class="n">create_classes</span><span class="p">(</span><span class="n">connection</span><span class="o">=</span><span class="n">connection</span><span class="p">)</span>
<span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">objects</span><span class="p">)</span>

<span class="n">bsr</span> <span class="o">=</span> <span class="n">BeamStatisticsReport</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;bsr&quot;</span><span class="p">,</span> <span class="n">connection</span><span class="o">=</span><span class="n">connection</span><span class="p">)</span>

<span class="n">toroid</span><span class="o">.</span><span class="n">r_maj</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;hinted&quot;</span>
<span class="n">bsr</span><span class="o">.</span><span class="n">duration</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;hinted&quot;</span>

<span class="n">scan_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10_000</span><span class="p">,</span> <span class="mi">50_000</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>

<span class="p">(</span><span class="n">uid</span><span class="p">,)</span> <span class="o">=</span> <span class="n">RE</span><span class="p">(</span><span class="n">bp</span><span class="o">.</span><span class="n">scan</span><span class="p">([</span><span class="n">bsr</span><span class="p">],</span> <span class="n">toroid</span><span class="o">.</span><span class="n">r_maj</span><span class="p">,</span> <span class="o">*</span><span class="n">scan_range</span><span class="p">))</span>

<span class="n">hdr</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="n">uid</span><span class="p">]</span>
<span class="n">tbl</span> <span class="o">=</span> <span class="n">hdr</span><span class="o">.</span><span class="n">table</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tbl</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


Transient Scan ID: 1     Time: 2023-08-19 16:56:16
Persistent Unique Scan ID: &#39;4d82ddc6-bbec-4dfe-ab5e-14dd090798b0&#39;
New stream: &#39;primary&#39;
+-----------+------------+--------------+--------------+
|   seq_num |       time | toroid_r_maj | bsr_duration |
+-----------+------------+--------------+--------------+
|         1 | 16:56:19.7 |    10000.000 |        3.066 |
|         2 | 16:56:22.8 |    12000.000 |        3.059 |
|         3 | 16:56:25.9 |    14000.000 |        3.060 |
|         4 | 16:56:29.1 |    16000.000 |        3.058 |
|         5 | 16:56:32.2 |    18000.000 |        3.058 |
|         6 | 16:56:35.3 |    20000.000 |        3.062 |
|         7 | 16:56:38.5 |    22000.000 |        3.060 |
|         8 | 16:56:41.6 |    24000.000 |        3.057 |
|         9 | 16:56:44.7 |    26000.000 |        3.060 |
|        10 | 16:56:47.9 |    28000.000 |        3.058 |
|        11 | 16:56:51.0 |    30000.000 |        3.058 |
|        12 | 16:56:54.1 |    32000.000 |        3.059 |
|        13 | 16:56:57.2 |    34000.000 |        3.058 |
|        14 | 16:57:00.4 |    36000.000 |        3.059 |
|        15 | 16:57:03.5 |    38000.000 |        3.059 |
|        16 | 16:57:06.6 |    40000.000 |        3.059 |
|        17 | 16:57:09.8 |    42000.000 |        3.058 |
|        18 | 16:57:12.9 |    44000.000 |        3.060 |
|        19 | 16:57:16.0 |    46000.000 |        3.056 |
|        20 | 16:57:19.2 |    48000.000 |        3.060 |
|        21 | 16:57:22.3 |    50000.000 |        3.058 |
+-----------+------------+--------------+--------------+
generator scan [&#39;4d82ddc6&#39;] (scan num: 1)



                                 time  toroid_r_maj  \
seq_num
1       2023-08-19 16:56:19.729102850       10000.0
2       2023-08-19 16:56:22.864973783       12000.0
3       2023-08-19 16:56:25.998396873       14000.0
4       2023-08-19 16:56:29.127140045       16000.0
5       2023-08-19 16:56:32.259178162       18000.0
6       2023-08-19 16:56:35.388878584       20000.0
7       2023-08-19 16:56:38.519377708       22000.0
8       2023-08-19 16:56:41.646494389       24000.0
9       2023-08-19 16:56:44.779374123       26000.0
10      2023-08-19 16:56:47.910736322       28000.0
11      2023-08-19 16:56:51.040197372       30000.0
12      2023-08-19 16:56:54.167011499       32000.0
13      2023-08-19 16:56:57.293066263       34000.0
14      2023-08-19 16:57:00.420836687       36000.0
15      2023-08-19 16:57:03.549652338       38000.0
16      2023-08-19 16:57:06.679706335       40000.0
17      2023-08-19 16:57:09.808405876       42000.0
18      2023-08-19 16:57:12.942813396       44000.0
19      2023-08-19 16:57:16.070492268       46000.0
20      2023-08-19 16:57:19.203583717       48000.0
21      2023-08-19 16:57:22.331832647       50000.0

                                      bsr_sirepo_data_json  \
seq_num
1        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
2        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
3        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
4        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
5        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
6        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
7        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
8        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
9        {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
10       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
11       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
12       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
13       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
14       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
15       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
16       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
17       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
18       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
19       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
20       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...
21       {&#34;models&#34;: {&#34;beamStatisticsReport&#34;: {&#34;driftDiv...

                                      bsr_sirepo_data_hash  bsr_duration  \
seq_num
1        23384cb65d21308e202362ab7fcf312822bb1880b9c3f4...      3.065517
2        47908827c35d92e6cf7b4d5196ab8189fa8ead530449dc...      3.059052
3        778cb1b625d1399eeb84dca1ab0e849beb572b6ceb571e...      3.059620
4        c748573d5063a7cf69aeb17f787aa22d5d76b94a5bbbbe...      3.057929
5        3aced853bd345b13438f1f4842bc6c9bb20dadd19a2b37...      3.058033
6        70e525b680558671de280fc7123d090c7edf86654b7a05...      3.061732
7        7d360f61203fd15abeaf658c58cdc5a86a906d84b24df6...      3.060186
8        2644f0030b40981dd2ac70cb09069be1a103b30c57585a...      3.057071
9        c544e7fef721b07417014fcd6256d745abd819fb255fd2...      3.059635
10       8acf44c01070626f2dfe8f14a8f1c82c1dc54ce4439dd6...      3.058188
11       e3d9eef16674a150d3b09b8ac6044d6d8643816d79efc4...      3.058486
12       c39fc9a2e76af52670ec5ec7c22280553700367864f300...      3.059361
13       7cc5747f57774f0085e5db12f68edc716fb899ea6678c2...      3.058004
14       265dd233bb319ee2d21e764949c113c406edb1a83d0ed7...      3.058593
15       486c25ef692b50505eebf3dc6ee6d45d3838c32d58777f...      3.058763
16       b97c739828f7a04e65fd966eba32174a830d545e6802d5...      3.058876
17       9577121f52402a3482dfdd269a6586add965fb64240b66...      3.058004
18       f52211c94bd668ee0272940ac83bcf8ee1519ff6a7094b...      3.060068
19       45002de58bf16bd5f10fa211ccc6e77a44bb113a595d0e...      3.056486
20       07d13e3a7473027d0f8cb683ddc8f62ca53695ab9b4655...      3.059801
21       ef48ecfb7c098bb9530aea89096cf8b6f7aa588f06e12a...      3.057635

                                                bsr_report
seq_num
1        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
2        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
3        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
4        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
5        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
6        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
7        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
8        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
9        {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
10       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
11       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
12       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
13       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
14       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
15       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
16       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
17       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
18       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
19       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
20       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
21       {&#34;angxpzp&#34;: [0.0, -1.7793448589854113e-20, -3....
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_6_1.png" src="../_images/notebooks_shadow_6_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;toroid_r_maj&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;bsr_report&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;s&quot;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;sigmax&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Horizonal RMS Beam Size [m]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;s&quot;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;sigmaz&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Vertical RMS Beam Size [m]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Distance Along Beamline [m]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;toroid_r_maj = </span><span class="si">{</span><span class="n">tbl</span><span class="p">[</span><span class="s1">&#39;toroid_r_maj&#39;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/tmp/ipykernel_5424/2351232241.py:6: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  plt.figure(figsize=(16, 4))
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_1.png" src="../_images/notebooks_shadow_7_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_2.png" src="../_images/notebooks_shadow_7_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_3.png" src="../_images/notebooks_shadow_7_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_4.png" src="../_images/notebooks_shadow_7_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_5.png" src="../_images/notebooks_shadow_7_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_6.png" src="../_images/notebooks_shadow_7_6.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_7.png" src="../_images/notebooks_shadow_7_7.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_8.png" src="../_images/notebooks_shadow_7_8.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_9.png" src="../_images/notebooks_shadow_7_9.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_10.png" src="../_images/notebooks_shadow_7_10.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_11.png" src="../_images/notebooks_shadow_7_11.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_12.png" src="../_images/notebooks_shadow_7_12.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_13.png" src="../_images/notebooks_shadow_7_13.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_14.png" src="../_images/notebooks_shadow_7_14.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_15.png" src="../_images/notebooks_shadow_7_15.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_16.png" src="../_images/notebooks_shadow_7_16.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_17.png" src="../_images/notebooks_shadow_7_17.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_18.png" src="../_images/notebooks_shadow_7_18.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_19.png" src="../_images/notebooks_shadow_7_19.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_20.png" src="../_images/notebooks_shadow_7_20.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_7_21.png" src="../_images/notebooks_shadow_7_21.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/</span> <span class="mf">1e9</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">scan_range</span><span class="p">)[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Duration of simulations&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Duration of simulations [s]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Torus Major Radius [m]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Averaged duration&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">title</span> <span class="o">=</span> <span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Shadow TES simulation</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot;RE(bp.scan([bsr], toroid.r_maj, &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">scan_range</span><span class="p">])</span><span class="si">}</span><span class="s2">))&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_shadow_8_0.png" src="../_images/notebooks_shadow_8_0.png" />
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="madx.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">MAD-X Simulations</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="srw.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">SRW Simulations</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2020, Brookhaven National Laboratory
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Shadow Simulations</a><ul>
<li><a class="reference internal" href="#Run-%22Beamline%22-Shadow3-simulations">Run “Beamline” Shadow3 simulations</a></li>
<li><a class="reference internal" href="#Run-%22Beam-Statistics%22-Sirepo/Shadow-app-simulations">Run “Beam Statistics” Sirepo/Shadow app simulations</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=6dfdf7c3"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>