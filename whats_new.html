


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>What’s new &mdash; DataBroker and DataMuxer 0.0.6 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="DataBroker and DataMuxer 0.0.6 documentation" href="index.html"/>
        <link rel="next" title="DataBroker Basics" href="basics.html"/>
        <link rel="prev" title="dataportal.muxer.BadDownsamplerError" href="generated/dataportal.muxer.BadDownsamplerError.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> DataBroker and DataMuxer</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api.html">API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#data-broker">Data Broker</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#data-muxer">Data Muxer</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">What&#8217;s new</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#dataportal-v0-2-2">Dataportal v0.2.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dataportal-v0-2-1">Dataportal v0.2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dataportal-v0-2-0">Dataportal v0.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dataportal-v0-0-6">Dataportal v0.0.6</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">DataBroker Basics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="basics.html#what-is-the-data-broker">What is the Data Broker?</a></li>
<li class="toctree-l2"><a class="reference internal" href="basics.html#quick-start">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="basics.html#basic-example-plotting-the-most-recent-scan">Basic Example: Plotting The Most Recent Scan</a></li>
<li class="toctree-l2"><a class="reference internal" href="basics.html#more-ways-to-look-up-scans">More Ways to Look Up Scans</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">DataBroker and DataMuxer</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>What&#8217;s new</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/whats_new.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="what-s-new">
<span id="whats-new"></span><h1>What&#8217;s new<a class="headerlink" href="#what-s-new" title="Permalink to this headline">¶</a></h1>
<p>A catalog of new features, improvements, and bug-fixes in each release. Follow
links to the relevant GitHub issue or pull request for specific code changes
and any related discussion.</p>
<div class="section" id="dataportal-v0-2-2">
<h2>Dataportal v0.2.2<a class="headerlink" href="#dataportal-v0-2-2" title="Permalink to this headline">¶</a></h2>
<div class="section" id="bug-fixes">
<h3>Bug Fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Times, as returned by pandas-aware functions, are now reported correctly.
Previously, these times were being reported as UTC, which is 4 or 5 hours
different from US/Eastern time, depending on the time of year. (<a class="reference external" href="https://github.com/NSLS-II/DataBroker and DataMuxer/issues/209">GH209</a>)</li>
</ul>
</div>
</div>
<div class="section" id="dataportal-v0-2-1">
<h2>Dataportal v0.2.1<a class="headerlink" href="#dataportal-v0-2-1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="api-changes">
<h3>API Changes<a class="headerlink" href="#api-changes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><cite>get_images</cite> (as alias for <cite>Images</cite>) added for consistency with other
function names</li>
<li><cite>SubtractedImages</cite> removed; prefer PIMS pipeline feature.</li>
</ul>
</div>
</div>
<div class="section" id="dataportal-v0-2-0">
<h2>Dataportal v0.2.0<a class="headerlink" href="#dataportal-v0-2-0" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>API Changes<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><cite>DataBroker[]</cite> for slicing by scan ID(s) or recency</li>
<li><cite>DataBroker()</cite> for building queries from keyword arguments</li>
<li><cite>get_events</cite>  return events generator</li>
<li><cite>get_table</cite>  return DataFrame</li>
<li><cite>Header</cite>, vastly simplified: it is merely <cite>Document</cite> with a dedicated
constructor that accepts a Run Start Document</li>
</ul>
</div>
</div>
<div class="section" id="dataportal-v0-0-6">
<h2>Dataportal v0.0.6<a class="headerlink" href="#dataportal-v0-0-6" title="Permalink to this headline">¶</a></h2>
<div class="section" id="enhancements">
<h3>Enhancements<a class="headerlink" href="#enhancements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>A new <tt class="docutils literal"><span class="pre">StepScan</span></tt> interface acts like <tt class="docutils literal"><span class="pre">DataBroker</span></tt>
but immediately returns tabular data as a DataFrame in one step.
(<a class="reference external" href="https://github.com/NSLS-II/DataBroker and DataMuxer/issues/136">GH136</a>)</li>
<li>Look up scans by the name of a detector or motor used.
For example, to get all scans that measured &#8216;Tsam&#8217;, use
<tt class="docutils literal"><span class="pre">DataBroker.find_headers(data_key='Tsam')</span></tt>. (<a class="reference external" href="https://github.com/NSLS-II/DataBroker and DataMuxer/issues/88">GH88</a>, <a class="reference external" href="https://github.com/NSLS-II/DataBroker and DataMuxer/issues/107">GH107</a>)</li>
<li>Look up scans using the first few characters of its unique ID,
like <tt class="docutils literal"><span class="pre">DataBroker['aow23oif']</span></tt>. To be clear this is the
ophyd-provided uid, not the mongo _id. (<a class="reference external" href="https://github.com/NSLS-II/DataBroker and DataMuxer/issues/130">GH130</a>, <a class="reference external" href="https://github.com/NSLS-II/DataBroker and DataMuxer/issues/131">GH131</a>)</li>
<li>Replay remembers settings when flipping between scans, and it
retains these settings between sessions. (<a class="reference external" href="https://github.com/NSLS-II/DataBroker and DataMuxer/issues/114">GH114</a>)</li>
<li><tt class="docutils literal"><span class="pre">DataMuxer.to_sparse_dataframe</span></tt> returns all data with one Event
per row. (<a class="reference external" href="https://github.com/NSLS-II/DataBroker and DataMuxer/issues/134">GH134</a>)</li>
<li><tt class="docutils literal"><span class="pre">DataMuxer.plan.bin_on</span></tt> and <tt class="docutils literal"><span class="pre">DataMuxer.plan.bin_by_edges</span></tt>
explain the planned operation of <tt class="docutils literal"><span class="pre">DataMuxer.bin_on</span></tt> and
<tt class="docutils literal"><span class="pre">DataMuxer.bin_by_edges</span></tt> for a given data set and given arguments.
(<a class="reference external" href="https://github.com/NSLS-II/DataBroker and DataMuxer/issues/134">GH134</a>)</li>
</ul>
</div>
<div class="section" id="id2">
<h3>API Changes<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The Event documents are reorganized to be more intuitive
and require less typing. Formerly, <tt class="docutils literal"><span class="pre">event.data</span></tt> returned
a dictionary of <tt class="docutils literal"><span class="pre">(value,</span> <span class="pre">timestamp)</span></tt> tuples.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">event</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;motor1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">),</span>
              <span class="s">&#39;motor2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)}</span>
</pre></div>
</div>
<p>Now, <tt class="docutils literal"><span class="pre">event.data</span></tt> is dictionary of the data</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">event</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;motor1&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span> <span class="s">&#39;motor2&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">}</span>
</pre></div>
</div>
<p>and <tt class="docutils literal"><span class="pre">event.timestamp</span></tt> is a dictionary of the timestamps.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">event</span><span class="o">.</span><span class="n">timestamps</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;motor1&#39;</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">,</span> <span class="s">&#39;motor2&#39;</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">}</span>
</pre></div>
</div>
<p>(<a class="reference external" href="https://github.com/NSLS-II/DataBroker and DataMuxer/issues/129">GH129</a>, <a class="reference external" href="https://github.com/NSLS-II/DataBroker and DataMuxer/issues/132">GH132</a>)</p>
</li>
<li><p class="first">All functions that return Documents, including Headers,
Events, and everything stored in metadatastore and filestore,
now return Python generators, iterable objects that load
data one element at a time. To convert these to normal Python
lists, simply use <tt class="docutils literal"><span class="pre">list(gen)</span></tt>. (<a class="reference external" href="https://github.com/NSLS-II/DataBroker and DataMuxer/issues/127">GH127</a>)</p>
</li>
<li><p class="first">The output of <tt class="docutils literal"><span class="pre">DataMuxer.bin_*</span></tt> functions is indexed by
bin number (0, 1, 2...). The Event time is given as a column.</p>
</li>
<li><p class="first">Metadatastore and filestore require configuration settings.
They look in the following locations, in increasing order of
precedence. Use #3 or #4 to customize your own metadatastore
and filestore.</p>
<ol class="arabic simple">
<li><tt class="file docutils literal"><span class="pre">CONDA_ENV/etc/</span><em><span class="pre">name</span></em><span class="pre">.yaml</span></tt> (if <tt class="docutils literal"><span class="pre">CONDA_ETC_</span></tt> env is defined)</li>
<li><tt class="file docutils literal"><span class="pre">/etc/</span><em><span class="pre">name</span></em><span class="pre">.yaml</span></tt></li>
<li><tt class="file docutils literal"><span class="pre">~/.config/</span><em><span class="pre">name</span></em><span class="pre">/connection.yml</span></tt></li>
<li>reading environmental variables formatted like <tt class="docutils literal"><span class="pre">MDS_DATABASE</span></tt> or <tt class="docutils literal"><span class="pre">FS_DATABASE</span></tt></li>
</ol>
<p>For example, in <tt class="file docutils literal"><span class="pre">~/.config/metadatastore/connection.yaml</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre>host: localhost
port: 27017
database: my_metadatastore
timezone: US/Eastern
</pre></div>
</div>
<p>and likewise with filestore/connection.yaml.
(Filestore does not need a timezone field, however.)
If no configuration can be found, they will raise an error on
import. We avoid defaults so that experimental data cannot be
accidentally saved to an unsafe destination.</p>
</li>
<li><p class="first">Metadatastore configuration also requires a <tt class="docutils literal"><span class="pre">timezone</span></tt> field,
which is uses to interpret human-friendly datetimes.</p>
</li>
</ul>
</div>
<div class="section" id="id3">
<h3>Bug Fixes<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>All DataMuxer output is sorted by Event time. (<a class="reference external" href="https://github.com/NSLS-II/DataBroker and DataMuxer/issues/134">GH134</a>)</li>
</ul>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="basics.html" class="btn btn-neutral float-right" title="DataBroker Basics">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="generated/dataportal.muxer.BadDownsamplerError.html" class="btn btn-neutral" title="dataportal.muxer.BadDownsamplerError"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015 Brookhaven National Lab.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.6',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>