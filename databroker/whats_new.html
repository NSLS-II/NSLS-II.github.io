


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Release Notes &mdash; DataBroker 0.0.6 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="DataBroker 0.0.6 documentation" href="index.html"/>
        <link rel="prev" title="Fetching Data" href="fetching.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> DataBroker
          

          
          </a>

          
            
            
              <div class="version">
                0.0.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="headers.html">How Data and Metadata are Organized</a></li>
<li class="toctree-l1"><a class="reference internal" href="searching.html">Searching for Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="fetching.html">Fetching Data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#v0-6-2">v0.6.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#enhancements">Enhancements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bug-fixes">Bug Fixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#v0-6-1">v0.6.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Enhancements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#v0-6-0">v0.6.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">Bug Fixes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Enhancements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api-changes">API Changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#v0-5-0">v0.5.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id4">API Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">Enhancements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dataportal-v0-2-2">dataportal v0.2.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id6">Bug Fixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dataportal-v0-2-1">dataportal v0.2.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id7">API Changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dataportal-v0-2-0">dataportal v0.2.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id8">API Changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dataportal-v0-0-6">Dataportal v0.0.6</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id9">Enhancements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">API Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">Bug Fixes</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">DataBroker</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Release Notes</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/whats_new.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="release-notes">
<span id="whats-new"></span><h1>Release Notes<a class="headerlink" href="#release-notes" title="Permalink to this headline">¶</a></h1>
<p>A catalog of new features, improvements, and bug-fixes in each release. Follow
links to the relevant GitHub issue or pull request for specific code changes
and any related discussion.</p>
<div class="section" id="v0-6-2">
<h2>v0.6.2<a class="headerlink" href="#v0-6-2" title="Permalink to this headline">¶</a></h2>
<div class="section" id="enhancements">
<h3>Enhancements<a class="headerlink" href="#enhancements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Add convenience method for exporting from one Broker instance into another.</li>
<li>Experimental: support regex-based field selection in Broker methods.</li>
</ul>
</div>
<div class="section" id="bug-fixes">
<h3>Bug Fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Fix handling of timezones. To summarize: all times are <em>stored</em> as a float
number that is a UNIX timestamp (number of seconds since 1970 in Greenwich).
The <code class="docutils literal"><span class="pre">get_events</span></code> method simply returns this raw number. The <code class="docutils literal"><span class="pre">get_table</span></code>
method provides the option (on by default) to convert these float numbers to
datetime objects, which can be more convenient in some circumstances. There
are two flags for controlling this feature: <code class="docutils literal"><span class="pre">convert_times</span></code> and
<code class="docutils literal"><span class="pre">localize_times</span></code>. By default, <code class="docutils literal"><span class="pre">convert_times=True</span></code> and
<code class="docutils literal"><span class="pre">localize_times=True</span></code>. This returns pandas datetime64 objects that are
&#8220;naive&#8221; (meaning they don&#8217;t have a timezone attached) and are in the local
time. This tells you the wall clock time when the experiment was performed in
timezone configured in <code class="docutils literal"><span class="pre">db.mds.config['timezone']</span></code>. If
<code class="docutils literal"><span class="pre">localize_times=False</span></code>, the datetime objects are again &#8220;naive&#8221; but in UTC
time. This tells you the wall clock time of a clock in Greenwich when the
experiment was performed.</li>
</ul>
</div>
</div>
<div class="section" id="v0-6-1">
<h2>v0.6.1<a class="headerlink" href="#v0-6-1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>Enhancements<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Remove hard dependency on metadatastore and filestore packages so that
other providers of metadatastore and filestore interface may be used instead.</li>
</ul>
</div>
</div>
<div class="section" id="v0-6-0">
<h2>v0.6.0<a class="headerlink" href="#v0-6-0" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id2">
<h3>Bug Fixes<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Make <code class="docutils literal"><span class="pre">get_table</span></code> properly respect its <code class="docutils literal"><span class="pre">stream_name</span></code> argument. (Previously
any value but default returned an empty result.)</p>
</div>
<div class="section" id="id3">
<h3>Enhancements<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Allow <code class="docutils literal"><span class="pre">Broker</span></code> to be imported without configuration present.</li>
<li>Add stateful &#8220;filters&#8221; to restrict searches.</li>
<li>Add aliases to save searches during a session.</li>
<li>Overhaul documents and tests.</li>
</ul>
</div>
<div class="section" id="api-changes">
<h3>API Changes<a class="headerlink" href="#api-changes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The default value of <code class="docutils literal"><span class="pre">stream_name</span></code> in <code class="docutils literal"><span class="pre">get_events</span></code> is now <code class="docutils literal"><span class="pre">ALL</span></code>, a
sentinel value. (The default for <code class="docutils literal"><span class="pre">get_table</span></code> is still <code class="docutils literal"><span class="pre">'primary'</span></code>, but it
now also accepts <code class="docutils literal"><span class="pre">ALL</span></code>.)</li>
</ul>
</div>
</div>
<div class="section" id="v0-5-0">
<h2>v0.5.0<a class="headerlink" href="#v0-5-0" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id4">
<h3>API Changes<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Change kwarg <code class="docutils literal"><span class="pre">name</span></code> to <code class="docutils literal"><span class="pre">stream_name</span></code> to select a descriptor by name</li>
<li>Requires filestore &gt;= v0.5.0</li>
</ul>
</div>
<div class="section" id="id5">
<h3>Enhancements<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Learned how to get all of the FS resource documents from a header</li>
</ul>
</div>
</div>
<div class="section" id="dataportal-v0-2-2">
<h2>dataportal v0.2.2<a class="headerlink" href="#dataportal-v0-2-2" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id6">
<h3>Bug Fixes<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Times, as returned by pandas-aware functions, are now reported correctly.
Previously, these times were being reported as UTC, which is 4 or 5 hours
different from US/Eastern time, depending on the time of year. (<a class="reference external" href="https://github.com/NSLS-II/DataBroker/issues/209">GH209</a>)</li>
</ul>
</div>
</div>
<div class="section" id="dataportal-v0-2-1">
<h2>dataportal v0.2.1<a class="headerlink" href="#dataportal-v0-2-1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id7">
<h3>API Changes<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><cite>get_images</cite> (as alias for <cite>Images</cite>) added for consistency with other
function names</li>
<li><cite>SubtractedImages</cite> removed; prefer PIMS pipeline feature.</li>
</ul>
</div>
</div>
<div class="section" id="dataportal-v0-2-0">
<h2>dataportal v0.2.0<a class="headerlink" href="#dataportal-v0-2-0" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id8">
<h3>API Changes<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><cite>DataBroker[]</cite> for slicing by scan ID(s) or recency</li>
<li><cite>DataBroker()</cite> for building queries from keyword arguments</li>
<li><cite>get_events</cite>  return events generator</li>
<li><cite>get_table</cite>  return DataFrame</li>
<li><cite>Header</cite>, vastly simplified: it is merely <cite>Document</cite> with a dedicated
constructor that accepts a Run Start Document</li>
</ul>
</div>
</div>
<div class="section" id="dataportal-v0-0-6">
<h2>Dataportal v0.0.6<a class="headerlink" href="#dataportal-v0-0-6" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id9">
<h3>Enhancements<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>A new <code class="docutils literal"><span class="pre">StepScan</span></code> interface acts like <code class="docutils literal"><span class="pre">DataBroker</span></code>
but immediately returns tabular data as a DataFrame in one step.
(<a class="reference external" href="https://github.com/NSLS-II/DataBroker/issues/136">GH136</a>)</li>
<li>Look up scans by the name of a detector or motor used.
For example, to get all scans that measured &#8216;Tsam&#8217;, use
<code class="docutils literal"><span class="pre">DataBroker.find_headers(data_key='Tsam')</span></code>. (<a class="reference external" href="https://github.com/NSLS-II/DataBroker/issues/88">GH88</a>, <a class="reference external" href="https://github.com/NSLS-II/DataBroker/issues/107">GH107</a>)</li>
<li>Look up scans using the first few characters of its unique ID,
like <code class="docutils literal"><span class="pre">DataBroker['aow23oif']</span></code>. To be clear this is the
ophyd-provided uid, not the mongo _id. (<a class="reference external" href="https://github.com/NSLS-II/DataBroker/issues/130">GH130</a>, <a class="reference external" href="https://github.com/NSLS-II/DataBroker/issues/131">GH131</a>)</li>
<li>Replay remembers settings when flipping between scans, and it
retains these settings between sessions. (<a class="reference external" href="https://github.com/NSLS-II/DataBroker/issues/114">GH114</a>)</li>
<li><code class="docutils literal"><span class="pre">DataMuxer.to_sparse_dataframe</span></code> returns all data with one Event
per row. (<a class="reference external" href="https://github.com/NSLS-II/DataBroker/issues/134">GH134</a>)</li>
<li><code class="docutils literal"><span class="pre">DataMuxer.plan.bin_on</span></code> and <code class="docutils literal"><span class="pre">DataMuxer.plan.bin_by_edges</span></code>
explain the planned operation of <code class="docutils literal"><span class="pre">DataMuxer.bin_on</span></code> and
<code class="docutils literal"><span class="pre">DataMuxer.bin_by_edges</span></code> for a given data set and given arguments.
(<a class="reference external" href="https://github.com/NSLS-II/DataBroker/issues/134">GH134</a>)</li>
</ul>
</div>
<div class="section" id="id10">
<h3>API Changes<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The Event documents are reorganized to be more intuitive
and require less typing. Formerly, <code class="docutils literal"><span class="pre">event.data</span></code> returned
a dictionary of <code class="docutils literal"><span class="pre">(value,</span> <span class="pre">timestamp)</span></code> tuples.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">event</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;motor1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">),</span>
              <span class="s1">&#39;motor2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)}</span>
</pre></div>
</div>
<p>Now, <code class="docutils literal"><span class="pre">event.data</span></code> is dictionary of the data</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">event</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;motor1&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span> <span class="s1">&#39;motor2&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">}</span>
</pre></div>
</div>
<p>and <code class="docutils literal"><span class="pre">event.timestamp</span></code> is a dictionary of the timestamps.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">event</span><span class="o">.</span><span class="n">timestamps</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;motor1&#39;</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">,</span> <span class="s1">&#39;motor2&#39;</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">}</span>
</pre></div>
</div>
<p>(<a class="reference external" href="https://github.com/NSLS-II/DataBroker/issues/129">GH129</a>, <a class="reference external" href="https://github.com/NSLS-II/DataBroker/issues/132">GH132</a>)</p>
</li>
<li><p class="first">All functions that return Documents, including Headers,
Events, and everything stored in metadatastore and filestore,
now return Python generators, iterable objects that load
data one element at a time. To convert these to normal Python
lists, simply use <code class="docutils literal"><span class="pre">list(gen)</span></code>. (<a class="reference external" href="https://github.com/NSLS-II/DataBroker/issues/127">GH127</a>)</p>
</li>
<li><p class="first">The output of <code class="docutils literal"><span class="pre">DataMuxer.bin_*</span></code> functions is indexed by
bin number (0, 1, 2...). The Event time is given as a column.</p>
</li>
<li><p class="first">Metadatastore and filestore require configuration settings.
They look in the following locations, in increasing order of
precedence. Use #3 or #4 to customize your own metadatastore
and filestore.</p>
<ol class="arabic simple">
<li><code class="file docutils literal"><span class="pre">CONDA_ENV/etc/</span><em><span class="pre">name</span></em><span class="pre">.yaml</span></code> (if <code class="docutils literal"><span class="pre">CONDA_ETC_</span></code> env is defined)</li>
<li><code class="file docutils literal"><span class="pre">/etc/</span><em><span class="pre">name</span></em><span class="pre">.yaml</span></code></li>
<li><code class="file docutils literal"><span class="pre">~/.config/</span><em><span class="pre">name</span></em><span class="pre">/connection.yml</span></code></li>
<li>reading environmental variables formatted like <code class="docutils literal"><span class="pre">MDS_DATABASE</span></code> or <code class="docutils literal"><span class="pre">FS_DATABASE</span></code></li>
</ol>
<p>For example, in <code class="file docutils literal"><span class="pre">~/.config/metadatastore/connection.yaml</span></code></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">host</span><span class="p">:</span> <span class="n">localhost</span>
<span class="n">port</span><span class="p">:</span> <span class="mi">27017</span>
<span class="n">database</span><span class="p">:</span> <span class="n">my_metadatastore</span>
<span class="n">timezone</span><span class="p">:</span> <span class="n">US</span><span class="o">/</span><span class="n">Eastern</span>
</pre></div>
</div>
<p>and likewise with filestore/connection.yaml.
(Filestore does not need a timezone field, however.)
If no configuration can be found, they will raise an error on
import. We avoid defaults so that experimental data cannot be
accidentally saved to an unsafe destination.</p>
</li>
<li><p class="first">Metadatastore configuration also requires a <code class="docutils literal"><span class="pre">timezone</span></code> field,
which is uses to interpret human-friendly datetimes.</p>
</li>
</ul>
</div>
<div class="section" id="id11">
<h3>Bug Fixes<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>All DataMuxer output is sorted by Event time. (<a class="reference external" href="https://github.com/NSLS-II/DataBroker/issues/134">GH134</a>)</li>
</ul>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="fetching.html" class="btn btn-neutral" title="Fetching Data" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015 Brookhaven National Lab.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.6',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>