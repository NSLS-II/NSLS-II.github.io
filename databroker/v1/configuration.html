


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Configuration &mdash; databroker 1.0.6.post15+g676cafb documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Creating a New Database" href="creating.html" />
    <link rel="prev" title="databroker.temp_config" href="../generated/databroker.temp_config.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> databroker
          

          
          </a>

          
            
            
              <div class="version">
                1.0.6.post15+g676cafb
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../data-access-overview.html">Data Access Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Technical Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../v2/index.html">Version 2 Interface</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Version 1 Interface</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html">API Documentation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#search-path">Search Path</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#registering-handlers">Registering Handlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#coping-with-moved-files-or-different-mount-points">Coping with Moved Files or Different Mount Points</a></li>
<li class="toctree-l3"><a class="reference internal" href="#helper-functions">Helper Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="creating.html">Creating a New Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="archiver.html">Connection with Archiver Appliance</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../whats_new.html">Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DBEP/index.html">Databroker Enhancement Proposals</a></li>
</ul>
<p class="caption"><span class="caption-text">Bluesky Project</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io">Homepage</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/bluesky">GitHub</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Help</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://gitter.im/NSLS-II/DAMA">Gitter</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">databroker</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Version 1 Interface</a> &raquo;</li>
        
      <li>Configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/v1/configuration.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="configuration">
<span id="v0-configuration"></span><h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h1>
<p>Configuration files make it easy to quickly set up <code class="xref py py-class docutils literal notranslate"><span class="pre">Broker</span></code> instances
with the expression <code class="docutils literal notranslate"><span class="pre">Broker.named('example')</span></code> where ‘example’ is the name of
a configuration file.</p>
<div class="section" id="search-path">
<h2>Search Path<a class="headerlink" href="#search-path" title="Permalink to this headline">¶</a></h2>
<p>The databroker looks for configuration files in three locations, in this order:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">~/.config/databroker</span></code> (under the user’s home directory)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">python/../etc/databroker</span></code>, where <code class="docutils literal notranslate"><span class="pre">python</span></code> is the current Python binary
reported by <code class="docutils literal notranslate"><span class="pre">sys.executable</span></code> (This allows config to be provided inside a
virtual environment.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/databroker/</span></code></p></li>
</ul>
<p>A configuration file must be located in one of these directories, and it must
be named with the extension <code class="docutils literal notranslate"><span class="pre">.yml</span></code>. Configuration files are formatted as YAML
files.</p>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>This configuration file sets up a simple databroker backed by sqlite files.
This can be used immediately with no extra setup or installation.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">description</span><span class="p">:</span> <span class="s">&#39;lightweight</span><span class="nv"> </span><span class="s">personal</span><span class="nv"> </span><span class="s">database&#39;</span>
<span class="nt">metadatastore</span><span class="p">:</span>
    <span class="nt">module</span><span class="p">:</span> <span class="s">&#39;databroker.headersource.sqlite&#39;</span>
    <span class="nt">class</span><span class="p">:</span> <span class="s">&#39;MDS&#39;</span>
    <span class="nt">config</span><span class="p">:</span>
        <span class="nt">directory</span><span class="p">:</span> <span class="s">&#39;some_directory&#39;</span>
        <span class="nt">timezone</span><span class="p">:</span> <span class="s">&#39;US/Eastern&#39;</span>
<span class="nt">assets</span><span class="p">:</span>
    <span class="nt">module</span><span class="p">:</span> <span class="s">&#39;databroker.assets.sqlite&#39;</span>
    <span class="nt">class</span><span class="p">:</span> <span class="s">&#39;Registry&#39;</span>
    <span class="nt">config</span><span class="p">:</span>
        <span class="nt">dbpath</span><span class="p">:</span> <span class="s">&#39;some_directory/assets.sqlite&#39;</span>
</pre></div>
</div>
<p>This configuration file sets up a databroker that connects to a MongoDB server.
This requires more work to set up.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">description</span><span class="p">:</span> <span class="s">&#39;heavyweight</span><span class="nv"> </span><span class="s">shared</span><span class="nv"> </span><span class="s">database&#39;</span>
<span class="nt">metadatastore</span><span class="p">:</span>
    <span class="nt">module</span><span class="p">:</span> <span class="s">&#39;databroker.headersource.mongo&#39;</span>
    <span class="nt">class</span><span class="p">:</span> <span class="s">&#39;MDS&#39;</span>
    <span class="nt">config</span><span class="p">:</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&#39;localhost&#39;</span>
        <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">27017</span>
        <span class="nt">database</span><span class="p">:</span> <span class="s">&#39;some_example_database&#39;</span>
        <span class="nt">timezone</span><span class="p">:</span> <span class="s">&#39;US/Eastern&#39;</span>
<span class="nt">assets</span><span class="p">:</span>
    <span class="nt">module</span><span class="p">:</span> <span class="s">&#39;databroker.assets.mongo&#39;</span>
    <span class="nt">class</span><span class="p">:</span> <span class="s">&#39;Registry&#39;</span>
    <span class="nt">config</span><span class="p">:</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&#39;localhost&#39;</span>
        <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">27017</span>
        <span class="nt">database</span><span class="p">:</span> <span class="s">&#39;some_example_database&#39;</span>
</pre></div>
</div>
<p>In these examples, the classes used happen to be from the <code class="docutils literal notranslate"><span class="pre">databroker</span></code>
package itself, but classes from other packages can be used just as well, as
long as they present the expected API. (This API is not yet documented outside
of the source code.)</p>
</div>
<div class="section" id="registering-handlers">
<h2>Registering Handlers<a class="headerlink" href="#registering-handlers" title="Permalink to this headline">¶</a></h2>
<p>Configuration files may optionally include a section specifying ‘handlers’,
classes that load externally stored data. These may be registered at runtime or
here in configuration.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">handlers</span><span class="p">:</span>
    <span class="nt">FOO</span><span class="p">:</span>
        <span class="nt">module</span><span class="p">:</span> <span class="s">&#39;databroker.assets.path_only_handlers&#39;</span>
        <span class="nt">class</span><span class="p">:</span> <span class="s">&#39;RawHandler&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="coping-with-moved-files-or-different-mount-points">
<h2>Coping with Moved Files or Different Mount Points<a class="headerlink" href="#coping-with-moved-files-or-different-mount-points" title="Permalink to this headline">¶</a></h2>
<p>Optionally, you may set a root_map, which comes in handy when the handlers
involves mounted files that have been moved to a different mount point in the
file system.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">root_map</span><span class="p">:</span>
    <span class="nt">old_root</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">new_root</span>
    <span class="nt">old_root2</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">new_root2</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">old_root</span></code> and <code class="docutils literal notranslate"><span class="pre">old_root2</span></code> are the old mount points and <code class="docutils literal notranslate"><span class="pre">new_root</span></code>
and <code class="docutils literal notranslate"><span class="pre">new_root2</span></code> their respective new mount points.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Future versions of databroker will provide better support for multiple
asset registries and multiple sources of Event data, and this configuration
file format will change. If possible, old configuration files will still be
supported.</p>
</div>
</div>
<div class="section" id="helper-functions">
<h2>Helper Functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="api.html#configuration-utilities"><span class="std std-ref">Configuration Utilities</span></a> in the API documentation.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="creating.html" class="btn btn-neutral float-right" title="Creating a New Database" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../generated/databroker.temp_config.html" class="btn btn-neutral float-left" title="databroker.temp_config" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2015 Brookhaven National Lab

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>