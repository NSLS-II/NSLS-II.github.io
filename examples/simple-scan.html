


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Perform a simple scan with a data table and plot &mdash; NSLS-II Software Documentation  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="NSLS-II Software Documentation  documentation" href="../index.html"/>
        <link rel="up" title="Examples" href="index.html"/>
        <link rel="next" title="Retrieve metadata, tabular data, and image data" href="retrieving-data.html"/>
        <link rel="prev" title="Examples" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> NSLS-II Software Documentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../architecture-overview.html">Event-Based Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../collection-quick-start.html">Data Collection Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-quick-start.html">Data Analysis Quick Start</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Perform a simple scan with a data table and plot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#problem">Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="#approach">Approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-solution">Example Solution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="retrieving-data.html">Retrieve metadata, tabular data, and image data</a></li>
<li class="toctree-l2"><a class="reference internal" href="replot.html">Re-plot saved data</a></li>
<li class="toctree-l2"><a class="reference internal" href="pausing.html">Interruptions: interactively pause and resume</a></li>
<li class="toctree-l2"><a class="reference internal" href="concatenating-plans.html">Concatenating plans</a></li>
<li class="toctree-l2"><a class="reference internal" href="fit-peaks.html">Fit and analyze peaks</a></li>
<li class="toctree-l2"><a class="reference internal" href="header-contents.html">How metadata is organized: understand the contents of the header</a></li>
<li class="toctree-l2"><a class="reference internal" href="exporting-csv.html">Export tabular data as a CSV file</a></li>
<li class="toctree-l2"><a class="reference internal" href="exporting-images.html">Export images as TIFF files</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulation-mode.html">Inspect or rehearse a plan without touching hardware (&#8220;simulation mode&#8221;)</a></li>
<li class="toctree-l2"><a class="reference internal" href="baseline-readings.html">Take baseline readings at the beginning and end</a></li>
<li class="toctree-l2"><a class="reference internal" href="adaptive-steps.html">Use scans with adaptive step sizes</a></li>
<li class="toctree-l2"><a class="reference internal" href="count-with-exp-decay-delay.html">Take successive readings spaced exponentially in time or space</a></li>
<li class="toctree-l2"><a class="reference internal" href="flyer-progress-bar.html">Add a progress bar to a fly scan</a></li>
<li class="toctree-l2"><a class="reference internal" href="archiver-appliance-integration.html">Access EPICS Archiver Appliance via the data broker</a></li>
<li class="toctree-l2"><a class="reference internal" href="msg-hook.html">Troubleshoot a slow or stalling plan</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sandbox.html">Sandbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment-details.html">Deployment Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html">Recommended Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../technologies.html">Core Technologies</a></li>
</ul>
<p class="caption"><span class="caption-text">Data Collection</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://nsls-ii.github.io/bluesky">bluesky</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nsls-ii.github.io/ophyd">ophyd</a></li>
</ul>
<p class="caption"><span class="caption-text">Data Access</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://nsls-ii.github.io/databroker">databroker</a></li>
</ul>
<p class="caption"><span class="caption-text">Data Munging</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://nsls-ii.github.io/datamuxer">datamuxer</a></li>
</ul>
<p class="caption"><span class="caption-text">Data Export</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://nsls-ii.github.io/suitcase">suitcase</a></li>
</ul>
<p class="caption"><span class="caption-text">GitHub Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NSLS-II/">NSLS-II repositories</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NSLS-II/wishlist/issues">Wish List</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NSLS-II/Bug-Reports/issues">Bug Reports</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">NSLS-II Software Documentation</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Examples</a> &raquo;</li>
      
    <li>Perform a simple scan with a data table and plot</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/examples/simple-scan.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="perform-a-simple-scan-with-a-data-table-and-plot">
<h1>Perform a simple scan with a data table and plot<a class="headerlink" href="#perform-a-simple-scan-with-a-data-table-and-plot" title="Permalink to this headline">¶</a></h1>
<div class="section" id="problem">
<h2>Problem<a class="headerlink" href="#problem" title="Permalink to this headline">¶</a></h2>
<p>Move a motor in equally spaced steps, stopping at each position to acquire
a reading from one or more detectors.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Interested in a different kind of scan? A simple &#8220;count&#8221;? A more complex
Fermat spiral? In the solution below, replace <code class="docutils literal"><span class="pre">scan</span></code> with
<a class="reference external" href="http://nsls-ii.github.io/bluesky/plans.html#standard-plans-ready-to-use">one of these</a>.</p>
</div>
</div>
<div class="section" id="approach">
<h2>Approach<a class="headerlink" href="#approach" title="Permalink to this headline">¶</a></h2>
<p>Set up a table and a plot, create a plan, and execute it. View the live stream
of data on the table and the plot while it is collected.</p>
</div>
<div class="section" id="example-solution">
<h2>Example Solution<a class="headerlink" href="#example-solution" title="Permalink to this headline">¶</a></h2>
<p>As an example, we can use a simulated motor and detector. You can substitute
any real motors or detectors that may already be defined in your configuration.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bluesky.examples</span> <span class="kn">import</span> <span class="n">motor</span><span class="p">,</span> <span class="n">det</span>
</pre></div>
</div>
<p>We will import a <em>plan</em>, which generates instructions to be executed. We&#8217;ll
also import <code class="docutils literal"><span class="pre">LiveTable</span></code> and <code class="docutils literal"><span class="pre">LivePlot</span></code>.  Typically, this is done as part
your configuration (your IPython profile). It happens automatically at startup
and need not be typed every time.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bluesky.plans</span> <span class="kn">import</span> <span class="n">scan</span>
<span class="kn">from</span> <span class="nn">bluesky.callbacks</span> <span class="kn">import</span> <span class="n">LiveTable</span><span class="p">,</span> <span class="n">LivePlot</span>
</pre></div>
</div>
<p>First, set up a table and a plot. The table takes a list of field names to
show. The plot takes a field name for y followed (optionally) by a field name
for x.  (If only y is provided, it plots y against point number.)</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">subs</span> <span class="o">=</span> <span class="p">[</span><span class="n">LiveTable</span><span class="p">([</span><span class="s1">&#39;motor&#39;</span><span class="p">,</span> <span class="s1">&#39;det&#39;</span><span class="p">]),</span> <span class="n">LivePlot</span><span class="p">(</span><span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="s1">&#39;motor&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>You can name the variable anything you like; we call it <code class="docutils literal"><span class="pre">subs</span></code>, short for
&#8220;subscriptions.&#8221; They are functions that &#8220;subscribe&#8221; to the live stream of
data from the scan.</p>
<p>We&#8217;ll scan <code class="docutils literal"><span class="pre">motor</span></code> from -10 to 10 inclusive, sampling 15 equally-spaced
points, and reading detector <code class="docutils literal"><span class="pre">det</span></code> at each point. We specify this like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">scan</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">motor</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice that <code class="docutils literal"><span class="pre">det</span></code> is in square brackets because <code class="docutils literal"><span class="pre">scan</span></code> expects <em>list</em> of
one or more detectors.</p>
<p>Finally, this command tells the RunEngine, <code class="docutils literal"><span class="pre">RE</span></code>, to execute our scan and send
the data to <code class="docutils literal"><span class="pre">subs</span></code>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [2]: </span><span class="n">RE</span><span class="p">(</span><span class="n">scan</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">motor</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">subs</span><span class="p">)</span>
<span class="go">+-----------+------------+------------+------------+</span>
<span class="go">|   seq_num |       time |      motor |        det |</span>
<span class="go">+-----------+------------+------------+------------+</span>
<span class="go">|         2 | 01:53:15.6 |     -8.571 |      0.000 |</span>
<span class="go">|         1 | 01:53:15.5 |    -10.000 |      0.000 |</span>
<span class="go">|         3 | 01:53:15.7 |     -7.143 |      0.000 |</span>
<span class="go">|         4 | 01:53:15.8 |     -5.714 |      0.000 |</span>
<span class="go">|         5 | 01:53:15.9 |     -4.286 |      0.000 |</span>
<span class="go">|         6 | 01:53:16.0 |     -2.857 |      0.017 |</span>
<span class="go">|         7 | 01:53:16.0 |     -1.429 |      0.360 |</span>
<span class="go">|         8 | 01:53:16.1 |      0.000 |      1.000 |</span>
<span class="go">|         9 | 01:53:16.2 |      1.429 |      0.360 |</span>
<span class="go">|        10 | 01:53:16.3 |      2.857 |      0.017 |</span>
<span class="go">|        11 | 01:53:16.4 |      4.286 |      0.000 |</span>
<span class="go">|        12 | 01:53:16.4 |      5.714 |      0.000 |</span>
<span class="go">|        13 | 01:53:16.5 |      7.143 |      0.000 |</span>
<span class="go">|        14 | 01:53:16.6 |      8.571 |      0.000 |</span>
<span class="go">|        15 | 01:53:16.7 |     10.000 |      0.000 |</span>
<span class="go">+-----------+------------+------------+------------+</span>
<span class="go">generator scan [&#39;2fb87c&#39;] (scan num: 1)</span>
<span class="gh">Out[2]: </span><span class="go">[&#39;2fb87ca4-6e62-4ece-90bd-7dfefabe7209&#39;]</span>
</pre></div>
</div>
<p>This table prints line by line while the scan is executed. The bottom of the
table shows additional information, the data type and name of the plan, the
unique ID of the run, and an integer scan ID.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since other users can reset the scan ID to 1, you should not rely on it
as a long-term reference to your data. Scribble down the first 5 or 6
characters of the unique ID instead.</p>
</div>
<p>While the table prints line by line, points appear on a plot one at a time.
This is the final result:</p>
<img alt="../_images/simple-scan1.png" src="../_images/simple-scan1.png" />
<p>Let&#8217;s look again at the output from our command. As shown above, it was</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;73b23bd3-54ca-40a4-9a5f-46486e8f3a91&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>It looks like gibberish, but it&#8217;s useful: it is a list of the unique ID(s) of
the run(s) generated by the plan, and it allows usage like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">run_ids</span> <span class="o">=</span> <span class="n">RE</span><span class="p">(</span><span class="n">scan</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">motor</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">subs</span><span class="p">)</span>  <span class="c1"># assign ids to a variable</span>
<span class="n">some_function_that_analyzes_or_exports_data</span><span class="p">(</span><span class="n">run_ids</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="retrieving-data.html" class="btn btn-neutral float-right" title="Retrieve metadata, tabular data, and image data" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Examples" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015 Brookhaven National Lab.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>