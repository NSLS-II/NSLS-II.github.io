

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API Documentation &mdash; Bluesky Event Model 1.11.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
        <script type="text/javascript" src="_static/copybutton.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Release History" href="release-history.html" />
    <link rel="prev" title="Data Model" href="data-model.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Bluesky Event Model
          

          
          </a>

          
            
            
              <div class="version">
                1.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-model.html">Data Model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="release-history.html">Release History</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Bluesky Event Model</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>API Documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api-documentation">
<h1>API Documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">event-model</span></code> Python package contains tooling for composing, validating,
and transforming documents in the model.</p>
<dl class="class">
<dt id="event_model.DocumentNames">
<em class="property">class </em><code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">DocumentNames</code><a class="reference internal" href="_modules/event_model.html#DocumentNames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.DocumentNames" title="Permalink to this definition">¶</a></dt>
<dd><p>An enumeration.</p>
<dl class="attribute">
<dt id="event_model.DocumentNames.bulk_datum">
<code class="sig-name descname">bulk_datum</code><em class="property"> = 'bulk_datum'</em><a class="headerlink" href="#event_model.DocumentNames.bulk_datum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="event_model.DocumentNames.bulk_events">
<code class="sig-name descname">bulk_events</code><em class="property"> = 'bulk_events'</em><a class="headerlink" href="#event_model.DocumentNames.bulk_events" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="event_model.DocumentNames.datum">
<code class="sig-name descname">datum</code><em class="property"> = 'datum'</em><a class="headerlink" href="#event_model.DocumentNames.datum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="event_model.DocumentNames.datum_page">
<code class="sig-name descname">datum_page</code><em class="property"> = 'datum_page'</em><a class="headerlink" href="#event_model.DocumentNames.datum_page" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="event_model.DocumentNames.descriptor">
<code class="sig-name descname">descriptor</code><em class="property"> = 'descriptor'</em><a class="headerlink" href="#event_model.DocumentNames.descriptor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="event_model.DocumentNames.event">
<code class="sig-name descname">event</code><em class="property"> = 'event'</em><a class="headerlink" href="#event_model.DocumentNames.event" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="event_model.DocumentNames.event_page">
<code class="sig-name descname">event_page</code><em class="property"> = 'event_page'</em><a class="headerlink" href="#event_model.DocumentNames.event_page" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="event_model.DocumentNames.resource">
<code class="sig-name descname">resource</code><em class="property"> = 'resource'</em><a class="headerlink" href="#event_model.DocumentNames.resource" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="event_model.DocumentNames.start">
<code class="sig-name descname">start</code><em class="property"> = 'start'</em><a class="headerlink" href="#event_model.DocumentNames.start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="event_model.DocumentNames.stop">
<code class="sig-name descname">stop</code><em class="property"> = 'stop'</em><a class="headerlink" href="#event_model.DocumentNames.stop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<p>There are two dictionaries, <code class="xref py py-data docutils literal notranslate"><span class="pre">event_model.schemas</span></code> and
<code class="xref py py-data docutils literal notranslate"><span class="pre">event_model.schema_validators</span></code>, which are keyed on the members of the
<a class="reference internal" href="#event_model.DocumentNames" title="event_model.DocumentNames"><code class="xref py py-class docutils literal notranslate"><span class="pre">event_model.DocumentNames</span></code></a> enum and which are mapped, respectively, to
a schema and an associated <a class="reference external" href="https://python-jsonschema.readthedocs.io/en/stable/validate/#jsonschema.IValidator" title="(in jsonschema v3.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">jsonschema.IValidator</span></code></a>.</p>
<dl class="class">
<dt id="event_model.RunRouter">
<em class="property">class </em><code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">RunRouter</code><span class="sig-paren">(</span><em class="sig-param">factories</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#RunRouter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.RunRouter" title="Permalink to this definition">¶</a></dt>
<dd><p>Routes documents, by run, to callbacks it creates from factory functions.</p>
<p>A RunRouter is callable, and it has the signature <code class="docutils literal notranslate"><span class="pre">router(name,</span> <span class="pre">doc)</span></code>,
suitable for subscribing to the RunEngine.</p>
<p>It is configured with a list of factory functions that produce callbacks in
a two-layered scheme, described below.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is experimental. In a future release, it may be changed in a
backward-incompatible way or fully removed.</p>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>factories</strong><span class="classifier">list</span></dt><dd><p>A list of callables with the signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">factory</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">,</span> <span class="n">start_doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Callbacks</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">SubFactories</span><span class="p">]</span>
</pre></div>
</div>
<p>which should return two lists, which may be empty. All items in the
first list should be callbacks — callables with the signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">callback</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span>
</pre></div>
</div>
<p>that will receive all subsequent documents from the run including the
RunStop document. All items in the second list should be “subfactories”
with the signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">subfactory</span><span class="p">(</span><span class="s1">&#39;descriptor&#39;</span><span class="p">,</span> <span class="n">descriptor_doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Callbacks</span><span class="p">]</span>
</pre></div>
</div>
<p>These will receive each of the EventDescriptor documents for the run,
as they arrive. They must return one list, which may be empty,
containing callbacks that will receive all Events that reference that
EventDescriptor and finally the RunStop document for the run.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="method">
<dt id="event_model.RunRouter.datum_page">
<code class="sig-name descname">datum_page</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#RunRouter.datum_page"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.RunRouter.datum_page" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="event_model.RunRouter.descriptor">
<code class="sig-name descname">descriptor</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#RunRouter.descriptor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.RunRouter.descriptor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="event_model.RunRouter.event_page">
<code class="sig-name descname">event_page</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#RunRouter.event_page"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.RunRouter.event_page" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="event_model.RunRouter.resource">
<code class="sig-name descname">resource</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#RunRouter.resource"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.RunRouter.resource" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="event_model.RunRouter.start">
<code class="sig-name descname">start</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#RunRouter.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.RunRouter.start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="event_model.RunRouter.stop">
<code class="sig-name descname">stop</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#RunRouter.stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.RunRouter.stop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="event_model.DocumentRouter">
<em class="property">class </em><code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">DocumentRouter</code><a class="reference internal" href="_modules/event_model.html#DocumentRouter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.DocumentRouter" title="Permalink to this definition">¶</a></dt>
<dd><p>Route each document by type to a corresponding method.</p>
<p>When an instance is called with a document type and a document like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">router</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span>
</pre></div>
</div>
<p>the document is passed to the method of the corresponding name, as in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">getattr</span><span class="p">(</span><span class="n">router</span><span class="p">,</span> <span class="n">name</span><span class="p">)(</span><span class="n">doc</span><span class="p">)</span>
</pre></div>
</div>
<p>The method is expected to return <code class="docutils literal notranslate"><span class="pre">None</span></code> or a valid document of the same
type. It may be the original instance (passed through), a copy, or a
different dict altogether.</p>
<p>Finally, the call to <code class="docutils literal notranslate"><span class="pre">router(name,</span> <span class="pre">doc)</span></code> returns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">router</span><span class="p">,</span> <span class="n">name</span><span class="p">)(</span><span class="n">doc</span><span class="p">))</span>
</pre></div>
</div>
<dl class="method">
<dt id="event_model.DocumentRouter.bulk_datum">
<code class="sig-name descname">bulk_datum</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#DocumentRouter.bulk_datum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.DocumentRouter.bulk_datum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="event_model.DocumentRouter.bulk_events">
<code class="sig-name descname">bulk_events</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#DocumentRouter.bulk_events"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.DocumentRouter.bulk_events" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="event_model.DocumentRouter.datum">
<code class="sig-name descname">datum</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#DocumentRouter.datum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.DocumentRouter.datum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="event_model.DocumentRouter.datum_page">
<code class="sig-name descname">datum_page</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#DocumentRouter.datum_page"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.DocumentRouter.datum_page" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="event_model.DocumentRouter.descriptor">
<code class="sig-name descname">descriptor</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#DocumentRouter.descriptor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.DocumentRouter.descriptor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="event_model.DocumentRouter.event">
<code class="sig-name descname">event</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#DocumentRouter.event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.DocumentRouter.event" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="event_model.DocumentRouter.event_page">
<code class="sig-name descname">event_page</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#DocumentRouter.event_page"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.DocumentRouter.event_page" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="event_model.DocumentRouter.resource">
<code class="sig-name descname">resource</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#DocumentRouter.resource"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.DocumentRouter.resource" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="event_model.DocumentRouter.start">
<code class="sig-name descname">start</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#DocumentRouter.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.DocumentRouter.start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="event_model.DocumentRouter.stop">
<code class="sig-name descname">stop</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#DocumentRouter.stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.DocumentRouter.stop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="event_model.Filler">
<em class="property">class </em><code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">Filler</code><span class="sig-paren">(</span><em class="sig-param">handler_registry</em>, <em class="sig-param">*</em>, <em class="sig-param">include=None</em>, <em class="sig-param">exclude=None</em>, <em class="sig-param">root_map=None</em>, <em class="sig-param">handler_cache=None</em>, <em class="sig-param">resource_cache=None</em>, <em class="sig-param">datum_cache=None</em>, <em class="sig-param">descriptor_cache=None</em>, <em class="sig-param">inplace=None</em>, <em class="sig-param">retry_intervals=(0.001</em>, <em class="sig-param">0.002</em>, <em class="sig-param">0.004</em>, <em class="sig-param">0.008</em>, <em class="sig-param">0.016</em>, <em class="sig-param">0.032</em>, <em class="sig-param">0.064</em>, <em class="sig-param">0.128</em>, <em class="sig-param">0.256</em>, <em class="sig-param">0.512</em>, <em class="sig-param">1.024)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#Filler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.Filler" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass documents through, loading any externally-referenced data.</p>
<p>It is recommended to use the Filler as a context manager.  Because the
Filler manages caches of potentially expensive resources (e.g. large data
in memory) managing its lifecycle is important. If used as a context
manager, it will drop references to its caches upon exit from the
context. Unless the user holds additional references to those caches, they
will be garbage collected.</p>
<p>But for some applications, such as taking multiple passes over the same
data, it may be useful to keep a longer-lived Filler instance and then
manually delete it when finished.</p>
<p>See Examples below.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>handler_registry</strong><span class="classifier">dict</span></dt><dd><p>Maps each ‘spec’ (a string identifying a given type or external
resource) to a handler class.</p>
<p>A ‘handler class’ may be any callable with the signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">handler_class</span><span class="p">(</span><span class="n">resource_path</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="o">**</span><span class="n">resource_kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>It is expected to return an object, a ‘handler instance’, which is also
callable and has the following signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">handler_instance</span><span class="p">(</span><span class="o">**</span><span class="n">datum_kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>As the names ‘handler class’ and ‘handler instance’ suggest, this is
typically implemented using a class that implements <code class="docutils literal notranslate"><span class="pre">__init__</span></code> and
<code class="docutils literal notranslate"><span class="pre">__call__</span></code>, with the respective signatures. But in general it may be
any callable-that-returns-a-callable.</p>
</dd>
<dt><strong>include</strong><span class="classifier">Iterable</span></dt><dd><p>The set of fields to fill. By default all unfilled fields are filled.
This parameter is mutually incompatible with the <code class="docutils literal notranslate"><span class="pre">exclude</span></code> parameter.</p>
</dd>
<dt><strong>exclude</strong><span class="classifier">Iterable</span></dt><dd><p>The set of fields to skip filling. By default all unfilled fields are
filled.  This parameter is mutually incompatible with the <code class="docutils literal notranslate"><span class="pre">include</span></code>
parameter.</p>
</dd>
<dt><strong>root_map: dict</strong></dt><dd><p>str -&gt; str mapping to account for temporarily moved/copied/remounted
files.  Any resources which have a <code class="docutils literal notranslate"><span class="pre">root</span></code> in <code class="docutils literal notranslate"><span class="pre">root_map</span></code> will be
loaded using the mapped <code class="docutils literal notranslate"><span class="pre">root</span></code>.</p>
</dd>
<dt><strong>handler_cache</strong><span class="classifier">dict, optional</span></dt><dd><p>A cache of handler instances. If None, a dict is used.</p>
</dd>
<dt><strong>resource_cache</strong><span class="classifier">dict, optional</span></dt><dd><p>A cache of Resource documents. If None, a dict is used.</p>
</dd>
<dt><strong>datum_cache</strong><span class="classifier">dict, optional</span></dt><dd><p>A cache of Datum documents. If None, a dict is used.</p>
</dd>
<dt><strong>descriptor_cache</strong><span class="classifier">dict, optional</span></dt><dd><p>A cache of EventDescriptor documents. If None, a dict is used.</p>
</dd>
<dt><strong>retry_intervals</strong><span class="classifier">Iterable, optional</span></dt><dd><p>If data is not found on the first try, there may a race between the
I/O systems creating the external data and this stream of Documents
that reference it. If Filler encounters an <code class="docutils literal notranslate"><span class="pre">IOError</span></code> it will wait a
bit and retry. This list specifies how long to sleep (in seconds)
between subsequent attempts. Set to <code class="docutils literal notranslate"><span class="pre">None</span></code> to try only once before
raising <code class="docutils literal notranslate"><span class="pre">DataNotAccessible</span></code>. A subclass may catch this exception and
implement a different retry mechanism — for example using a different
implementation of sleep from an async framework.  But by default, a
sequence of several retries with increasing sleep intervals is used.
The default sequence should not be considered stable; it may change at
any time as the authors tune it.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>DataNotAccessible</dt><dd><p>If an IOError is raised when loading the data after the configured
number of attempts. See the <code class="docutils literal notranslate"><span class="pre">retry_intervals</span></code> parameter for details.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>A Filler may be used as a context manager.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">Filler</span><span class="p">(</span><span class="n">handler_registry</span><span class="p">)</span> <span class="k">as</span> <span class="n">filler</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">filler</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span>  <span class="c1"># mutates doc in place</span>
<span class="gp">... </span>        <span class="c1"># Do some analysis or export with name and doc.</span>
</pre></div>
</div>
<p>Or as a long-lived object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Filler</span><span class="p">(</span><span class="n">handler_registry</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">filler</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span>  <span class="c1"># mutates doc in place</span>
<span class="gp">... </span>    <span class="c1"># Do some analysis or export with name and doc.</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">filler</span>  <span class="c1"># Free up memory from potentially large caches.</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="event_model.verify_filled">
<code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">verify_filled</code><span class="sig-paren">(</span><em class="sig-param">event_page</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#verify_filled"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.verify_filled" title="Permalink to this definition">¶</a></dt>
<dd><p>Take an event_page document and verify that it is completely filled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>event_page</strong><span class="classifier">event_page document</span></dt><dd><p>The event page document to check</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>UnfilledData</dt><dd><p>Raised if any of the data in the event_page is unfilled, when raised it
inlcudes a list of unfilled data objects in the exception message.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="event_model.pack_event_page">
<code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">pack_event_page</code><span class="sig-paren">(</span><em class="sig-param">*events</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#pack_event_page"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.pack_event_page" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform one or more Event documents into an EventPage document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>*event</strong><span class="classifier">dicts</span></dt><dd><p>any number of Event documents</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>event_page</strong><span class="classifier">dict</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="event_model.unpack_event_page">
<code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">unpack_event_page</code><span class="sig-paren">(</span><em class="sig-param">event_page</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#unpack_event_page"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.unpack_event_page" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform an EventPage document into individual Event documents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>event_page</strong><span class="classifier">dict</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>event</strong><span class="classifier">dict</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="event_model.pack_datum_page">
<code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">pack_datum_page</code><span class="sig-paren">(</span><em class="sig-param">*datum</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#pack_datum_page"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.pack_datum_page" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform one or more Datum documents into a DatumPage document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>*datum</strong><span class="classifier">dicts</span></dt><dd><p>any number of Datum documents</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>datum_page</strong><span class="classifier">dict</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="event_model.unpack_datum_page">
<code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">unpack_datum_page</code><span class="sig-paren">(</span><em class="sig-param">datum_page</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#unpack_datum_page"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.unpack_datum_page" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform a DatumPage document into individual Datum documents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>datum_page</strong><span class="classifier">dict</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>datum</strong><span class="classifier">dict</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="event_model.sanitize_doc">
<code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">sanitize_doc</code><span class="sig-paren">(</span><em class="sig-param">doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#sanitize_doc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.sanitize_doc" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy with any numpy objects converted to built-in Python types.</p>
<p>This function takes in an event-model document and returns a copy with any
numpy objects converted to built-in Python types. It is useful for
sanitizing documents prior to sending to any consumer that does not
recognize numpy types, such as a MongoDB database or a JSON encoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>doc</strong><span class="classifier">dict</span></dt><dd><p>The event-model document to be sanitized</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>sanitized_doc</strong><span class="classifier">event-model document</span></dt><dd><p>The event-model document with numpy objects converted to built-in
Python types.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="event_model.NumpyEncoder">
<em class="property">class </em><code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">NumpyEncoder</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">skipkeys=False</em>, <em class="sig-param">ensure_ascii=True</em>, <em class="sig-param">check_circular=True</em>, <em class="sig-param">allow_nan=True</em>, <em class="sig-param">sort_keys=False</em>, <em class="sig-param">indent=None</em>, <em class="sig-param">separators=None</em>, <em class="sig-param">default=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#NumpyEncoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.NumpyEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>A json.JSONEncoder for encoding numpy objects using built-in Python types.</p>
<p class="rubric">Examples</p>
<p>Encode a Python object that includes an arbitrarily-nested numpy object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])}},</span> <span class="bp">cls</span><span class="o">=</span><span class="n">NumpyEncoder</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="event_model.NumpyEncoder.default">
<code class="sig-name descname">default</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">obj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#NumpyEncoder.default"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.NumpyEncoder.default" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement this method in a subclass such that it returns
a serializable object for <code class="docutils literal notranslate"><span class="pre">o</span></code>, or calls the base implementation
(to raise a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>).</p>
<p>For example, to support arbitrary iterators, you could
implement default like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">iterable</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="c1"># Let the base class default method raise the TypeError</span>
    <span class="k">return</span> <span class="n">JSONEncoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="event_model.compose_run">
<code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">compose_run</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">uid=None</em>, <em class="sig-param">time=None</em>, <em class="sig-param">metadata=None</em>, <em class="sig-param">validate=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#compose_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.compose_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Compose a RunStart document and factory functions for related documents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>uid</strong><span class="classifier">string, optional</span></dt><dd><p>Unique identifier for this run, conventionally a UUID4. If None is
given, a UUID4 will be generated.</p>
</dd>
<dt><strong>time</strong><span class="classifier">float, optional</span></dt><dd><p>UNIX epoch time of start of this run. If None is given, the current
time will be used.</p>
</dd>
<dt><strong>metadata</strong><span class="classifier">dict, optional</span></dt><dd><p>Additional metadata include the document</p>
</dd>
<dt><strong>validate</strong><span class="classifier">boolean, optional</span></dt><dd><p>Validate this document conforms to the schema.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="event_model.compose_descriptor">
<code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">compose_descriptor</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">start</em>, <em class="sig-param">streams</em>, <em class="sig-param">event_counter</em>, <em class="sig-param">name</em>, <em class="sig-param">data_keys</em>, <em class="sig-param">uid=None</em>, <em class="sig-param">time=None</em>, <em class="sig-param">object_keys=None</em>, <em class="sig-param">configuration=None</em>, <em class="sig-param">hints=None</em>, <em class="sig-param">validate=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#compose_descriptor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.compose_descriptor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="event_model.compose_resource">
<code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">compose_resource</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">start</em>, <em class="sig-param">spec</em>, <em class="sig-param">root</em>, <em class="sig-param">resource_path</em>, <em class="sig-param">resource_kwargs</em>, <em class="sig-param">path_semantics='posix'</em>, <em class="sig-param">uid=None</em>, <em class="sig-param">validate=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#compose_resource"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.compose_resource" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="event_model.compose_datum">
<code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">compose_datum</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">resource</em>, <em class="sig-param">counter</em>, <em class="sig-param">datum_kwargs</em>, <em class="sig-param">validate=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#compose_datum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.compose_datum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="event_model.compose_datum_page">
<code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">compose_datum_page</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">resource</em>, <em class="sig-param">counter</em>, <em class="sig-param">datum_kwargs</em>, <em class="sig-param">validate=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#compose_datum_page"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.compose_datum_page" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="event_model.compose_event">
<code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">compose_event</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">descriptor</em>, <em class="sig-param">event_counter</em>, <em class="sig-param">data</em>, <em class="sig-param">timestamps</em>, <em class="sig-param">seq_num=None</em>, <em class="sig-param">filled=None</em>, <em class="sig-param">uid=None</em>, <em class="sig-param">time=None</em>, <em class="sig-param">validate=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#compose_event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.compose_event" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="event_model.compose_event_page">
<code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">compose_event_page</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">descriptor</em>, <em class="sig-param">event_counter</em>, <em class="sig-param">data</em>, <em class="sig-param">timestamps</em>, <em class="sig-param">seq_num</em>, <em class="sig-param">filled=None</em>, <em class="sig-param">uid=None</em>, <em class="sig-param">time=None</em>, <em class="sig-param">validate=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#compose_event_page"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.compose_event_page" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="event_model.compose_stop">
<code class="sig-prename descclassname">event_model.</code><code class="sig-name descname">compose_stop</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">start</em>, <em class="sig-param">event_counter</em>, <em class="sig-param">poison_pill</em>, <em class="sig-param">exit_status='success'</em>, <em class="sig-param">reason=''</em>, <em class="sig-param">uid=None</em>, <em class="sig-param">time=None</em>, <em class="sig-param">validate=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/event_model.html#compose_stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#event_model.compose_stop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="release-history.html" class="btn btn-neutral float-right" title="Release History" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="data-model.html" class="btn btn-neutral float-left" title="Data Model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Brookhaven National Lab

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>