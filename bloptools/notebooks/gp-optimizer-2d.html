<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Run the GP optimizer in two dimensions &mdash; bloptools 0.post106+g0bdc84d documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Run the GP optimizer in four dimensions" href="gp-optimizer-4d.html" />
    <link rel="prev" title="Notebooks" href="../notebooks.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            bloptools
          </a>
              <div class="version">
                0.post106+g0bdc84d
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks.html">Notebooks</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Run the GP optimizer in two dimensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="gp-optimizer-4d.html">Run the GP optimizer in four dimensions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release-history.html">Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../min_versions.html">Minimum Version of Python and NumPy</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">bloptools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../notebooks.html">Notebooks</a></li>
      <li class="breadcrumb-item active">Run the GP optimizer in two dimensions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/gp-optimizer-2d.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Run-the-GP-optimizer-in-two-dimensions">
<h1>Run the GP optimizer in two dimensions<a class="headerlink" href="#Run-the-GP-optimizer-in-two-dimensions" title="Permalink to this heading">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">run</span> -i ../../../examples/prepare_gp_optimizer.py

<span class="n">dofs</span> <span class="o">=</span> <span class="p">[</span><span class="n">kbv</span><span class="o">.</span><span class="n">x_rot</span><span class="p">,</span> <span class="n">kbv</span><span class="o">.</span><span class="n">offz</span><span class="p">]</span> <span class="c1"># two degrees of freedom of the vertical KB mirror</span>

<span class="n">hard_bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.10</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.10</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.50</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.50</span><span class="p">]])</span>

<span class="k">for</span> <span class="n">dof</span> <span class="ow">in</span> <span class="n">dofs</span><span class="p">:</span>
    <span class="n">dof</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;hinted&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gpo</span> <span class="o">=</span> <span class="n">Optimizer</span><span class="p">(</span>
    <span class="n">init_scheme</span><span class="o">=</span><span class="s1">&#39;quasi-random&#39;</span><span class="p">,</span>
    <span class="n">n_init</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">run_engine</span><span class="o">=</span><span class="n">RE</span><span class="p">,</span>
    <span class="n">db</span><span class="o">=</span><span class="n">db</span><span class="p">,</span>
    <span class="n">detector</span><span class="o">=</span><span class="n">w9</span><span class="p">,</span>
    <span class="n">detector_type</span><span class="o">=</span><span class="s1">&#39;image&#39;</span><span class="p">,</span>
    <span class="n">dofs</span><span class="o">=</span><span class="n">dofs</span><span class="p">,</span>
    <span class="n">dof_bounds</span><span class="o">=</span><span class="n">hard_bounds</span><span class="p">,</span>
    <span class="n">fitness_model</span><span class="o">=</span><span class="s1">&#39;max_sep_density&#39;</span><span class="p">,</span>
    <span class="n">training_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
learning with strategy &#34;quasi-random&#34; ...
   kbv_x_rot  kbv_offz    fitness
0  -0.045632  0.236417  11.292087
1   0.054368 -0.208028  11.412985
2  -0.095632  0.125305  10.514909
3   0.004368  0.458639        NaN
</pre></div></div>
</div>
<p>We initialized the GP with the “quasi-random” strategy, as it doesn’t require any prior data. But now that we have some points to work with, we can start to call some more sophisticated learning strategies. Let’s try exploring the space (“explore”), and then try to aim for the best possible fitness (“exploit”).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gpo</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">n_iter</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_per_iter</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;explore&#39;</span><span class="p">,</span> <span class="n">greedy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reuse_hypers</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">gpo</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">n_iter</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_per_iter</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;exploit&#39;</span><span class="p">,</span> <span class="n">greedy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reuse_hypers</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
learning with strategy &#34;explore&#34; ...
   kbv_x_rot  kbv_offz    fitness
4   0.009946  0.179957  12.168275
5  -0.022362 -0.324428  12.172489
   kbv_x_rot  kbv_offz    fitness
6   0.077032  0.133327   9.687557
7  -0.061594 -0.068229  11.104854
learning with strategy &#34;exploit&#34; ...
   kbv_x_rot  kbv_offz    fitness
8   0.000765 -0.342308  12.470885
9   0.000226 -0.114375  12.605609
    kbv_x_rot  kbv_offz    fitness
10   0.001670 -0.101627  12.454233
11   0.002174 -0.229237  12.555688
</pre></div></div>
</div>
<p>We can plot the “state” of the GPs, which shows their posteriors about the whole parameter space:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gpo</span><span class="o">.</span><span class="n">plot_state</span><span class="p">(</span><span class="n">gridded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_gp-optimizer-2d_6_0.png" src="../_images/notebooks_gp-optimizer-2d_6_0.png" />
</div>
</div>
<p>We can also plot the cumulative maximum fitness over time:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gpo</span><span class="o">.</span><span class="n">plot_fitness</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_gp-optimizer-2d_8_0.png" src="../_images/notebooks_gp-optimizer-2d_8_0.png" />
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../notebooks.html" class="btn btn-neutral float-left" title="Notebooks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gp-optimizer-4d.html" class="btn btn-neutral float-right" title="Run the GP optimizer in four dimensions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Brookhaven National Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>