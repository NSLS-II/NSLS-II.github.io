

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Plans &mdash; bluesky 0.0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="bluesky 0.0.1 documentation" href="index.html"/>
        <link rel="next" title="bluesky.plans.count" href="bluesky.plans.count.html"/>
        <link rel="prev" title="Bluesky Data Collection Framework" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> bluesky
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Plans</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#standard-plans-ready-to-use">Standard Plans (ready to use)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.count.html">bluesky.plans.count</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.scan.html">bluesky.plans.scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.relative_scan.html">bluesky.plans.relative_scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.list_scan.html">bluesky.plans.list_scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.relative_list_scan.html">bluesky.plans.relative_list_scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.log_scan.html">bluesky.plans.log_scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.relative_log_scan.html">bluesky.plans.relative_log_scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.inner_product_scan.html">bluesky.plans.inner_product_scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.outer_product_scan.html">bluesky.plans.outer_product_scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.relative_inner_product_scan.html">bluesky.plans.relative_inner_product_scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.relative_outer_product_scan.html">bluesky.plans.relative_outer_product_scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.scan_nd.html">bluesky.plans.scan_nd</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.spiral.html">bluesky.plans.spiral</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.spiral_fermat.html">bluesky.plans.spiral_fermat</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.relative_spiral.html">bluesky.plans.relative_spiral</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.relative_spiral_fermat.html">bluesky.plans.relative_spiral_fermat</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.adaptive_scan.html">bluesky.plans.adaptive_scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.relative_adaptive_scan.html">bluesky.plans.relative_adaptive_scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.tweak.html">bluesky.plans.tweak</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.fly.html">bluesky.plans.fly</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#basic-usage">Basic Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stub-plans-ingredients-for-remixing">Stub Plans (ingredients for remixing)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.trigger_and_read.html">bluesky.plans.trigger_and_read</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.abs_set.html">bluesky.plans.abs_set</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.rel_set.html">bluesky.plans.rel_set</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.wait.html">bluesky.plans.wait</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.sleep.html">bluesky.plans.sleep</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.checkpoint.html">bluesky.plans.checkpoint</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.clear_checkpoint.html">bluesky.plans.clear_checkpoint</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.pause.html">bluesky.plans.pause</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.deferred_pause.html">bluesky.plans.deferred_pause</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.open_run.html">bluesky.plans.open_run</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.close_run.html">bluesky.plans.close_run</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.create.html">bluesky.plans.create</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.save.html">bluesky.plans.save</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.trigger.html">bluesky.plans.trigger</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.read.html">bluesky.plans.read</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.monitor.html">bluesky.plans.monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.unmonitor.html">bluesky.plans.unmonitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.kickoff.html">bluesky.plans.kickoff</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.collect.html">bluesky.plans.collect</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.configure.html">bluesky.plans.configure</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.stage.html">bluesky.plans.stage</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.unstage.html">bluesky.plans.unstage</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.subscribe.html">bluesky.plans.subscribe</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.unsubscribe.html">bluesky.plans.unsubscribe</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.wait_for.html">bluesky.plans.wait_for</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.null.html">bluesky.plans.null</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.one_1d_step.html">bluesky.plans.one_1d_step</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.one_nd_step.html">bluesky.plans.one_nd_step</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#combining-plans">Combining Plans</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plan-context-managers">Plan Context Managers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.baseline_context.html">bluesky.plans.baseline_context</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.monitor_context.html">bluesky.plans.monitor_context</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.subs_context.html">bluesky.plans.subs_context</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.run_context.html">bluesky.plans.run_context</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.event_context.html">bluesky.plans.event_context</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.stage_context.html">bluesky.plans.stage_context</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#plan-preprocessors">Plan Preprocessors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.finalize_wrapper.html">bluesky.plans.finalize_wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.subs_wrapper.html">bluesky.plans.subs_wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.inject_md_wrapper.html">bluesky.plans.inject_md_wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.run_wrapper.html">bluesky.plans.run_wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.monitor_during_wrapper.html">bluesky.plans.monitor_during_wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.fly_during_wrapper.html">bluesky.plans.fly_during_wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.baseline_wrapper.html">bluesky.plans.baseline_wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.relative_set_wrapper.html">bluesky.plans.relative_set_wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.reset_positions_wrapper.html">bluesky.plans.reset_positions_wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.lazily_stage_wrapper.html">bluesky.plans.lazily_stage_wrapper</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#plan-utilities">Plan Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#object-oriented-standard-plans">Object-Oriented Standard Plans</a><ul>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.Count.html">bluesky.plans.Count</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.Scan.html">bluesky.plans.Scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.RelativeScan.html">bluesky.plans.RelativeScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.ListScan.html">bluesky.plans.ListScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.RelativeListScan.html">bluesky.plans.RelativeListScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.LogScan.html">bluesky.plans.LogScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.RelativeLogScan.html">bluesky.plans.RelativeLogScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.InnerProductScan.html">bluesky.plans.InnerProductScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.OuterProductScan.html">bluesky.plans.OuterProductScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.RelativeInnerProductScan.html">bluesky.plans.RelativeInnerProductScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.RelativeOuterProductScan.html">bluesky.plans.RelativeOuterProductScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.ScanND.html">bluesky.plans.ScanND</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.SpiralScan.html">bluesky.plans.SpiralScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.SpiralFermatScan.html">bluesky.plans.SpiralFermatScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.RelativeSpiralScan.html">bluesky.plans.RelativeSpiralScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.RelativeSpiralFermatScan.html">bluesky.plans.RelativeSpiralFermatScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.AdaptiveScan.html">bluesky.plans.AdaptiveScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.RelativeAdaptiveScan.html">bluesky.plans.RelativeAdaptiveScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky.plans.Tweak.html">bluesky.plans.Tweak</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="callbacks.html">Live Feedback and Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="state-machine.html">Interruptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Recording Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="simple_api.html">(Optional) SPEC-like Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_changes.html">Release Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">bluesky</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Plans</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/plans.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="plans">
<h1>Plans<a class="headerlink" href="#plans" title="Permalink to this headline">¶</a></h1>
<p>An experimental procedure is represented as a sequence of granular
instructions. In bluesky, each instruction is called a <em>message</em> and a sequence
of instructions is called a <em>plan</em>.</p>
<p>The plans are organized like a burger menu. A variety of fully-assembled plans
are provided &#8212; just as you might order the All-American Burger or The Hog
Wild Burger. But you can also build your own plan by mixing the ingredients
to make something original.</p>
<p>(For developers: what we are calling a &#8220;plan&#8221; is not actually a special data
structure. It is typically a generator, but it can be any iterable or iterator
&#8212; a list, for example. The messages in a plan are <code class="docutils literal"><span class="pre">Msg</span></code> objects, a
namedtuple.)</p>
<div class="section" id="standard-plans-ready-to-use">
<h2>Standard Plans (ready to use)<a class="headerlink" href="#standard-plans-ready-to-use" title="Permalink to this headline">¶</a></h2>
<p>The names below are links. Click for details, and see below for examples.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.count.html#bluesky.plans.count" title="bluesky.plans.count"><code class="xref py py-obj docutils literal"><span class="pre">count</span></code></a></td>
<td>Take one or more readings from detectors.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.scan.html#bluesky.plans.scan" title="bluesky.plans.scan"><code class="xref py py-obj docutils literal"><span class="pre">scan</span></code></a></td>
<td>Scan over one variable in equally spaced steps.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.relative_scan.html#bluesky.plans.relative_scan" title="bluesky.plans.relative_scan"><code class="xref py py-obj docutils literal"><span class="pre">relative_scan</span></code></a></td>
<td>Scan over one variable in equally spaced steps relative to current positon.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.list_scan.html#bluesky.plans.list_scan" title="bluesky.plans.list_scan"><code class="xref py py-obj docutils literal"><span class="pre">list_scan</span></code></a></td>
<td>Scan over one variable in steps.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.relative_list_scan.html#bluesky.plans.relative_list_scan" title="bluesky.plans.relative_list_scan"><code class="xref py py-obj docutils literal"><span class="pre">relative_list_scan</span></code></a></td>
<td>Scan over one variable in steps relative to current position.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.log_scan.html#bluesky.plans.log_scan" title="bluesky.plans.log_scan"><code class="xref py py-obj docutils literal"><span class="pre">log_scan</span></code></a></td>
<td>Scan over one variable in log-spaced steps.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.relative_log_scan.html#bluesky.plans.relative_log_scan" title="bluesky.plans.relative_log_scan"><code class="xref py py-obj docutils literal"><span class="pre">relative_log_scan</span></code></a></td>
<td>Scan over one variable in log-spaced steps relative to current position.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.inner_product_scan.html#bluesky.plans.inner_product_scan" title="bluesky.plans.inner_product_scan"><code class="xref py py-obj docutils literal"><span class="pre">inner_product_scan</span></code></a></td>
<td>Scan over one multi-motor trajectory.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.outer_product_scan.html#bluesky.plans.outer_product_scan" title="bluesky.plans.outer_product_scan"><code class="xref py py-obj docutils literal"><span class="pre">outer_product_scan</span></code></a></td>
<td>Scan over a mesh; each motor is on an independent trajectory.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.relative_inner_product_scan.html#bluesky.plans.relative_inner_product_scan" title="bluesky.plans.relative_inner_product_scan"><code class="xref py py-obj docutils literal"><span class="pre">relative_inner_product_scan</span></code></a></td>
<td>Scan over one multi-motor trajectory relative to current position.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.relative_outer_product_scan.html#bluesky.plans.relative_outer_product_scan" title="bluesky.plans.relative_outer_product_scan"><code class="xref py py-obj docutils literal"><span class="pre">relative_outer_product_scan</span></code></a></td>
<td>Scan over a mesh relative to current position.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.scan_nd.html#bluesky.plans.scan_nd" title="bluesky.plans.scan_nd"><code class="xref py py-obj docutils literal"><span class="pre">scan_nd</span></code></a></td>
<td>Scan over an arbitrary N-dimensional trajectory.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.spiral.html#bluesky.plans.spiral" title="bluesky.plans.spiral"><code class="xref py py-obj docutils literal"><span class="pre">spiral</span></code></a></td>
<td>Spiral scan, centered around (x_start, y_start)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.spiral_fermat.html#bluesky.plans.spiral_fermat" title="bluesky.plans.spiral_fermat"><code class="xref py py-obj docutils literal"><span class="pre">spiral_fermat</span></code></a></td>
<td>Absolute fermat spiral scan, centered around (x_start, y_start)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.relative_spiral.html#bluesky.plans.relative_spiral" title="bluesky.plans.relative_spiral"><code class="xref py py-obj docutils literal"><span class="pre">relative_spiral</span></code></a></td>
<td>Relative spiral scan</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.relative_spiral_fermat.html#bluesky.plans.relative_spiral_fermat" title="bluesky.plans.relative_spiral_fermat"><code class="xref py py-obj docutils literal"><span class="pre">relative_spiral_fermat</span></code></a></td>
<td>Relative fermat spiral scan</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.adaptive_scan.html#bluesky.plans.adaptive_scan" title="bluesky.plans.adaptive_scan"><code class="xref py py-obj docutils literal"><span class="pre">adaptive_scan</span></code></a></td>
<td>Scan over one variable with adaptively tuned step size.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.relative_adaptive_scan.html#bluesky.plans.relative_adaptive_scan" title="bluesky.plans.relative_adaptive_scan"><code class="xref py py-obj docutils literal"><span class="pre">relative_adaptive_scan</span></code></a></td>
<td>Relative scan over one variable with adaptively tuned step size.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.tweak.html#bluesky.plans.tweak" title="bluesky.plans.tweak"><code class="xref py py-obj docutils literal"><span class="pre">tweak</span></code></a></td>
<td>Move and motor and read a detector with an interactive prompt.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.fly.html#bluesky.plans.fly" title="bluesky.plans.fly"><code class="xref py py-obj docutils literal"><span class="pre">fly</span></code></a></td>
<td>Perform a fly scan with one or more &#8216;flyers&#8217;.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="basic-usage">
<h2>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h2>
<p>Before we begin, we&#8217;ll make a RunEngine to execute our plans.</p>
<p><strong>This RunEngine is not set up to save any data.</strong> You may already have a
RunEngine instance, <code class="docutils literal"><span class="pre">RE</span></code>, defined in an IPython profile. If <code class="docutils literal"><span class="pre">RE</span></code> is already
defined, do not redefine it. Just skip to the next step.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">bluesky</span> <span class="kn">import</span> <span class="n">RunEngine</span>

<span class="gp">In [2]: </span><span class="n">RE</span> <span class="o">=</span> <span class="n">RunEngine</span><span class="p">({})</span>
</pre></div>
</div>
<p>Execute the a <code class="docutils literal"><span class="pre">count</span></code> plan, which reads one or more detectors.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="kn">from</span> <span class="nn">bluesky.plans</span> <span class="kn">import</span> <span class="n">count</span>

<span class="gp">In [4]: </span><span class="kn">from</span> <span class="nn">bluesky.examples</span> <span class="kn">import</span> <span class="n">det</span>  <span class="c1"># a simulated detector</span>

<span class="gp">In [5]: </span><span class="n">RE</span><span class="p">(</span><span class="n">count</span><span class="p">([</span><span class="n">det</span><span class="p">]))</span>
<span class="gh">Out[5]: </span><span class="go">[&#39;83f74546-6dd1-43fb-9e35-ed5b4c82e339&#39;]</span>
</pre></div>
</div>
<p>It worked, but the data was not displayed. This time, send the output
<code class="docutils literal"><span class="pre">LiveTable</span></code>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="kn">from</span> <span class="nn">bluesky.callbacks</span> <span class="kn">import</span> <span class="n">LiveTable</span>

<span class="gp">In [7]: </span><span class="n">RE</span><span class="p">(</span><span class="n">count</span><span class="p">([</span><span class="n">det</span><span class="p">]),</span> <span class="n">LiveTable</span><span class="p">([</span><span class="n">det</span><span class="p">]))</span>
<span class="go">+-----------+------------+------------+</span>
<span class="go">|   seq_num |       time |        det |</span>
<span class="go">+-----------+------------+------------+</span>
<span class="go">|         1 | 21:16:10.8 |      0.000 |</span>
<span class="go">+-----------+------------+------------+</span>
<span class="go">generator count [&#39;53e4fd&#39;] (scan num: 2)</span>
<span class="gh">Out[7]: </span><span class="go">[&#39;53e4fdd0-5234-4a35-b1dd-9ab19175cc24&#39;]</span>
</pre></div>
</div>
</div>
<div class="section" id="stub-plans-ingredients-for-remixing">
<h2>Stub Plans (ingredients for remixing)<a class="headerlink" href="#stub-plans-ingredients-for-remixing" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.trigger_and_read.html#bluesky.plans.trigger_and_read" title="bluesky.plans.trigger_and_read"><code class="xref py py-obj docutils literal"><span class="pre">trigger_and_read</span></code></a></td>
<td>Trigger and read a list of detectors and bundle readings into one Event.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.abs_set.html#bluesky.plans.abs_set" title="bluesky.plans.abs_set"><code class="xref py py-obj docutils literal"><span class="pre">abs_set</span></code></a></td>
<td>Set a value.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.rel_set.html#bluesky.plans.rel_set" title="bluesky.plans.rel_set"><code class="xref py py-obj docutils literal"><span class="pre">rel_set</span></code></a></td>
<td>Set a value relative to current value.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.wait.html#bluesky.plans.wait" title="bluesky.plans.wait"><code class="xref py py-obj docutils literal"><span class="pre">wait</span></code></a></td>
<td>Wait for all statuses in a group to report being finished.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.sleep.html#bluesky.plans.sleep" title="bluesky.plans.sleep"><code class="xref py py-obj docutils literal"><span class="pre">sleep</span></code></a></td>
<td>Tell the RunEngine to sleep, while asynchronously doing other processing.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.checkpoint.html#bluesky.plans.checkpoint" title="bluesky.plans.checkpoint"><code class="xref py py-obj docutils literal"><span class="pre">checkpoint</span></code></a></td>
<td>If interrupted, rewind to this point.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.clear_checkpoint.html#bluesky.plans.clear_checkpoint" title="bluesky.plans.clear_checkpoint"><code class="xref py py-obj docutils literal"><span class="pre">clear_checkpoint</span></code></a></td>
<td>Designate that it is not safe to resume.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.pause.html#bluesky.plans.pause" title="bluesky.plans.pause"><code class="xref py py-obj docutils literal"><span class="pre">pause</span></code></a></td>
<td>Pause and wait for the user to resume.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.deferred_pause.html#bluesky.plans.deferred_pause" title="bluesky.plans.deferred_pause"><code class="xref py py-obj docutils literal"><span class="pre">deferred_pause</span></code></a></td>
<td>Pause at the next checkpoint.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.open_run.html#bluesky.plans.open_run" title="bluesky.plans.open_run"><code class="xref py py-obj docutils literal"><span class="pre">open_run</span></code></a></td>
<td>Mark the beginning of a new &#8216;run&#8217;.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.close_run.html#bluesky.plans.close_run" title="bluesky.plans.close_run"><code class="xref py py-obj docutils literal"><span class="pre">close_run</span></code></a></td>
<td>Mark the end of the current &#8216;run&#8217;.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.create.html#bluesky.plans.create" title="bluesky.plans.create"><code class="xref py py-obj docutils literal"><span class="pre">create</span></code></a></td>
<td>Bundle future readings into a new Event document.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.save.html#bluesky.plans.save" title="bluesky.plans.save"><code class="xref py py-obj docutils literal"><span class="pre">save</span></code></a></td>
<td>Close a bundle of readings and emit a completed Event document.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.trigger.html#bluesky.plans.trigger" title="bluesky.plans.trigger"><code class="xref py py-obj docutils literal"><span class="pre">trigger</span></code></a></td>
<td>Trigger and acquisition.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.read.html#bluesky.plans.read" title="bluesky.plans.read"><code class="xref py py-obj docutils literal"><span class="pre">read</span></code></a></td>
<td>Take a reading and add it to the current bundle of readings.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.monitor.html#bluesky.plans.monitor" title="bluesky.plans.monitor"><code class="xref py py-obj docutils literal"><span class="pre">monitor</span></code></a></td>
<td>Asynchronously monitor for new values and emit Event documents.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.unmonitor.html#bluesky.plans.unmonitor" title="bluesky.plans.unmonitor"><code class="xref py py-obj docutils literal"><span class="pre">unmonitor</span></code></a></td>
<td>Stop monitoring.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.kickoff.html#bluesky.plans.kickoff" title="bluesky.plans.kickoff"><code class="xref py py-obj docutils literal"><span class="pre">kickoff</span></code></a></td>
<td>Kickoff a fly-scanning device.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.collect.html#bluesky.plans.collect" title="bluesky.plans.collect"><code class="xref py py-obj docutils literal"><span class="pre">collect</span></code></a></td>
<td>Collect data cached by a fly-scanning device and emit documents.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.configure.html#bluesky.plans.configure" title="bluesky.plans.configure"><code class="xref py py-obj docutils literal"><span class="pre">configure</span></code></a></td>
<td>Change Device configuration and emit an updated Event Descriptor document.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.stage.html#bluesky.plans.stage" title="bluesky.plans.stage"><code class="xref py py-obj docutils literal"><span class="pre">stage</span></code></a></td>
<td>&#8216;Stage&#8217; a device (i.e., prepare it for use, &#8216;arm&#8217; it).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.unstage.html#bluesky.plans.unstage" title="bluesky.plans.unstage"><code class="xref py py-obj docutils literal"><span class="pre">unstage</span></code></a></td>
<td>&#8216;Unstage&#8217; a device (i.e., put it in standby, &#8216;disarm&#8217; it).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.subscribe.html#bluesky.plans.subscribe" title="bluesky.plans.subscribe"><code class="xref py py-obj docutils literal"><span class="pre">subscribe</span></code></a></td>
<td>Subscribe the stream of emitted documents.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.unsubscribe.html#bluesky.plans.unsubscribe" title="bluesky.plans.unsubscribe"><code class="xref py py-obj docutils literal"><span class="pre">unsubscribe</span></code></a></td>
<td>Remove a subscription.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.wait_for.html#bluesky.plans.wait_for" title="bluesky.plans.wait_for"><code class="xref py py-obj docutils literal"><span class="pre">wait_for</span></code></a></td>
<td>Low-level: wait for a list of <code class="docutils literal"><span class="pre">asyncio.Future</span></code> objects to set (complete).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.null.html#bluesky.plans.null" title="bluesky.plans.null"><code class="xref py py-obj docutils literal"><span class="pre">null</span></code></a></td>
<td>Yield a no-op Message.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.one_1d_step.html#bluesky.plans.one_1d_step" title="bluesky.plans.one_1d_step"><code class="xref py py-obj docutils literal"><span class="pre">one_1d_step</span></code></a></td>
<td>Inner loop of a 1D step scan</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.one_nd_step.html#bluesky.plans.one_nd_step" title="bluesky.plans.one_nd_step"><code class="xref py py-obj docutils literal"><span class="pre">one_nd_step</span></code></a></td>
<td>Inner loop of an N-dimensional step scan</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="combining-plans">
<h2>Combining Plans<a class="headerlink" href="#combining-plans" title="Permalink to this headline">¶</a></h2>
<p>Plans are iterables (roughly speaking, lists) and the Python language has nice
facilities for handling them. For example to join to plans together, use</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bluesky.examples</span> <span class="kn">import</span> <span class="n">motor</span><span class="p">,</span> <span class="n">det</span>
<span class="kn">from</span> <span class="nn">bluesky.plans</span> <span class="kn">import</span> <span class="n">scan</span><span class="p">,</span> <span class="n">sleep</span><span class="p">,</span> <span class="n">pchain</span>

<span class="n">master_plan</span> <span class="o">=</span> <span class="n">pchain</span><span class="p">(</span><span class="n">scan</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">motor</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                     <span class="n">sleep</span><span class="p">(),</span>
                     <span class="n">scan</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">motor</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">RE</span><span class="p">(</span><span class="n">master_plan</span><span class="p">)</span>
</pre></div>
</div>
<p>This has advantages over executing them in sequence like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Don&#39;t do this.</span>
<span class="n">RE</span><span class="p">(</span><span class="n">plan1</span><span class="p">);</span> <span class="n">RE</span><span class="p">(</span><span class="n">plan2</span><span class="p">)</span>
</pre></div>
</div>
<p>If there are no interruptions or errors, these two methods are equivalent. But
in the event of a problem, the RunEngine can do more to recover if it
maintains control. In the second example, it loses control between completing
<code class="docutils literal"><span class="pre">plan1</span></code> and beginning <code class="docutils literal"><span class="pre">plan2</span></code>.</p>
<p>What if want to <code class="docutils literal"><span class="pre">print</span></code> or do other activities between executing the plans?
There is another way to combine plans to accomodate this.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_master_plan</span><span class="p">():</span>
    <span class="n">plan1</span> <span class="o">=</span> <span class="n">scan</span><span class="p">([</span><span class="n">det1</span><span class="p">,</span> <span class="n">det2</span><span class="p">],</span> <span class="n">motor</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">plan2</span> <span class="o">=</span> <span class="n">relative_scan</span><span class="p">([</span><span class="n">det1</span><span class="p">],</span> <span class="n">motor</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">yield from</span> <span class="n">plan1</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;plan1 is finished -- moving onto plan2&#39;</span><span class="p">)</span>
    <span class="k">yield from</span> <span class="n">plan2</span>

<span class="n">RE</span><span class="p">(</span><span class="n">make_master_plan</span><span class="p">())</span>  <span class="c1"># note the ()</span>
</pre></div>
</div>
<p>Arbitrary Python code can go inside <code class="docutils literal"><span class="pre">master_plan</span></code>. It could employ <code class="docutils literal"><span class="pre">if</span></code>
blocks, <code class="docutils literal"><span class="pre">for</span></code> loops &#8211; anything except a <code class="docutils literal"><span class="pre">return</span></code> statement. If you want to
know more about what is happening here, structures like this in Python are
called <em>generators</em>.</p>
<p>Here are a couple more useful recipes:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="s2">&quot;Run plan1, wait for user confirmation, then run plan2.&quot;</span>

<span class="k">def</span> <span class="nf">make_master_plan</span><span class="p">():</span>
    <span class="n">plan1</span> <span class="o">=</span> <span class="n">scan</span><span class="p">([</span><span class="n">det1</span><span class="p">,</span> <span class="n">det2</span><span class="p">],</span> <span class="n">motor</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">plan2</span> <span class="o">=</span> <span class="n">relative_scan</span><span class="p">([</span><span class="n">det1</span><span class="p">],</span> <span class="n">motor</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">yield from</span> <span class="n">plan1</span>
    <span class="c1"># pause and consult the user</span>
    <span class="k">if</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;continue? (y/n)&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">StopIteration</span>
    <span class="k">yield from</span> <span class="n">plan2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="s2">&quot;Run a plan several times, changing the step size each time.&quot;</span>

<span class="k">def</span> <span class="nf">make_master_plan</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="c1"># Change the number of steps in the plan in each loop</span>
        <span class="n">plan1</span> <span class="o">=</span> <span class="n">scan</span><span class="p">([</span><span class="n">det1</span><span class="p">,</span> <span class="n">det2</span><span class="p">],</span> <span class="n">motor</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
        <span class="k">yield from</span> <span class="n">plan1</span>
</pre></div>
</div>
</div>
<div class="section" id="plan-context-managers">
<h2>Plan Context Managers<a class="headerlink" href="#plan-context-managers" title="Permalink to this headline">¶</a></h2>
<p>These context managers provide a sunninct, readable syntax for inserting plans
before and after other plans.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.baseline_context.html#bluesky.plans.baseline_context" title="bluesky.plans.baseline_context"><code class="xref py py-obj docutils literal"><span class="pre">baseline_context</span></code></a></td>
<td>Read every device once upon entering and exiting the context.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.monitor_context.html#bluesky.plans.monitor_context" title="bluesky.plans.monitor_context"><code class="xref py py-obj docutils literal"><span class="pre">monitor_context</span></code></a></td>
<td>Asynchronously monitor signals, generating separate event streams.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.subs_context.html#bluesky.plans.subs_context" title="bluesky.plans.subs_context"><code class="xref py py-obj docutils literal"><span class="pre">subs_context</span></code></a></td>
<td>Subscribe callbacks to the document stream; then unsubscribe on exit.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.run_context.html#bluesky.plans.run_context" title="bluesky.plans.run_context"><code class="xref py py-obj docutils literal"><span class="pre">run_context</span></code></a></td>
<td>Enclose in &#8216;open_run&#8217; and &#8216;close_run&#8217; messages.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.event_context.html#bluesky.plans.event_context" title="bluesky.plans.event_context"><code class="xref py py-obj docutils literal"><span class="pre">event_context</span></code></a></td>
<td>Bundle readings into an &#8216;event&#8217; (a datapoint).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.stage_context.html#bluesky.plans.stage_context" title="bluesky.plans.stage_context"><code class="xref py py-obj docutils literal"><span class="pre">stage_context</span></code></a></td>
<td>Stage devices upon entering context and unstage upon exiting.</td>
</tr>
</tbody>
</table>
<p>For example, the <code class="docutils literal"><span class="pre">baseline_context</span></code> reads a list of detectors at the
beginning and end of an experiment.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bluesky.plans</span> <span class="kn">import</span> <span class="n">baseline_context</span><span class="p">,</span> <span class="n">count</span>
<span class="kn">from</span> <span class="nn">bluesky.examples</span> <span class="kn">import</span> <span class="n">det</span>

<span class="n">plans</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="n">baseline_context</span><span class="p">(</span><span class="n">plans</span><span class="p">,</span> <span class="p">[</span><span class="n">det</span><span class="p">]):</span>
    <span class="n">plans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">count</span><span class="p">([</span><span class="n">det</span><span class="p">]))</span>
</pre></div>
</div>
<p>Use with the <code class="docutils literal"><span class="pre">planify</span></code> decorator to join the list of plans into one plan.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bluesky.plans</span> <span class="kn">import</span> <span class="n">planify</span>

<span class="nd">@planify</span>
<span class="k">def</span> <span class="nf">count_with_baseline_readings</span><span class="p">():</span>
    <span class="n">plans</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="n">baseline_context</span><span class="p">(</span><span class="n">plans</span><span class="p">,</span> <span class="p">[</span><span class="n">det</span><span class="p">]):</span>
        <span class="n">plans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">count</span><span class="p">([</span><span class="n">det</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">plans</span>
</pre></div>
</div>
</div>
<div class="section" id="plan-preprocessors">
<h2>Plan Preprocessors<a class="headerlink" href="#plan-preprocessors" title="Permalink to this headline">¶</a></h2>
<p>These &#8220;preprocessors&#8221; take in a plan and modify its contents on the fly.
For example, <code class="docutils literal"><span class="pre">relative_set</span></code> rewrites all positions to be relative to the
initial position.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.finalize_wrapper.html#bluesky.plans.finalize_wrapper" title="bluesky.plans.finalize_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">finalize_wrapper</span></code></a></td>
<td>try...finally helper</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.subs_wrapper.html#bluesky.plans.subs_wrapper" title="bluesky.plans.subs_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">subs_wrapper</span></code></a></td>
<td>Subscribe callbacks to the document stream; finally, unsubscribe.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.inject_md_wrapper.html#bluesky.plans.inject_md_wrapper" title="bluesky.plans.inject_md_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">inject_md_wrapper</span></code></a></td>
<td>Inject additional metadata into a run.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.run_wrapper.html#bluesky.plans.run_wrapper" title="bluesky.plans.run_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">run_wrapper</span></code></a></td>
<td>Enclose in &#8216;open_run&#8217; and &#8216;close_run&#8217; messages.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.monitor_during_wrapper.html#bluesky.plans.monitor_during_wrapper" title="bluesky.plans.monitor_during_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">monitor_during_wrapper</span></code></a></td>
<td>Monitor (asynchronously read) devices during runs.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.fly_during_wrapper.html#bluesky.plans.fly_during_wrapper" title="bluesky.plans.fly_during_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">fly_during_wrapper</span></code></a></td>
<td>Kickoff and collect &#8220;flyer&#8221; (asynchronously collect) objects during runs.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.baseline_wrapper.html#bluesky.plans.baseline_wrapper" title="bluesky.plans.baseline_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">baseline_wrapper</span></code></a></td>
<td>Preprocessor that records a baseline of all <cite>devices</cite> after <cite>open_run</cite></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.relative_set_wrapper.html#bluesky.plans.relative_set_wrapper" title="bluesky.plans.relative_set_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">relative_set_wrapper</span></code></a></td>
<td>Interpret &#8216;set&#8217; messages on devices as relative to initial position.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.reset_positions_wrapper.html#bluesky.plans.reset_positions_wrapper" title="bluesky.plans.reset_positions_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">reset_positions_wrapper</span></code></a></td>
<td>Return movable devices to their initial positions at the end.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.lazily_stage_wrapper.html#bluesky.plans.lazily_stage_wrapper" title="bluesky.plans.lazily_stage_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">lazily_stage_wrapper</span></code></a></td>
<td>This is a preprocessor that inserts &#8216;stage&#8217; messages and appends &#8216;unstage&#8217;.</td>
</tr>
</tbody>
</table>
<p>These wrappers operate on a generator <em>instance</em>. There are corresponding
functions that operate on a generator <em>function</em>. They are named
<code class="docutils literal"><span class="pre">*_decorator</span></code>, corresponding to each <code class="docutils literal"><span class="pre">*_wrapper</span></code> above.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">relative_scan</span><span class="p">(</span><span class="n">detectors</span><span class="p">,</span> <span class="n">motor</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
    <span class="n">absolute</span> <span class="o">=</span> <span class="n">scan</span><span class="p">(</span><span class="n">detectors</span><span class="p">,</span> <span class="n">motor</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
    <span class="n">relative</span> <span class="o">=</span> <span class="n">relative_set</span><span class="p">(</span><span class="n">absolute</span><span class="p">,</span> <span class="p">[</span><span class="n">motor</span><span class="p">])</span>
    <span class="k">yield from</span> <span class="n">relative</span>
</pre></div>
</div>
<p>Or, equivalently, using the <code class="docutils literal"><span class="pre">planify</span></code> decorator:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@planify</span>
<span class="k">def</span> <span class="nf">relative_scan</span><span class="p">(</span><span class="n">detectors</span><span class="p">,</span> <span class="n">motor</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
    <span class="n">absolute</span> <span class="o">=</span> <span class="n">scan</span><span class="p">(</span><span class="n">detectors</span><span class="p">,</span> <span class="n">motor</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
    <span class="n">relative</span> <span class="o">=</span> <span class="n">relative_set</span><span class="p">(</span><span class="n">absolute</span><span class="p">,</span> <span class="p">[</span><span class="n">motor</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">relative</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="plan-utilities">
<h2>Plan Utilities<a class="headerlink" href="#plan-utilities" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">pchain</span></code>(*args)</td>
<td>Like <cite>itertools.chain</cite> but using <cite>yield from</cite></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">msg_mutator</span></code>(plan,&nbsp;msg_proc)</td>
<td>A simple preprocessor that mutates or deletes single messages in a plan</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">plan_mutator</span></code>(plan,&nbsp;msg_proc)</td>
<td>Alter the contents of a plan on the fly by changing or inserting messages.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">single_gen</span></code>(msg)</td>
<td>Turn a single message into a plan</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">planify</span></code>(func)</td>
<td>Turn a function that returns a list of generators into a coroutine.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">broadcast_msg</span></code>(command,&nbsp;objs,&nbsp;*args,&nbsp;**kwargs)</td>
<td>Generate many copies of a mesasge, applying it to a list of devices.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">repeater</span></code>(n,&nbsp;gen_func,&nbsp;*args,&nbsp;**kwargs)</td>
<td>Generate n chained copies of the messages from gen_func</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">caching_repeater</span></code>(n,&nbsp;plan)</td>
<td>Generate n chained copies of the messages in a plan.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">make_decorator</span></code>(wrapper)</td>
<td>The functions named <a href="#id1"><span class="problematic" id="id2">*</span></a>_wrapper accept a generator instance and return a mutated generator instance.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="object-oriented-standard-plans">
<h2>Object-Oriented Standard Plans<a class="headerlink" href="#object-oriented-standard-plans" title="Permalink to this headline">¶</a></h2>
<p>These provide a different way of using the standard plans. The plan becomes
a reusable object, whose parameters can be adjusted interactively between
uses.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="kn">from</span> <span class="nn">bluesky.plans</span> <span class="kn">import</span> <span class="n">Scan</span>

<span class="gp">In [9]: </span><span class="kn">from</span> <span class="nn">bluesky.examples</span> <span class="kn">import</span> <span class="n">motor</span><span class="p">,</span> <span class="n">det</span><span class="p">,</span> <span class="n">det3</span>

<span class="gp">In [10]: </span><span class="n">plan</span> <span class="o">=</span> <span class="n">Scan</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">motor</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="gp">In [11]: </span><span class="n">RE</span><span class="p">(</span><span class="n">plan</span><span class="p">)</span>
<span class="go">+-----------+------------+------------+------------+------------+</span>
<span class="go">|   seq_num |       time |       det1 |       det2 |       det3 |</span>
<span class="go">+-----------+------------+------------+------------+------------+</span>
<span class="go">|         1 | 21:16:11.1 |            |            |            |</span>
<span class="go">|         2 | 21:16:11.1 |            |            |            |</span>
<span class="go">|         3 | 21:16:11.1 |            |            |            |</span>
<span class="go">|         4 | 21:16:11.1 |            |            |            |</span>
<span class="go">|         5 | 21:16:11.1 |            |            |            |</span>
<span class="go">|         6 | 21:16:11.1 |            |            |            |</span>
<span class="go">|         7 | 21:16:11.1 |            |            |            |</span>
<span class="go">|         8 | 21:16:11.2 |            |            |            |</span>
<span class="go">|         9 | 21:16:11.2 |            |            |            |</span>
<span class="go">|        10 | 21:16:11.2 |            |            |            |</span>
<span class="go">+-----------+------------+------------+------------+------------+</span>
<span class="go">Scan scan [&#39;b3ff5a&#39;] (scan num: 3)</span>
<span class="gh">Out[11]: </span><span class="go">[&#39;b3ff5a96-0e27-4aea-b6f0-9018897911f2&#39;]</span>

<span class="gp">In [12]: </span><span class="n">RE</span><span class="p">(</span><span class="n">plan</span><span class="p">)</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +-----------+------------+------------+------------+------------+</span>
<span class="go">|   seq_num |       time |       det1 |       det2 |       det3 |</span>
<span class="go">+-----------+------------+------------+------------+------------+</span>
<span class="go">|         1 | 21:16:11.3 |            |            |            |</span>
<span class="go">|         2 | 21:16:11.3 |            |            |            |</span>
<span class="go">|         3 | 21:16:11.3 |            |            |            |</span>
<span class="go">|         4 | 21:16:11.4 |            |            |            |</span>
<span class="go">|         5 | 21:16:11.4 |            |            |            |</span>
<span class="go">|         6 | 21:16:11.4 |            |            |            |</span>
<span class="go">|         7 | 21:16:11.4 |            |            |            |</span>
<span class="go">|         8 | 21:16:11.4 |            |            |            |</span>
<span class="go">|         9 | 21:16:11.4 |            |            |            |</span>
<span class="go">|        10 | 21:16:11.4 |            |            |            |</span>
<span class="go">+-----------+------------+------------+------------+------------+</span>
<span class="go">Scan scan [&#39;969057&#39;] (scan num: 4)</span>
<span class="gh">Out[12]: </span><span class="go">[&#39;969057b8-2213-4366-9054-fd73f3c0679f&#39;]</span>
</pre></div>
</div>
<p>Any of the plan&#8217;s parameters can be updated individually.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [13]: </span><span class="n">plan</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># change number of data points from 10 to 4</span>

<span class="gp">In [14]: </span><span class="n">RE</span><span class="p">(</span><span class="n">plan</span><span class="p">)</span>
<span class="go">+-----------+------------+------------+------------+------------+</span>
<span class="go">|   seq_num |       time |       det1 |       det2 |       det3 |</span>
<span class="go">+-----------+------------+------------+------------+------------+</span>
<span class="go">|         1 | 21:16:11.6 |            |            |            |</span>
<span class="go">|         2 | 21:16:11.6 |            |            |            |</span>
<span class="go">|         3 | 21:16:11.6 |            |            |            |</span>
<span class="go">|         4 | 21:16:11.6 |            |            |            |</span>
<span class="go">+-----------+------------+------------+------------+------------+</span>
<span class="go">Scan scan [&#39;ef7341&#39;] (scan num: 5)</span>
<span class="gh">Out[14]: </span><span class="go">[&#39;ef734129-f982-41fc-a7e7-d8abd6cd66a7&#39;]</span>

<span class="gp">In [15]: </span><span class="n">plan</span><span class="o">.</span><span class="n">detectors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">det3</span><span class="p">)</span>  <span class="c1"># add another detector</span>

<span class="gp">In [16]: </span><span class="n">RE</span><span class="p">(</span><span class="n">plan</span><span class="p">)</span>
<span class="go">+-----------+------------+------------+------------+------------+</span>
<span class="go">|   seq_num |       time |       det1 |       det2 |       det3 |</span>
<span class="go">+-----------+------------+------------+------------+------------+</span>
<span class="go">|         1 | 21:16:11.8 |            |            |      1.213 |</span>
<span class="go">|         2 | 21:16:11.8 |            |            |      1.213 |</span>
<span class="go">|         3 | 21:16:11.8 |            |            |      1.213 |</span>
<span class="go">|         4 | 21:16:11.8 |            |            |      1.213 |</span>
<span class="go">+-----------+------------+------------+------------+------------+</span>
<span class="go">Scan scan [&#39;93e72a&#39;] (scan num: 6)</span>
<span class="gh">Out[16]: </span><span class="go">[&#39;93e72a17-6848-4456-8d87-e9b4d8db7f8b&#39;]</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">set</span></code> method is a convenient way to update multiple parameters at once.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="n">plan</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
</pre></div>
</div>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.Count.html#bluesky.plans.Count" title="bluesky.plans.Count"><code class="xref py py-obj docutils literal"><span class="pre">Count</span></code></a></td>
<td>Take one or more readings from detectors.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.Scan.html#bluesky.plans.Scan" title="bluesky.plans.Scan"><code class="xref py py-obj docutils literal"><span class="pre">Scan</span></code></a></td>
<td>Scan over one variable in equally spaced steps.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.RelativeScan.html#bluesky.plans.RelativeScan" title="bluesky.plans.RelativeScan"><code class="xref py py-obj docutils literal"><span class="pre">RelativeScan</span></code></a></td>
<td>Scan over one variable in equally spaced steps relative to current positon.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.ListScan.html#bluesky.plans.ListScan" title="bluesky.plans.ListScan"><code class="xref py py-obj docutils literal"><span class="pre">ListScan</span></code></a></td>
<td>Scan over one variable in steps.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.RelativeListScan.html#bluesky.plans.RelativeListScan" title="bluesky.plans.RelativeListScan"><code class="xref py py-obj docutils literal"><span class="pre">RelativeListScan</span></code></a></td>
<td>Scan over one variable in steps relative to current position.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.LogScan.html#bluesky.plans.LogScan" title="bluesky.plans.LogScan"><code class="xref py py-obj docutils literal"><span class="pre">LogScan</span></code></a></td>
<td>Scan over one variable in log-spaced steps.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.RelativeLogScan.html#bluesky.plans.RelativeLogScan" title="bluesky.plans.RelativeLogScan"><code class="xref py py-obj docutils literal"><span class="pre">RelativeLogScan</span></code></a></td>
<td>Scan over one variable in log-spaced steps relative to current position.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.InnerProductScan.html#bluesky.plans.InnerProductScan" title="bluesky.plans.InnerProductScan"><code class="xref py py-obj docutils literal"><span class="pre">InnerProductScan</span></code></a></td>
<td>Scan over one multi-motor trajectory.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.OuterProductScan.html#bluesky.plans.OuterProductScan" title="bluesky.plans.OuterProductScan"><code class="xref py py-obj docutils literal"><span class="pre">OuterProductScan</span></code></a></td>
<td>Scan over a mesh; each motor is on an independent trajectory.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.RelativeInnerProductScan.html#bluesky.plans.RelativeInnerProductScan" title="bluesky.plans.RelativeInnerProductScan"><code class="xref py py-obj docutils literal"><span class="pre">RelativeInnerProductScan</span></code></a></td>
<td>Scan over one multi-motor trajectory relative to current position.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.RelativeOuterProductScan.html#bluesky.plans.RelativeOuterProductScan" title="bluesky.plans.RelativeOuterProductScan"><code class="xref py py-obj docutils literal"><span class="pre">RelativeOuterProductScan</span></code></a></td>
<td>Scan over a mesh relative to current position.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.ScanND.html#bluesky.plans.ScanND" title="bluesky.plans.ScanND"><code class="xref py py-obj docutils literal"><span class="pre">ScanND</span></code></a></td>
<td>Scan over an arbitrary N-dimensional trajectory.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.SpiralScan.html#bluesky.plans.SpiralScan" title="bluesky.plans.SpiralScan"><code class="xref py py-obj docutils literal"><span class="pre">SpiralScan</span></code></a></td>
<td>Spiral scan, centered around (x_start, y_start)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.SpiralFermatScan.html#bluesky.plans.SpiralFermatScan" title="bluesky.plans.SpiralFermatScan"><code class="xref py py-obj docutils literal"><span class="pre">SpiralFermatScan</span></code></a></td>
<td>Absolute fermat spiral scan, centered around (x_start, y_start)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.RelativeSpiralScan.html#bluesky.plans.RelativeSpiralScan" title="bluesky.plans.RelativeSpiralScan"><code class="xref py py-obj docutils literal"><span class="pre">RelativeSpiralScan</span></code></a></td>
<td>Relative spiral scan</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.RelativeSpiralFermatScan.html#bluesky.plans.RelativeSpiralFermatScan" title="bluesky.plans.RelativeSpiralFermatScan"><code class="xref py py-obj docutils literal"><span class="pre">RelativeSpiralFermatScan</span></code></a></td>
<td>Relative fermat spiral scan</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.AdaptiveScan.html#bluesky.plans.AdaptiveScan" title="bluesky.plans.AdaptiveScan"><code class="xref py py-obj docutils literal"><span class="pre">AdaptiveScan</span></code></a></td>
<td>Scan over one variable with adaptively tuned step size.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="bluesky.plans.RelativeAdaptiveScan.html#bluesky.plans.RelativeAdaptiveScan" title="bluesky.plans.RelativeAdaptiveScan"><code class="xref py py-obj docutils literal"><span class="pre">RelativeAdaptiveScan</span></code></a></td>
<td>Relative scan over one variable with adaptively tuned step size.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="bluesky.plans.Tweak.html#bluesky.plans.Tweak" title="bluesky.plans.Tweak"><code class="xref py py-obj docutils literal"><span class="pre">Tweak</span></code></a></td>
<td>Move and motor and read a detector with an interactive prompt.</td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="bluesky.plans.count.html" class="btn btn-neutral float-right" title="bluesky.plans.count" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Bluesky Data Collection Framework" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Brookhaven National Lab.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>