

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Plans &mdash; bluesky 1.6.0rc1.post52+gfb290d4 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'1.6.0rc1.post52+gfb290d4',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="bluesky.plans.count" href="generated/bluesky.plans.count.html" />
    <link rel="prev" title="Tutorial" href="tutorial.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> bluesky
          

          
          </a>

          
            
            
              <div class="version">
                1.6.0rc1.post52+gfb290d4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Plans</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pre-assembled-plans">Pre-assembled Plans</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#summary">Summary</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.count.html">bluesky.plans.count</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.scan.html">bluesky.plans.scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_scan.html">bluesky.plans.rel_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.list_scan.html">bluesky.plans.list_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_list_scan.html">bluesky.plans.rel_list_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.list_grid_scan.html">bluesky.plans.list_grid_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_list_grid_scan.html">bluesky.plans.rel_list_grid_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.log_scan.html">bluesky.plans.log_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_log_scan.html">bluesky.plans.rel_log_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.grid_scan.html">bluesky.plans.grid_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_grid_scan.html">bluesky.plans.rel_grid_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.scan_nd.html">bluesky.plans.scan_nd</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.spiral.html">bluesky.plans.spiral</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.spiral_fermat.html">bluesky.plans.spiral_fermat</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.spiral_square.html">bluesky.plans.spiral_square</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_spiral.html">bluesky.plans.rel_spiral</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_spiral_fermat.html">bluesky.plans.rel_spiral_fermat</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_spiral_square.html">bluesky.plans.rel_spiral_square</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.adaptive_scan.html">bluesky.plans.adaptive_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_adaptive_scan.html">bluesky.plans.rel_adaptive_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.tune_centroid.html">bluesky.plans.tune_centroid</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.tweak.html">bluesky.plans.tweak</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.ramp_plan.html">bluesky.plans.ramp_plan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.fly.html">bluesky.plans.fly</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#time-series-count">Time series (“count”)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.count.html">bluesky.plans.count</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#scans-over-one-dimension">Scans over one dimension</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.scan.html">bluesky.plans.scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_scan.html">bluesky.plans.rel_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.list_scan.html">bluesky.plans.list_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_list_scan.html">bluesky.plans.rel_list_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.log_scan.html">bluesky.plans.log_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_log_scan.html">bluesky.plans.rel_log_scan</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#multi-dimensional-scans">Multi-dimensional scans</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.scan.html">bluesky.plans.scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_scan.html">bluesky.plans.rel_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.grid_scan.html">bluesky.plans.grid_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_grid_scan.html">bluesky.plans.rel_grid_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.list_scan.html">bluesky.plans.list_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_list_scan.html">bluesky.plans.rel_list_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.list_grid_scan.html">bluesky.plans.list_grid_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_list_grid_scan.html">bluesky.plans.rel_list_grid_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.scan_nd.html">bluesky.plans.scan_nd</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#spiral-trajectories">Spiral trajectories</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.spiral.html">bluesky.plans.spiral</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.spiral_fermat.html">bluesky.plans.spiral_fermat</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.spiral_square.html">bluesky.plans.spiral_square</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_spiral.html">bluesky.plans.rel_spiral</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_spiral_fermat.html">bluesky.plans.rel_spiral_fermat</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_spiral_square.html">bluesky.plans.rel_spiral_square</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#adaptive-scans">Adaptive scans</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.adaptive_scan.html">bluesky.plans.adaptive_scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.rel_adaptive_scan.html">bluesky.plans.rel_adaptive_scan</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#misc">Misc.</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.tweak.html">bluesky.plans.tweak</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.plans.fly.html">bluesky.plans.fly</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#stub-plans">Stub Plans</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.abs_set.html">bluesky.plan_stubs.abs_set</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.rel_set.html">bluesky.plan_stubs.rel_set</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.mv.html">bluesky.plan_stubs.mv</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.mvr.html">bluesky.plan_stubs.mvr</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.trigger.html">bluesky.plan_stubs.trigger</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.read.html">bluesky.plan_stubs.read</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.stage.html">bluesky.plan_stubs.stage</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.unstage.html">bluesky.plan_stubs.unstage</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.configure.html">bluesky.plan_stubs.configure</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.stop.html">bluesky.plan_stubs.stop</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.monitor.html">bluesky.plan_stubs.monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.unmonitor.html">bluesky.plan_stubs.unmonitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.kickoff.html">bluesky.plan_stubs.kickoff</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.complete.html">bluesky.plan_stubs.complete</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.collect.html">bluesky.plan_stubs.collect</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.open_run.html">bluesky.plan_stubs.open_run</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.close_run.html">bluesky.plan_stubs.close_run</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.create.html">bluesky.plan_stubs.create</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.save.html">bluesky.plan_stubs.save</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.drop.html">bluesky.plan_stubs.drop</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.pause.html">bluesky.plan_stubs.pause</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.deferred_pause.html">bluesky.plan_stubs.deferred_pause</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.checkpoint.html">bluesky.plan_stubs.checkpoint</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.clear_checkpoint.html">bluesky.plan_stubs.clear_checkpoint</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.sleep.html">bluesky.plan_stubs.sleep</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.input_plan.html">bluesky.plan_stubs.input_plan</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.subscribe.html">bluesky.plan_stubs.subscribe</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.unsubscribe.html">bluesky.plan_stubs.unsubscribe</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.install_suspender.html">bluesky.plan_stubs.install_suspender</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.remove_suspender.html">bluesky.plan_stubs.remove_suspender</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.wait.html">bluesky.plan_stubs.wait</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.wait_for.html">bluesky.plan_stubs.wait_for</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.null.html">bluesky.plan_stubs.null</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#plan-preprocessors">Plan Preprocessors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#supplemental-data">Supplemental Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#preprocessor-wrappers-and-decorators">Preprocessor Wrappers and Decorators</a></li>
<li class="toctree-l3"><a class="reference internal" href="#built-in-preprocessors">Built-in Preprocessors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.baseline_decorator.html">bluesky.preprocessors.baseline_decorator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.baseline_wrapper.html">bluesky.preprocessors.baseline_wrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.finalize_decorator.html">bluesky.preprocessors.finalize_decorator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.finalize_wrapper.html">bluesky.preprocessors.finalize_wrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.fly_during_decorator.html">bluesky.preprocessors.fly_during_decorator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.fly_during_wrapper.html">bluesky.preprocessors.fly_during_wrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.inject_md_decorator.html">bluesky.preprocessors.inject_md_decorator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.inject_md_wrapper.html">bluesky.preprocessors.inject_md_wrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.lazily_stage_decorator.html">bluesky.preprocessors.lazily_stage_decorator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.lazily_stage_wrapper.html">bluesky.preprocessors.lazily_stage_wrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.monitor_during_decorator.html">bluesky.preprocessors.monitor_during_decorator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.monitor_during_wrapper.html">bluesky.preprocessors.monitor_during_wrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.relative_set_decorator.html">bluesky.preprocessors.relative_set_decorator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.relative_set_wrapper.html">bluesky.preprocessors.relative_set_wrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.reset_positions_decorator.html">bluesky.preprocessors.reset_positions_decorator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.reset_positions_wrapper.html">bluesky.preprocessors.reset_positions_wrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.run_decorator.html">bluesky.preprocessors.run_decorator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.run_wrapper.html">bluesky.preprocessors.run_wrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.stage_decorator.html">bluesky.preprocessors.stage_decorator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.stage_wrapper.html">bluesky.preprocessors.stage_wrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.subs_decorator.html">bluesky.preprocessors.subs_decorator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.subs_wrapper.html">bluesky.preprocessors.subs_wrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.suspend_decorator.html">bluesky.preprocessors.suspend_decorator</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/bluesky.preprocessors.suspend_wrapper.html">bluesky.preprocessors.suspend_wrapper</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#custom-preprocessors">Custom Preprocessors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#customize-step-scans-with-per-step">Customize Step Scans with <code class="docutils literal"><span class="pre">per_step</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#asynchronous-plans-fly-scans-and-monitoring">Asynchronous Plans: “Fly Scans” and “Monitoring”</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plan-utilities">Plan Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.preprocessors.pchain.html">bluesky.preprocessors.pchain</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.preprocessors.msg_mutator.html">bluesky.preprocessors.msg_mutator</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.preprocessors.plan_mutator.html">bluesky.preprocessors.plan_mutator</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.preprocessors.single_gen.html">bluesky.preprocessors.single_gen</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.preprocessors.make_decorator.html">bluesky.preprocessors.make_decorator</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.broadcast_msg.html">bluesky.plan_stubs.broadcast_msg</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky.plan_stubs.repeat.html">bluesky.plan_stubs.repeat</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="documents.html">Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Recording Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="callbacks.html">Live Visualization and Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="state-machine.html">Interruptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulation.html">Simulation and Error Checking</a></li>
<li class="toctree-l1"><a class="reference internal" href="progress-bar.html">Progress Bar</a></li>
<li class="toctree-l1"><a class="reference internal" href="event_descriptors.html">Event Descriptors</a></li>
<li class="toctree-l1"><a class="reference internal" href="async.html">Asynchronous Acquisition</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Debugging and Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="run_engine_api.html">RunEngine API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="magics.html">IPython ‘Magics’ [Experimental]</a></li>
<li class="toctree-l1"><a class="reference internal" href="from-pyepics-to-bluesky.html">Translating Direct PyEpics Code to Bluesky Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparison-with-spec.html">Comparison with SPEC</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hardware.html">How Bluesky Interfaces with Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="msg.html">Message Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="run_engine.html">The RunEngine run loop</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_changes.html">Release History</a></li>
</ul>
<p class="caption"><span class="caption-text">Data Collection</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://nsls-ii.github.io/bluesky">bluesky</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nsls-ii.github.io/ophyd">ophyd</a></li>
</ul>
<p class="caption"><span class="caption-text">Data Access and Management</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://nsls-ii.github.io/databroker">databroker</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nsls-ii.github.io/amostra">amostra</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nsls-ii.github.io/datamuxer">datamuxer</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nsls-ii.github.io/suitcase">suitcase</a></li>
</ul>
<p class="caption"><span class="caption-text">GitHub Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NSLS-II/">NSLS-II Repositories</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NSLS-II/Bug-Reports/issues">Bug Reports</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">bluesky</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Plans</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/plans.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="plans">
<h1>Plans<a class="headerlink" href="#plans" title="Permalink to this headline">¶</a></h1>
<p>A <em>plan</em> is bluesky’s concept of an experimental procedure. A plan may be any
iterable object (list, tuple, custom iterable class, …) but most commonly it
is implemented as a Python generator. For a more technical discussion we refer
you <a class="reference internal" href="msg.html"><span class="doc">Message Protocol</span></a>.</p>
<p>A variety of pre-assembled plans are provided. Like sandwiches on a deli menu,
you can use our pre-assembled plans or assemble your own from the same
ingredients, catalogued under the heading <a class="reference internal" href="#stub-plans"><span class="std std-ref">Stub Plans</span></a> below.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the examples that follow, we will assume that you have a RunEngine
instance named <code class="docutils literal"><span class="pre">RE</span></code>. This may have already been configured for you if you
are a user at a facility that runs bluesky. See
<a class="reference internal" href="tutorial.html#tutorial-run-engine-setup"><span class="std std-ref">this section of the tutorial</span></a> to sort out
if you already have a RunEngine and to quickly make one if needed.</p>
</div>
<div class="section" id="pre-assembled-plans">
<span id="preassembled-plans"></span><h2>Pre-assembled Plans<a class="headerlink" href="#pre-assembled-plans" title="Permalink to this headline">¶</a></h2>
<p>Below this summary table, we break the down the plans by category and show
examples with figures.</p>
<div class="section" id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h3>
<p>Notice that the names in the left column are links to detailed API
documentation.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.count.html#bluesky.plans.count" title="bluesky.plans.count"><code class="xref py py-obj docutils literal"><span class="pre">count</span></code></a></td>
<td>Take one or more readings from detectors.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.scan.html#bluesky.plans.scan" title="bluesky.plans.scan"><code class="xref py py-obj docutils literal"><span class="pre">scan</span></code></a></td>
<td>Scan over one multi-motor trajectory.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.rel_scan.html#bluesky.plans.rel_scan" title="bluesky.plans.rel_scan"><code class="xref py py-obj docutils literal"><span class="pre">rel_scan</span></code></a></td>
<td>Scan over one multi-motor trajectory relative to current position.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.list_scan.html#bluesky.plans.list_scan" title="bluesky.plans.list_scan"><code class="xref py py-obj docutils literal"><span class="pre">list_scan</span></code></a></td>
<td>Scan over one or more variables in steps simultaneously (inner product).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.rel_list_scan.html#bluesky.plans.rel_list_scan" title="bluesky.plans.rel_list_scan"><code class="xref py py-obj docutils literal"><span class="pre">rel_list_scan</span></code></a></td>
<td>Scan over one variable in steps relative to current position.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.list_grid_scan.html#bluesky.plans.list_grid_scan" title="bluesky.plans.list_grid_scan"><code class="xref py py-obj docutils literal"><span class="pre">list_grid_scan</span></code></a></td>
<td>Scan over a mesh; each motor is on an independent trajectory.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.rel_list_grid_scan.html#bluesky.plans.rel_list_grid_scan" title="bluesky.plans.rel_list_grid_scan"><code class="xref py py-obj docutils literal"><span class="pre">rel_list_grid_scan</span></code></a></td>
<td>Scan over a mesh; each motor is on an independent trajectory.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.log_scan.html#bluesky.plans.log_scan" title="bluesky.plans.log_scan"><code class="xref py py-obj docutils literal"><span class="pre">log_scan</span></code></a></td>
<td>Scan over one variable in log-spaced steps.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.rel_log_scan.html#bluesky.plans.rel_log_scan" title="bluesky.plans.rel_log_scan"><code class="xref py py-obj docutils literal"><span class="pre">rel_log_scan</span></code></a></td>
<td>Scan over one variable in log-spaced steps relative to current position.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.grid_scan.html#bluesky.plans.grid_scan" title="bluesky.plans.grid_scan"><code class="xref py py-obj docutils literal"><span class="pre">grid_scan</span></code></a></td>
<td>Scan over a mesh; each motor is on an independent trajectory.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.rel_grid_scan.html#bluesky.plans.rel_grid_scan" title="bluesky.plans.rel_grid_scan"><code class="xref py py-obj docutils literal"><span class="pre">rel_grid_scan</span></code></a></td>
<td>Scan over a mesh relative to current position.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.scan_nd.html#bluesky.plans.scan_nd" title="bluesky.plans.scan_nd"><code class="xref py py-obj docutils literal"><span class="pre">scan_nd</span></code></a></td>
<td>Scan over an arbitrary N-dimensional trajectory.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.spiral.html#bluesky.plans.spiral" title="bluesky.plans.spiral"><code class="xref py py-obj docutils literal"><span class="pre">spiral</span></code></a></td>
<td>Spiral scan, centered around (x_start, y_start)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.spiral_fermat.html#bluesky.plans.spiral_fermat" title="bluesky.plans.spiral_fermat"><code class="xref py py-obj docutils literal"><span class="pre">spiral_fermat</span></code></a></td>
<td>Absolute fermat spiral scan, centered around (x_start, y_start)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.spiral_square.html#bluesky.plans.spiral_square" title="bluesky.plans.spiral_square"><code class="xref py py-obj docutils literal"><span class="pre">spiral_square</span></code></a></td>
<td>Absolute square spiral scan, centered around (x_center, y_center)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.rel_spiral.html#bluesky.plans.rel_spiral" title="bluesky.plans.rel_spiral"><code class="xref py py-obj docutils literal"><span class="pre">rel_spiral</span></code></a></td>
<td>Relative spiral scan</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.rel_spiral_fermat.html#bluesky.plans.rel_spiral_fermat" title="bluesky.plans.rel_spiral_fermat"><code class="xref py py-obj docutils literal"><span class="pre">rel_spiral_fermat</span></code></a></td>
<td>Relative fermat spiral scan</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.rel_spiral_square.html#bluesky.plans.rel_spiral_square" title="bluesky.plans.rel_spiral_square"><code class="xref py py-obj docutils literal"><span class="pre">rel_spiral_square</span></code></a></td>
<td>Relative square spiral scan, centered around current (x, y) position.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.adaptive_scan.html#bluesky.plans.adaptive_scan" title="bluesky.plans.adaptive_scan"><code class="xref py py-obj docutils literal"><span class="pre">adaptive_scan</span></code></a></td>
<td>Scan over one variable with adaptively tuned step size.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.rel_adaptive_scan.html#bluesky.plans.rel_adaptive_scan" title="bluesky.plans.rel_adaptive_scan"><code class="xref py py-obj docutils literal"><span class="pre">rel_adaptive_scan</span></code></a></td>
<td>Relative scan over one variable with adaptively tuned step size.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.tune_centroid.html#bluesky.plans.tune_centroid" title="bluesky.plans.tune_centroid"><code class="xref py py-obj docutils literal"><span class="pre">tune_centroid</span></code></a></td>
<td>plan: tune a motor to the centroid of signal(motor)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.tweak.html#bluesky.plans.tweak" title="bluesky.plans.tweak"><code class="xref py py-obj docutils literal"><span class="pre">tweak</span></code></a></td>
<td>Move and motor and read a detector with an interactive prompt.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.ramp_plan.html#bluesky.plans.ramp_plan" title="bluesky.plans.ramp_plan"><code class="xref py py-obj docutils literal"><span class="pre">ramp_plan</span></code></a></td>
<td>Take data while ramping one or more positioners.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.fly.html#bluesky.plans.fly" title="bluesky.plans.fly"><code class="xref py py-obj docutils literal"><span class="pre">fly</span></code></a></td>
<td>Perform a fly scan with one or more ‘flyers’.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="time-series-count">
<h3>Time series (“count”)<a class="headerlink" href="#time-series-count" title="Permalink to this headline">¶</a></h3>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ophyd.sim</span> <span class="kn">import</span> <span class="n">det</span>
<span class="kn">from</span> <span class="nn">bluesky.plans</span> <span class="kn">import</span> <span class="n">count</span>

<span class="c1"># a single reading of the detector &#39;det&#39;</span>
<span class="n">RE</span><span class="p">(</span><span class="n">count</span><span class="p">([</span><span class="n">det</span><span class="p">]))</span>

<span class="c1"># five consecutive readings</span>
<span class="n">RE</span><span class="p">(</span><span class="n">count</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>

<span class="c1"># five sequential readings separated by a 1-second delay</span>
<span class="n">RE</span><span class="p">(</span><span class="n">count</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># a variable delay</span>
<span class="n">RE</span><span class="p">(</span><span class="n">count</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>

<span class="c1"># Take readings forever, until interrupted (e.g., with Ctrl+C)</span>
<span class="n">RE</span><span class="p">(</span><span class="n">count</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># We&#39;ll use the &#39;noisy_det&#39; example detector for a more interesting plot.</span>
<span class="kn">from</span> <span class="nn">ophyd.sim</span> <span class="kn">import</span> <span class="n">noisy_det</span>

<span class="n">RE</span><span class="p">(</span><span class="n">count</span><span class="p">([</span><span class="n">noisy_det</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Why doesn’t <a class="reference internal" href="generated/bluesky.plans.count.html#bluesky.plans.count" title="bluesky.plans.count"><code class="xref py py-func docutils literal"><span class="pre">count()</span></code></a> have an <code class="docutils literal"><span class="pre">exposure_time</span></code> parameter?</p>
<p>Modern CCD detectors typically parametrize exposure time with <em>multiple</em>
parameters (acquire time, acquire period, num exposures, …) as do scalers
(preset time, auto count time). There is no one “exposure time” that can be
applied to all detectors.</p>
<p>Additionally, when using multiple detectors as in <code class="docutils literal"><span class="pre">count([det1,</span> <span class="pre">det2]))</span></code>,
the user would need to provide a separate exposure time for each detector in
the general case, which would grow wordy.</p>
<p>One option is to set the time-related parameter(s) as a separate step.</p>
<p>For interactive use:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Just an example. Your detector might have different names or numbers of</span>
<span class="c1"># exposure-related parameters---which is the point.</span>
<span class="n">det</span><span class="o">.</span><span class="n">exposure_time</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">det</span><span class="o">.</span><span class="n">acquire_period</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">3.5</span><span class="p">)</span>
</pre></div>
</div>
<p>From a plan:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Just an example. Your detector might have different names or numbers of</span>
<span class="c1"># exposure-related parameters---which is the point.</span>
 <span class="k">yield from</span> <span class="n">bluesky</span><span class="o">.</span><span class="n">plan_stubs</span><span class="o">.</span><span class="n">mv</span><span class="p">(</span>
     <span class="n">det</span><span class="o">.</span><span class="n">exposure_time</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
     <span class="n">det</span><span class="o">.</span><span class="n">acquire_period</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)</span>
</pre></div>
</div>
<p>Another is to write a custom plan that wraps <a class="reference internal" href="generated/bluesky.plans.count.html#bluesky.plans.count" title="bluesky.plans.count"><code class="xref py py-func docutils literal"><span class="pre">count()</span></code></a> and sets the
exposure time. This plan can encode the details that bluesky in general
can’t know.</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">count_with_time</span><span class="p">(</span><span class="n">detectors</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">exposure_time</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">md</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c1"># Assume all detectors have one exposure time component called</span>
    <span class="c1"># &#39;exposure_time&#39; that fully specifies its exposure.</span>
    <span class="k">for</span> <span class="n">detector</span> <span class="ow">in</span> <span class="n">detectors</span><span class="p">:</span>
        <span class="k">yield from</span> <span class="n">bluesky</span><span class="o">.</span><span class="n">plan_stubs</span><span class="o">.</span><span class="n">mv</span><span class="p">(</span><span class="n">detector</span><span class="o">.</span><span class="n">exposure_time</span><span class="p">,</span> <span class="n">exposure_time</span><span class="p">)</span>
    <span class="k">yield from</span> <span class="n">bluesky</span><span class="o">.</span><span class="n">plans</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">detectors</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">md</span><span class="o">=</span><span class="n">md</span><span class="p">)</span>
</pre></div>
</div>
</div>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.count.html#bluesky.plans.count" title="bluesky.plans.count"><code class="xref py py-obj docutils literal"><span class="pre">count</span></code></a></td>
<td>Take one or more readings from detectors.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="scans-over-one-dimension">
<h3>Scans over one dimension<a class="headerlink" href="#scans-over-one-dimension" title="Permalink to this headline">¶</a></h3>
<p>The “dimension” might be a physical motor position, a temperature, or a
pseudo-axis. It’s all the same to the plans. Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ophyd.sim</span> <span class="kn">import</span> <span class="n">det</span><span class="p">,</span> <span class="n">motor</span>
<span class="kn">from</span> <span class="nn">bluesky.plans</span> <span class="kn">import</span> <span class="n">scan</span><span class="p">,</span> <span class="n">rel_scan</span><span class="p">,</span> <span class="n">list_scan</span>

<span class="c1"># scan a motor from 1 to 5, taking 5 equally-spaced readings of &#39;det&#39;</span>
<span class="n">RE</span><span class="p">(</span><span class="n">scan</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">motor</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># scan a motor from 1 to 5 *relative to its current position*</span>
<span class="n">RE</span><span class="p">(</span><span class="n">rel_scan</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">motor</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># scan a motor through a list of user-specified positions</span>
<span class="n">RE</span><span class="p">(</span><span class="n">list_scan</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">motor</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">scan</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">motor</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Why don’t scans have a <code class="docutils literal"><span class="pre">delay</span></code> parameter?</p>
<p>You may have noticed that <a class="reference internal" href="generated/bluesky.plans.count.html#bluesky.plans.count" title="bluesky.plans.count"><code class="xref py py-func docutils literal"><span class="pre">count()</span></code></a> has a <code class="docutils literal"><span class="pre">delay</span></code> parameter but none
of the scans do. This is intentional.</p>
<p>The common reason for wanting a delay in a scan is to allow a motor to
settle or a temperature controller to reach equilibrium. It is better to
configure this on the respective devices, so that scans will always add the
appropriate delay for the particular device being scanned.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">motor</span><span class="o">.</span><span class="n">settle_time</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">temperature_controller</span><span class="o">.</span><span class="n">settle_time</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
<p>For many cases, this is more convenient and more robust than typing a delay
parameter in every invocation of the scan. You only have to set it once, and
it applies thereafter.</p>
<p>This is why bluesky leaves <code class="docutils literal"><span class="pre">delay</span></code> out of the scans, to guide users toward
an approach that will likely be a better fit than the one that might occur
to them first. For situations where a <code class="docutils literal"><span class="pre">delay</span></code> parameter really is the
right tool for the job, it is of course always possible to add a <code class="docutils literal"><span class="pre">delay</span></code>
parameter yourself by writing a custom plan. Here is one approach, using a
<a class="reference internal" href="#per-step-hook"><span class="std std-ref">per_step hook</span></a>.</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">bluesky.plans</span>
<span class="kn">import</span> <span class="nn">bluesky.plan_stubs</span>

<span class="k">def</span> <span class="nf">scan_with_delay</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="s2">&quot;Accepts all the normal &#39;scan&#39; parameters, plus an optional delay.&quot;</span>

    <span class="k">def</span> <span class="nf">one_nd_step_with_delay</span><span class="p">(</span><span class="n">detectors</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">pos_cache</span><span class="p">):</span>
        <span class="s2">&quot;This is a copy of bluesky.plan_stubs.one_nd_step with a sleep added.&quot;</span>
        <span class="n">motors</span> <span class="o">=</span> <span class="n">step</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">yield from</span> <span class="n">bluesky</span><span class="o">.</span><span class="n">plan_stubs</span><span class="o">.</span><span class="n">move_per_step</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">pos_cache</span><span class="p">)</span>
        <span class="k">yield from</span> <span class="n">bluesky</span><span class="o">.</span><span class="n">plan_stubs</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
        <span class="k">yield from</span> <span class="n">bluesky</span><span class="o">.</span><span class="n">plan_stubs</span><span class="o">.</span><span class="n">trigger_and_read</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">detectors</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">motors</span><span class="p">))</span>

    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;per_step&#39;</span><span class="p">,</span> <span class="n">one_nd_step_with_delay</span><span class="p">)</span>
    <span class="k">yield from</span> <span class="n">bluesky</span><span class="o">.</span><span class="n">plans</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.scan.html#bluesky.plans.scan" title="bluesky.plans.scan"><code class="xref py py-obj docutils literal"><span class="pre">scan</span></code></a></td>
<td>Scan over one multi-motor trajectory.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.rel_scan.html#bluesky.plans.rel_scan" title="bluesky.plans.rel_scan"><code class="xref py py-obj docutils literal"><span class="pre">rel_scan</span></code></a></td>
<td>Scan over one multi-motor trajectory relative to current position.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.list_scan.html#bluesky.plans.list_scan" title="bluesky.plans.list_scan"><code class="xref py py-obj docutils literal"><span class="pre">list_scan</span></code></a></td>
<td>Scan over one or more variables in steps simultaneously (inner product).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.rel_list_scan.html#bluesky.plans.rel_list_scan" title="bluesky.plans.rel_list_scan"><code class="xref py py-obj docutils literal"><span class="pre">rel_list_scan</span></code></a></td>
<td>Scan over one variable in steps relative to current position.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.log_scan.html#bluesky.plans.log_scan" title="bluesky.plans.log_scan"><code class="xref py py-obj docutils literal"><span class="pre">log_scan</span></code></a></td>
<td>Scan over one variable in log-spaced steps.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.rel_log_scan.html#bluesky.plans.rel_log_scan" title="bluesky.plans.rel_log_scan"><code class="xref py py-obj docutils literal"><span class="pre">rel_log_scan</span></code></a></td>
<td>Scan over one variable in log-spaced steps relative to current position.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="multi-dimensional-scans">
<span id="id1"></span><h3>Multi-dimensional scans<a class="headerlink" href="#multi-dimensional-scans" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="tutorial.html#tutorial-multiple-motors"><span class="std std-ref">Scan Multiple Motors Together</span></a> in the tutorial for an introduction to the
common cases of moving multiple motors in coordination (i.e. moving X and Y
along a diagonal) or in a grid. The key examples are reproduced here. Again,
see the section linked for further explanation.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ophyd.sim</span> <span class="kn">import</span> <span class="n">det</span><span class="p">,</span> <span class="n">motor1</span><span class="p">,</span> <span class="n">motor2</span><span class="p">,</span> <span class="n">motor3</span>
<span class="kn">from</span> <span class="nn">bluesky.plans</span> <span class="kn">import</span> <span class="n">scan</span><span class="p">,</span> <span class="n">grid_scan</span><span class="p">,</span> <span class="n">list_scan</span><span class="p">,</span> <span class="n">list_grid_scan</span>

<span class="n">RE</span><span class="p">(</span><span class="n">scan</span><span class="p">(</span><span class="n">dets</span><span class="p">,</span>
        <span class="n">motor1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span>  <span class="c1"># scan motor1 from -1.5 to 1.5</span>
        <span class="n">motor2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span>  <span class="c1"># ...while scanning motor2 from -0.1 to 0.1</span>
        <span class="mi">11</span><span class="p">))</span>  <span class="c1"># ...both in 11 steps</span>

<span class="c1"># Scan motor1 and motor2 jointly through a 5-point trajectory.</span>
<span class="n">RE</span><span class="p">(</span><span class="n">list_scan</span><span class="p">(</span><span class="n">dets</span><span class="p">,</span> <span class="n">motor1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">motor2</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>

<span class="c1"># Scan a 3 x 5 x 2 grid.</span>
<span class="n">RE</span><span class="p">(</span><span class="n">grid_scan</span><span class="p">([</span><span class="n">det</span><span class="p">],</span>
             <span class="n">motor1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>  <span class="c1"># no snake parameter for first motor</span>
             <span class="n">motor2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="bp">False</span><span class="p">))</span>
             <span class="n">motor3</span><span class="p">,</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="bp">False</span><span class="p">))</span>

<span class="c1"># Scan a grid with abitrary spacings given as specific positions.</span>
<span class="n">RE</span><span class="p">(</span><span class="n">list_grid_scan</span><span class="p">([</span><span class="n">det</span><span class="p">],</span>
                  <span class="n">motor1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                  <span class="n">motor2</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">]))</span>
</pre></div>
</div>
<p>All of these plans are built on a more general-purpose plan,
<code class="xref py py-func docutils literal"><span class="pre">scan_nd()</span></code>, which we can use for more specialized cases.</p>
<p>Some jargon: we speak of <a class="reference internal" href="generated/bluesky.plans.scan.html#bluesky.plans.scan" title="bluesky.plans.scan"><code class="xref py py-func docutils literal"><span class="pre">scan()</span></code></a>-like joint movement as an
“inner product” of trajectories and <a class="reference internal" href="generated/bluesky.plans.grid_scan.html#bluesky.plans.grid_scan" title="bluesky.plans.grid_scan"><code class="xref py py-func docutils literal"><span class="pre">grid_scan()</span></code></a>-like
movement as an “outer product” of trajectories. The general case, moving some
motors together in an “inner product” against another motor (or motors) in an
“outer product,” can be addressed using a <code class="docutils literal"><span class="pre">cycler</span></code>.  Notice what happens when
we add or multiply <code class="docutils literal"><span class="pre">cycler</span></code> objects.</p>
<pre class="literal-block">
In [1]: from cycler import cycler

In [2]: from ophyd.sim import motor1, motor2, motor3

In [3]: traj1 = cycler(motor1, [1, 2, 3])

In [4]: traj2 = cycler(motor2, [10, 20, 30])

In [5]: list(traj1)  # a trajectory for motor1
Out[5]: 
[{SynAxis(prefix='', name='motor1', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 1},
 {SynAxis(prefix='', name='motor1', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 2},
 {SynAxis(prefix='', name='motor1', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 3}]

In [6]: list(traj1 + traj2)  # an &quot;inner product&quot; trajectory
Out[6]: 
[{SynAxis(prefix='', name='motor1', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 1,
  SynAxis(prefix='', name='motor2', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 10},
 {SynAxis(prefix='', name='motor1', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 2,
  SynAxis(prefix='', name='motor2', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 20},
 {SynAxis(prefix='', name='motor1', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 3,
  SynAxis(prefix='', name='motor2', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 30}]

In [7]: list(traj1 * traj2)  # an &quot;outer product&quot; trajectory
Out[7]: 
[{SynAxis(prefix='', name='motor1', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 1,
  SynAxis(prefix='', name='motor2', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 10},
 {SynAxis(prefix='', name='motor1', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 1,
  SynAxis(prefix='', name='motor2', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 20},
 {SynAxis(prefix='', name='motor1', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 1,
  SynAxis(prefix='', name='motor2', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 30},
 {SynAxis(prefix='', name='motor1', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 2,
  SynAxis(prefix='', name='motor2', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 10},
 {SynAxis(prefix='', name='motor1', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 2,
  SynAxis(prefix='', name='motor2', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 20},
 {SynAxis(prefix='', name='motor1', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 2,
  SynAxis(prefix='', name='motor2', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 30},
 {SynAxis(prefix='', name='motor1', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 3,
  SynAxis(prefix='', name='motor2', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 10},
 {SynAxis(prefix='', name='motor1', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 3,
  SynAxis(prefix='', name='motor2', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 20},
 {SynAxis(prefix='', name='motor1', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 3,
  SynAxis(prefix='', name='motor2', read_attrs=['readback', 'setpoint'], configuration_attrs=['velocity', 'acceleration']): 30}]
</pre>
<p>We have reproduced inner product and outer product. The real power comes in
when we combine them, like so. Here, motor1 and motor2 together in a mesh
against motor3.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">traj3</span> <span class="o">=</span> <span class="n">cycler</span><span class="p">(</span><span class="n">motor3</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">])</span>

<span class="gp">In [9]: </span><span class="nb">list</span><span class="p">((</span><span class="n">traj1</span> <span class="o">+</span> <span class="n">traj2</span><span class="p">)</span> <span class="o">*</span> <span class="n">traj3</span><span class="p">)</span>
<span class="gh">Out[9]: </span><span class="go"></span>
<span class="go">[{SynAxis(prefix=&#39;&#39;, name=&#39;motor1&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 1,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor2&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 10,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor3&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 100},</span>
<span class="go"> {SynAxis(prefix=&#39;&#39;, name=&#39;motor1&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 1,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor2&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 10,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor3&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 200},</span>
<span class="go"> {SynAxis(prefix=&#39;&#39;, name=&#39;motor1&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 1,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor2&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 10,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor3&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 300},</span>
<span class="go"> {SynAxis(prefix=&#39;&#39;, name=&#39;motor1&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 2,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor2&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 20,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor3&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 100},</span>
<span class="go"> {SynAxis(prefix=&#39;&#39;, name=&#39;motor1&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 2,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor2&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 20,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor3&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 200},</span>
<span class="go"> {SynAxis(prefix=&#39;&#39;, name=&#39;motor1&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 2,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor2&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 20,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor3&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 300},</span>
<span class="go"> {SynAxis(prefix=&#39;&#39;, name=&#39;motor1&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 3,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor2&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 30,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor3&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 100},</span>
<span class="go"> {SynAxis(prefix=&#39;&#39;, name=&#39;motor1&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 3,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor2&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 30,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor3&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 200},</span>
<span class="go"> {SynAxis(prefix=&#39;&#39;, name=&#39;motor1&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 3,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor2&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 30,</span>
<span class="go">  SynAxis(prefix=&#39;&#39;, name=&#39;motor3&#39;, read_attrs=[&#39;readback&#39;, &#39;setpoint&#39;], configuration_attrs=[&#39;velocity&#39;, &#39;acceleration&#39;]): 300}]</span>
</pre></div>
</div>
<p>For more on cycler, we refer you to the
<a class="reference external" href="http://matplotlib.org/cycler/">cycler documentation</a>. To build a plan
incorporating these trajectories, use our general N-dimensional scan plan,
<a class="reference internal" href="generated/bluesky.plans.scan_nd.html#bluesky.plans.scan_nd" title="bluesky.plans.scan_nd"><code class="xref py py-func docutils literal"><span class="pre">scan_nd()</span></code></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">scan_nd</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="p">(</span><span class="n">traj1</span> <span class="o">+</span> <span class="n">traj2</span><span class="p">)</span> <span class="o">*</span> <span class="n">traj3</span><span class="p">))</span>
</pre></div>
</div>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.scan.html#bluesky.plans.scan" title="bluesky.plans.scan"><code class="xref py py-obj docutils literal"><span class="pre">scan</span></code></a></td>
<td>Scan over one multi-motor trajectory.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.rel_scan.html#bluesky.plans.rel_scan" title="bluesky.plans.rel_scan"><code class="xref py py-obj docutils literal"><span class="pre">rel_scan</span></code></a></td>
<td>Scan over one multi-motor trajectory relative to current position.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.grid_scan.html#bluesky.plans.grid_scan" title="bluesky.plans.grid_scan"><code class="xref py py-obj docutils literal"><span class="pre">grid_scan</span></code></a></td>
<td>Scan over a mesh; each motor is on an independent trajectory.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.rel_grid_scan.html#bluesky.plans.rel_grid_scan" title="bluesky.plans.rel_grid_scan"><code class="xref py py-obj docutils literal"><span class="pre">rel_grid_scan</span></code></a></td>
<td>Scan over a mesh relative to current position.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.list_scan.html#bluesky.plans.list_scan" title="bluesky.plans.list_scan"><code class="xref py py-obj docutils literal"><span class="pre">list_scan</span></code></a></td>
<td>Scan over one or more variables in steps simultaneously (inner product).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.rel_list_scan.html#bluesky.plans.rel_list_scan" title="bluesky.plans.rel_list_scan"><code class="xref py py-obj docutils literal"><span class="pre">rel_list_scan</span></code></a></td>
<td>Scan over one variable in steps relative to current position.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.list_grid_scan.html#bluesky.plans.list_grid_scan" title="bluesky.plans.list_grid_scan"><code class="xref py py-obj docutils literal"><span class="pre">list_grid_scan</span></code></a></td>
<td>Scan over a mesh; each motor is on an independent trajectory.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.rel_list_grid_scan.html#bluesky.plans.rel_list_grid_scan" title="bluesky.plans.rel_list_grid_scan"><code class="xref py py-obj docutils literal"><span class="pre">rel_list_grid_scan</span></code></a></td>
<td>Scan over a mesh; each motor is on an independent trajectory.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.scan_nd.html#bluesky.plans.scan_nd" title="bluesky.plans.scan_nd"><code class="xref py py-obj docutils literal"><span class="pre">scan_nd</span></code></a></td>
<td>Scan over an arbitrary N-dimensional trajectory.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="spiral-trajectories">
<h3>Spiral trajectories<a class="headerlink" href="#spiral-trajectories" title="Permalink to this headline">¶</a></h3>
<p>We provide two-dimensional scans that trace out spiral trajectories.</p>
<p>A simple spiral:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bluesky.simulators</span> <span class="kn">import</span> <span class="n">plot_raster_path</span>
<span class="kn">from</span> <span class="nn">ophyd.sim</span> <span class="kn">import</span> <span class="n">motor1</span><span class="p">,</span> <span class="n">motor2</span><span class="p">,</span> <span class="n">det</span>
<span class="kn">from</span> <span class="nn">bluesky.plans</span> <span class="kn">import</span> <span class="n">spiral</span>

<span class="n">plan</span> <span class="o">=</span> <span class="n">spiral</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">motor1</span><span class="p">,</span> <span class="n">motor2</span><span class="p">,</span> <span class="n">x_start</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y_start</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span>
              <span class="n">y_range</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">nth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plot_raster_path</span><span class="p">(</span><span class="n">plan</span><span class="p">,</span> <span class="s1">&#39;motor1&#39;</span><span class="p">,</span> <span class="s1">&#39;motor2&#39;</span><span class="p">,</span> <span class="n">probe_size</span><span class="o">=.</span><span class="mo">01</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="_images/plans-3.png" src="_images/plans-3.png" />
</div>
<p>A fermat spiral:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bluesky.simulators</span> <span class="kn">import</span> <span class="n">plot_raster_path</span>
<span class="kn">from</span> <span class="nn">ophyd.sim</span> <span class="kn">import</span> <span class="n">motor1</span><span class="p">,</span> <span class="n">motor2</span><span class="p">,</span> <span class="n">det</span>
<span class="kn">from</span> <span class="nn">bluesky.plans</span> <span class="kn">import</span> <span class="n">spiral_fermat</span>

<span class="n">plan</span> <span class="o">=</span> <span class="n">spiral_fermat</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">motor1</span><span class="p">,</span> <span class="n">motor2</span><span class="p">,</span> <span class="n">x_start</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y_start</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                     <span class="n">x_range</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">y_range</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">dr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">tilt</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">plot_raster_path</span><span class="p">(</span><span class="n">plan</span><span class="p">,</span> <span class="s1">&#39;motor1&#39;</span><span class="p">,</span> <span class="s1">&#39;motor2&#39;</span><span class="p">,</span> <span class="n">probe_size</span><span class="o">=.</span><span class="mo">01</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="_images/plans-4.png" src="_images/plans-4.png" />
</div>
<p>A square spiral:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bluesky.simulators</span> <span class="kn">import</span> <span class="n">plot_raster_path</span>
<span class="kn">from</span> <span class="nn">ophyd.sim</span> <span class="kn">import</span> <span class="n">motor1</span><span class="p">,</span> <span class="n">motor2</span><span class="p">,</span> <span class="n">det</span>
<span class="kn">from</span> <span class="nn">bluesky.plans</span> <span class="kn">import</span> <span class="n">spiral_square</span>

<span class="n">plan</span> <span class="o">=</span> <span class="n">spiral_square</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">motor1</span><span class="p">,</span> <span class="n">motor2</span><span class="p">,</span> <span class="n">x_center</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y_center</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                     <span class="n">x_range</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">y_range</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">x_num</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">y_num</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">plot_raster_path</span><span class="p">(</span><span class="n">plan</span><span class="p">,</span> <span class="s1">&#39;motor1&#39;</span><span class="p">,</span> <span class="s1">&#39;motor2&#39;</span><span class="p">,</span> <span class="n">probe_size</span><span class="o">=.</span><span class="mo">01</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="_images/plans-5.png" src="_images/plans-5.png" />
</div>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.spiral.html#bluesky.plans.spiral" title="bluesky.plans.spiral"><code class="xref py py-obj docutils literal"><span class="pre">spiral</span></code></a></td>
<td>Spiral scan, centered around (x_start, y_start)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.spiral_fermat.html#bluesky.plans.spiral_fermat" title="bluesky.plans.spiral_fermat"><code class="xref py py-obj docutils literal"><span class="pre">spiral_fermat</span></code></a></td>
<td>Absolute fermat spiral scan, centered around (x_start, y_start)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.spiral_square.html#bluesky.plans.spiral_square" title="bluesky.plans.spiral_square"><code class="xref py py-obj docutils literal"><span class="pre">spiral_square</span></code></a></td>
<td>Absolute square spiral scan, centered around (x_center, y_center)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.rel_spiral.html#bluesky.plans.rel_spiral" title="bluesky.plans.rel_spiral"><code class="xref py py-obj docutils literal"><span class="pre">rel_spiral</span></code></a></td>
<td>Relative spiral scan</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.rel_spiral_fermat.html#bluesky.plans.rel_spiral_fermat" title="bluesky.plans.rel_spiral_fermat"><code class="xref py py-obj docutils literal"><span class="pre">rel_spiral_fermat</span></code></a></td>
<td>Relative fermat spiral scan</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.rel_spiral_square.html#bluesky.plans.rel_spiral_square" title="bluesky.plans.rel_spiral_square"><code class="xref py py-obj docutils literal"><span class="pre">rel_spiral_square</span></code></a></td>
<td>Relative square spiral scan, centered around current (x, y) position.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="adaptive-scans">
<h3>Adaptive scans<a class="headerlink" href="#adaptive-scans" title="Permalink to this headline">¶</a></h3>
<p>These are one-dimension scans with an adaptive step size tuned to move quickly
over flat regions can concentrate readings in areas of high variation by
computing the local slope aiming for a target delta y between consecutive
points.</p>
<p>This is a basic example of the power of adaptive plan logic.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bluesky.plans</span> <span class="kn">import</span> <span class="n">adaptive_scan</span>
<span class="kn">from</span> <span class="nn">ophyd.sim</span> <span class="kn">import</span> <span class="n">motor</span><span class="p">,</span> <span class="n">det</span>

<span class="n">RE</span><span class="p">(</span><span class="n">adaptive_scan</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="n">motor</span><span class="p">,</span>
                 <span class="n">start</span><span class="o">=-</span><span class="mi">15</span><span class="p">,</span>
                 <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">min_step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                 <span class="n">max_step</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                 <span class="n">target_delta</span><span class="o">=.</span><span class="mo">05</span><span class="p">,</span>
                 <span class="n">backstep</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
</pre></div>
</div>
<p>From left to right, the scan lengthens its stride through the flat region. At
first, it steps past the peak. The large jump causes it to double back and then
sample more densely through the peak. As the peak flattens, it lengthens its
stride again.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.adaptive_scan.html#bluesky.plans.adaptive_scan" title="bluesky.plans.adaptive_scan"><code class="xref py py-obj docutils literal"><span class="pre">adaptive_scan</span></code></a></td>
<td>Scan over one variable with adaptively tuned step size.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.rel_adaptive_scan.html#bluesky.plans.rel_adaptive_scan" title="bluesky.plans.rel_adaptive_scan"><code class="xref py py-obj docutils literal"><span class="pre">rel_adaptive_scan</span></code></a></td>
<td>Relative scan over one variable with adaptively tuned step size.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="misc">
<h3>Misc.<a class="headerlink" href="#misc" title="Permalink to this headline">¶</a></h3>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plans.tweak.html#bluesky.plans.tweak" title="bluesky.plans.tweak"><code class="xref py py-obj docutils literal"><span class="pre">tweak</span></code></a></td>
<td>Move and motor and read a detector with an interactive prompt.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plans.fly.html#bluesky.plans.fly" title="bluesky.plans.fly"><code class="xref py py-obj docutils literal"><span class="pre">fly</span></code></a></td>
<td>Perform a fly scan with one or more ‘flyers’.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="stub-plans">
<span id="id2"></span><h2>Stub Plans<a class="headerlink" href="#stub-plans" title="Permalink to this headline">¶</a></h2>
<p>These are the aforementioned “ingredients” for remixing, the pieces from which
the pre-assembled plans above were made. See <a class="reference internal" href="tutorial.html#tutorial-custom-plans"><span class="std std-ref">Write Custom Plans</span></a> in
the tutorial for a practical introduction to these components.</p>
<p>Plans for interacting with hardware:</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.abs_set.html#bluesky.plan_stubs.abs_set" title="bluesky.plan_stubs.abs_set"><code class="xref py py-obj docutils literal"><span class="pre">abs_set</span></code></a></td>
<td>Set a value.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.rel_set.html#bluesky.plan_stubs.rel_set" title="bluesky.plan_stubs.rel_set"><code class="xref py py-obj docutils literal"><span class="pre">rel_set</span></code></a></td>
<td>Set a value relative to current value.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.mv.html#bluesky.plan_stubs.mv" title="bluesky.plan_stubs.mv"><code class="xref py py-obj docutils literal"><span class="pre">mv</span></code></a></td>
<td>Move one or more devices to a setpoint.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.mvr.html#bluesky.plan_stubs.mvr" title="bluesky.plan_stubs.mvr"><code class="xref py py-obj docutils literal"><span class="pre">mvr</span></code></a></td>
<td>Move one or more devices to a relative setpoint.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.trigger.html#bluesky.plan_stubs.trigger" title="bluesky.plan_stubs.trigger"><code class="xref py py-obj docutils literal"><span class="pre">trigger</span></code></a></td>
<td>Trigger and acquisition.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.read.html#bluesky.plan_stubs.read" title="bluesky.plan_stubs.read"><code class="xref py py-obj docutils literal"><span class="pre">read</span></code></a></td>
<td>Take a reading and add it to the current bundle of readings.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.stage.html#bluesky.plan_stubs.stage" title="bluesky.plan_stubs.stage"><code class="xref py py-obj docutils literal"><span class="pre">stage</span></code></a></td>
<td>‘Stage’ a device (i.e., prepare it for use, ‘arm’ it).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.unstage.html#bluesky.plan_stubs.unstage" title="bluesky.plan_stubs.unstage"><code class="xref py py-obj docutils literal"><span class="pre">unstage</span></code></a></td>
<td>‘Unstage’ a device (i.e., put it in standby, ‘disarm’ it).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.configure.html#bluesky.plan_stubs.configure" title="bluesky.plan_stubs.configure"><code class="xref py py-obj docutils literal"><span class="pre">configure</span></code></a></td>
<td>Change Device configuration and emit an updated Event Descriptor document.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.stop.html#bluesky.plan_stubs.stop" title="bluesky.plan_stubs.stop"><code class="xref py py-obj docutils literal"><span class="pre">stop</span></code></a></td>
<td>Stop a device.</td>
</tr>
</tbody>
</table>
<p>Plans for asynchronous acquisition:</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.monitor.html#bluesky.plan_stubs.monitor" title="bluesky.plan_stubs.monitor"><code class="xref py py-obj docutils literal"><span class="pre">monitor</span></code></a></td>
<td>Asynchronously monitor for new values and emit Event documents.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.unmonitor.html#bluesky.plan_stubs.unmonitor" title="bluesky.plan_stubs.unmonitor"><code class="xref py py-obj docutils literal"><span class="pre">unmonitor</span></code></a></td>
<td>Stop monitoring.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.kickoff.html#bluesky.plan_stubs.kickoff" title="bluesky.plan_stubs.kickoff"><code class="xref py py-obj docutils literal"><span class="pre">kickoff</span></code></a></td>
<td>Kickoff a fly-scanning device.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.complete.html#bluesky.plan_stubs.complete" title="bluesky.plan_stubs.complete"><code class="xref py py-obj docutils literal"><span class="pre">complete</span></code></a></td>
<td>Tell a flyer, ‘stop collecting, whenver you are ready’.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.collect.html#bluesky.plan_stubs.collect" title="bluesky.plan_stubs.collect"><code class="xref py py-obj docutils literal"><span class="pre">collect</span></code></a></td>
<td>Collect data cached by a fly-scanning device and emit documents.</td>
</tr>
</tbody>
</table>
<p>Plans that control the RunEngine:</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.open_run.html#bluesky.plan_stubs.open_run" title="bluesky.plan_stubs.open_run"><code class="xref py py-obj docutils literal"><span class="pre">open_run</span></code></a></td>
<td>Mark the beginning of a new ‘run’.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.close_run.html#bluesky.plan_stubs.close_run" title="bluesky.plan_stubs.close_run"><code class="xref py py-obj docutils literal"><span class="pre">close_run</span></code></a></td>
<td>Mark the end of the current ‘run’.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.create.html#bluesky.plan_stubs.create" title="bluesky.plan_stubs.create"><code class="xref py py-obj docutils literal"><span class="pre">create</span></code></a></td>
<td>Bundle future readings into a new Event document.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.save.html#bluesky.plan_stubs.save" title="bluesky.plan_stubs.save"><code class="xref py py-obj docutils literal"><span class="pre">save</span></code></a></td>
<td>Close a bundle of readings and emit a completed Event document.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.drop.html#bluesky.plan_stubs.drop" title="bluesky.plan_stubs.drop"><code class="xref py py-obj docutils literal"><span class="pre">drop</span></code></a></td>
<td>Drop a bundle of readings without emitting a completed Event document.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.pause.html#bluesky.plan_stubs.pause" title="bluesky.plan_stubs.pause"><code class="xref py py-obj docutils literal"><span class="pre">pause</span></code></a></td>
<td>Pause and wait for the user to resume.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.deferred_pause.html#bluesky.plan_stubs.deferred_pause" title="bluesky.plan_stubs.deferred_pause"><code class="xref py py-obj docutils literal"><span class="pre">deferred_pause</span></code></a></td>
<td>Pause at the next checkpoint.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.checkpoint.html#bluesky.plan_stubs.checkpoint" title="bluesky.plan_stubs.checkpoint"><code class="xref py py-obj docutils literal"><span class="pre">checkpoint</span></code></a></td>
<td>If interrupted, rewind to this point.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.clear_checkpoint.html#bluesky.plan_stubs.clear_checkpoint" title="bluesky.plan_stubs.clear_checkpoint"><code class="xref py py-obj docutils literal"><span class="pre">clear_checkpoint</span></code></a></td>
<td>Designate that it is not safe to resume.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.sleep.html#bluesky.plan_stubs.sleep" title="bluesky.plan_stubs.sleep"><code class="xref py py-obj docutils literal"><span class="pre">sleep</span></code></a></td>
<td>Tell the RunEngine to sleep, while asynchronously doing other processing.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.input_plan.html#bluesky.plan_stubs.input_plan" title="bluesky.plan_stubs.input_plan"><code class="xref py py-obj docutils literal"><span class="pre">input_plan</span></code></a></td>
<td>Prompt the user for text input.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.subscribe.html#bluesky.plan_stubs.subscribe" title="bluesky.plan_stubs.subscribe"><code class="xref py py-obj docutils literal"><span class="pre">subscribe</span></code></a></td>
<td>Subscribe the stream of emitted documents.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.unsubscribe.html#bluesky.plan_stubs.unsubscribe" title="bluesky.plan_stubs.unsubscribe"><code class="xref py py-obj docutils literal"><span class="pre">unsubscribe</span></code></a></td>
<td>Remove a subscription.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.install_suspender.html#bluesky.plan_stubs.install_suspender" title="bluesky.plan_stubs.install_suspender"><code class="xref py py-obj docutils literal"><span class="pre">install_suspender</span></code></a></td>
<td>Install a suspender during a plan.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.remove_suspender.html#bluesky.plan_stubs.remove_suspender" title="bluesky.plan_stubs.remove_suspender"><code class="xref py py-obj docutils literal"><span class="pre">remove_suspender</span></code></a></td>
<td>Remove a suspender during a plan.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.wait.html#bluesky.plan_stubs.wait" title="bluesky.plan_stubs.wait"><code class="xref py py-obj docutils literal"><span class="pre">wait</span></code></a></td>
<td>Wait for all statuses in a group to report being finished.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.wait_for.html#bluesky.plan_stubs.wait_for" title="bluesky.plan_stubs.wait_for"><code class="xref py py-obj docutils literal"><span class="pre">wait_for</span></code></a></td>
<td>Low-level: wait for a list of <code class="docutils literal"><span class="pre">asyncio.Future</span></code> objects to set (complete).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.null.html#bluesky.plan_stubs.null" title="bluesky.plan_stubs.null"><code class="xref py py-obj docutils literal"><span class="pre">null</span></code></a></td>
<td>Yield a no-op Message.</td>
</tr>
</tbody>
</table>
<p>Combinations of the above that are often convenient:</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">trigger_and_read</span></code>(devices[,&nbsp;name])</td>
<td>Trigger and read a list of detectors and bundle readings into one Event.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">one_1d_step</span></code>(detectors,&nbsp;motor,&nbsp;step)</td>
<td>Inner loop of a 1D step scan</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">one_nd_step</span></code>(detectors,&nbsp;step,&nbsp;pos_cache)</td>
<td>Inner loop of an N-dimensional step scan</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">move_per_step</span></code>(step,&nbsp;pos_cache)</td>
<td>Inner loop of an N-dimensional step scan without any readings</td>
</tr>
</tbody>
</table>
<p>Special utilities:</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.repeat.html#bluesky.plan_stubs.repeat" title="bluesky.plan_stubs.repeat"><code class="xref py py-obj docutils literal"><span class="pre">repeat</span></code></a>(plan[,&nbsp;num,&nbsp;delay])</td>
<td>Repeat a plan num times with delay and checkpoint between each repeat.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">repeater</span></code>(n,&nbsp;gen_func,&nbsp;\*args,&nbsp;\*\*kwargs)</td>
<td>Generate n chained copies of the messages from gen_func</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">caching_repeater</span></code>(n,&nbsp;plan)</td>
<td>Generate n chained copies of the messages in a plan.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.broadcast_msg.html#bluesky.plan_stubs.broadcast_msg" title="bluesky.plan_stubs.broadcast_msg"><code class="xref py py-obj docutils literal"><span class="pre">broadcast_msg</span></code></a>(command,&nbsp;objs,&nbsp;\*args,&nbsp;\*\*kwargs)</td>
<td>Generate many copies of a mesasge, applying it to a list of devices.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="plan-preprocessors">
<span id="preprocessors"></span><h2>Plan Preprocessors<a class="headerlink" href="#plan-preprocessors" title="Permalink to this headline">¶</a></h2>
<div class="section" id="supplemental-data">
<span id="id3"></span><h3>Supplemental Data<a class="headerlink" href="#supplemental-data" title="Permalink to this headline">¶</a></h3>
<p>Plan preprocessors modify a plans contents on the fly. One common use of a
preprocessor is to take “baseline” readings of a group of devices at the
beginning and end of each run. It is convenient to apply this to <em>all</em> plans
executed by a RunEngine using the <a class="reference internal" href="#bluesky.preprocessors.SupplementalData" title="bluesky.preprocessors.SupplementalData"><code class="xref py py-class docutils literal"><span class="pre">SupplementalData</span></code></a>.</p>
<dl class="class">
<dt id="bluesky.preprocessors.SupplementalData">
<em class="property">class </em><code class="descclassname">bluesky.preprocessors.</code><code class="descname">SupplementalData</code><span class="sig-paren">(</span><em>*</em>, <em>baseline=None</em>, <em>monitors=None</em>, <em>flyers=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluesky/preprocessors.html#SupplementalData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bluesky.preprocessors.SupplementalData" title="Permalink to this definition">¶</a></dt>
<dd><p>A configurable preprocessor for supplemental measurements</p>
<p>This is a plan preprocessor. It inserts messages into plans to:</p>
<ul class="simple">
<li>take “baseline” readings at the beginning and end of each run for the
devices listed in its <code class="docutils literal"><span class="pre">baseline</span></code> atrribute</li>
<li>monitor signals in its <code class="docutils literal"><span class="pre">monitors</span></code> attribute for asynchronous
updates during each run.</li>
<li>kick off “flyable” devices listed in its <code class="docutils literal"><span class="pre">flyers</span></code> attribute at the
beginning of each run and collect their data at the end</li>
</ul>
<p>Internally, it uses the plan preprocessors:</p>
<ul class="simple">
<li><a class="reference internal" href="generated/bluesky.preprocessors.baseline_wrapper.html#bluesky.preprocessors.baseline_wrapper" title="bluesky.preprocessors.baseline_wrapper"><code class="xref py py-func docutils literal"><span class="pre">baseline_wrapper()</span></code></a></li>
<li><a class="reference internal" href="generated/bluesky.preprocessors.monitor_during_wrapper.html#bluesky.preprocessors.monitor_during_wrapper" title="bluesky.preprocessors.monitor_during_wrapper"><code class="xref py py-func docutils literal"><span class="pre">monitor_during_wrapper()</span></code></a></li>
<li><a class="reference internal" href="generated/bluesky.preprocessors.fly_during_wrapper.html#bluesky.preprocessors.fly_during_wrapper" title="bluesky.preprocessors.fly_during_wrapper"><code class="xref py py-func docutils literal"><span class="pre">fly_during_wrapper()</span></code></a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>baseline</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first last">Devices to be read at the beginning and end of each run</p>
</dd>
<dt><strong>monitors</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first last">Signals (not multi-signal Devices) to be monitored during each run,
generating readings asynchronously</p>
</dd>
<dt><strong>flyers</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first last">“Flyable” Devices to be kicked off before each run and collected
at the end of each run</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Create an instance of SupplementalData and apply it to a RunEngine.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sd</span> <span class="o">=</span> <span class="n">SupplementalData</span><span class="p">(</span><span class="n">baseline</span><span class="o">=</span><span class="p">[</span><span class="n">some_motor</span><span class="p">,</span> <span class="n">some_detector</span><span class="p">]),</span>
<span class="gp">... </span>                      <span class="n">monitors</span><span class="o">=</span><span class="p">[</span><span class="n">some_signal</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="n">flyers</span><span class="o">=</span><span class="p">[</span><span class="n">some_flyer</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RE</span> <span class="o">=</span> <span class="n">RunEngine</span><span class="p">({})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RE</span><span class="o">.</span><span class="n">preprocessors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sd</span><span class="p">)</span>
</pre></div>
</div>
<p>Now all plans executed by RE will be modified to add baseline readings
(before and after each run), monitors (during each run), and flyers
(kicked off before each run and collected afterward).</p>
<p>Inspect or update the lists of devices interactively.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sd</span><span class="o">.</span><span class="n">baseline</span>
<span class="go">[some_motor, some_detector]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sd</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">some_motor</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sd</span><span class="o">.</span><span class="n">baseline</span>
<span class="go">[some_detector]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sd</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">another_detector</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sd</span><span class="o">.</span><span class="n">baseline</span>
<span class="go">[some_detector, another_detector]</span>
</pre></div>
</div>
<p>Each attribute (<code class="docutils literal"><span class="pre">baseline</span></code>, <code class="docutils literal"><span class="pre">monitors</span></code>, <code class="docutils literal"><span class="pre">flyers</span></code>) is an ordinary
Python list, support all the standard list methods, such as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sd</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</pre></div>
</div>
<p>The arguments to SupplementalData are optional. All the lists
will empty by default.  As shown above, they can be populated
interactively.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sd</span> <span class="o">=</span> <span class="n">SupplementalData</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RE</span> <span class="o">=</span> <span class="n">RunEngine</span><span class="p">({})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RE</span><span class="o">.</span><span class="n">preprocessors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sd</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">some_detector</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<p>We have installed a “preprocessor” on the RunEngine. A preprocessor modifies
plans, supplementing or altering their instructions in some way. From now on,
every time we type <code class="docutils literal"><span class="pre">RE(some_plan())</span></code>, the RunEngine will silently change
<code class="docutils literal"><span class="pre">some_plan()</span></code> to <code class="docutils literal"><span class="pre">sd(some_plan())</span></code>, where <code class="docutils literal"><span class="pre">sd</span></code> may insert some extra
instructions. Envision the instructions flow from <code class="docutils literal"><span class="pre">some_plan</span></code> to <code class="docutils literal"><span class="pre">sd</span></code> and
finally to <code class="docutils literal"><span class="pre">RE</span></code>. The <code class="docutils literal"><span class="pre">sd</span></code> preprocessors has the opportunity to inspect
he
instructions as they go by and modify them as it sees fit before they get
processed by the RunEngine.</p>
</div>
<div class="section" id="preprocessor-wrappers-and-decorators">
<h3>Preprocessor Wrappers and Decorators<a class="headerlink" href="#preprocessor-wrappers-and-decorators" title="Permalink to this headline">¶</a></h3>
<p>Preprocessors can make arbirary modifcations to a plan, and can get quite
devious. For example, the <a class="reference internal" href="generated/bluesky.preprocessors.relative_set_wrapper.html#bluesky.preprocessors.relative_set_wrapper" title="bluesky.preprocessors.relative_set_wrapper"><code class="xref py py-func docutils literal"><span class="pre">relative_set_wrapper()</span></code></a> rewrites all positions
to be relative to the initial position.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rel_scan</span><span class="p">(</span><span class="n">detectors</span><span class="p">,</span> <span class="n">motor</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
    <span class="n">absolute</span> <span class="o">=</span> <span class="n">scan</span><span class="p">(</span><span class="n">detectors</span><span class="p">,</span> <span class="n">motor</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
    <span class="n">relative</span> <span class="o">=</span> <span class="n">relative_set_wrapper</span><span class="p">(</span><span class="n">absolute</span><span class="p">,</span> <span class="p">[</span><span class="n">motor</span><span class="p">])</span>
    <span class="k">yield from</span> <span class="n">relative</span>
</pre></div>
</div>
<p>This is a subtle but remarkably powerful feature.</p>
<p>Wrappers like <a class="reference internal" href="generated/bluesky.preprocessors.relative_set_wrapper.html#bluesky.preprocessors.relative_set_wrapper" title="bluesky.preprocessors.relative_set_wrapper"><code class="xref py py-func docutils literal"><span class="pre">relative_set_wrapper()</span></code></a> operate on a generator <em>instance</em>,
like <code class="docutils literal"><span class="pre">scan(...)</span></code>. There are corresponding decorator functions like
<code class="docutils literal"><span class="pre">relative_set_decorator</span></code> that operate on a generator
<em>function</em> itself, like <code class="xref py py-func docutils literal"><span class="pre">scan()</span></code>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Using a decorator to modify a generator function</span>
<span class="k">def</span> <span class="nf">rel_scan</span><span class="p">(</span><span class="n">detectors</span><span class="p">,</span> <span class="n">motor</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>

    <span class="nd">@relative_set_decorator</span><span class="p">([</span><span class="n">motor</span><span class="p">])</span>  <span class="c1"># unfamiliar syntax? -- see box below</span>
    <span class="k">def</span> <span class="nf">inner_relative_scan</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">scan</span><span class="p">(</span><span class="n">detectors</span><span class="p">,</span> <span class="n">motor</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>

    <span class="k">yield from</span> <span class="n">inner_relative_scan</span><span class="p">()</span>
</pre></div>
</div>
<p>Incidentally, the name <code class="docutils literal"><span class="pre">inner_relative_scan</span></code> is just an internal variable,
so why did we choose such a verbose name? Why not just name it <code class="docutils literal"><span class="pre">f</span></code>? That
would work, of course, but using a descriptive name can make debugging easier.
When navigating gnarly, deeply nested tracebacks, it helps if internal variables
have clear names.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The decorator syntax — the <code class="docutils literal"><span class="pre">&#64;</span></code> — is a succinct way of passing a
function to another function.</p>
<p>This:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@g</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="n">f</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>is equivalent to</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="n">g</span><span class="p">(</span><span class="n">f</span><span class="p">)(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="built-in-preprocessors">
<h3>Built-in Preprocessors<a class="headerlink" href="#built-in-preprocessors" title="Permalink to this headline">¶</a></h3>
<p>Each of the following functions named <code class="docutils literal"><span class="pre">&lt;something&gt;_wrapper</span></code> operates on
a generator instance. The corresponding functions named
<code class="docutils literal"><span class="pre">&lt;something_decorator&gt;</span></code> operate on a generator function.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.preprocessors.baseline_decorator.html#bluesky.preprocessors.baseline_decorator" title="bluesky.preprocessors.baseline_decorator"><code class="xref py py-obj docutils literal"><span class="pre">baseline_decorator</span></code></a></td>
<td>Preprocessor that records a baseline of all <cite>devices</cite> after <cite>open_run</cite></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.preprocessors.baseline_wrapper.html#bluesky.preprocessors.baseline_wrapper" title="bluesky.preprocessors.baseline_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">baseline_wrapper</span></code></a></td>
<td>Preprocessor that records a baseline of all <cite>devices</cite> after <cite>open_run</cite></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.preprocessors.finalize_decorator.html#bluesky.preprocessors.finalize_decorator" title="bluesky.preprocessors.finalize_decorator"><code class="xref py py-obj docutils literal"><span class="pre">finalize_decorator</span></code></a></td>
<td>try…finally helper</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.preprocessors.finalize_wrapper.html#bluesky.preprocessors.finalize_wrapper" title="bluesky.preprocessors.finalize_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">finalize_wrapper</span></code></a></td>
<td>try…finally helper</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.preprocessors.fly_during_decorator.html#bluesky.preprocessors.fly_during_decorator" title="bluesky.preprocessors.fly_during_decorator"><code class="xref py py-obj docutils literal"><span class="pre">fly_during_decorator</span></code></a></td>
<td>Kickoff and collect “flyer” (asynchronously collect) objects during runs.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.preprocessors.fly_during_wrapper.html#bluesky.preprocessors.fly_during_wrapper" title="bluesky.preprocessors.fly_during_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">fly_during_wrapper</span></code></a></td>
<td>Kickoff and collect “flyer” (asynchronously collect) objects during runs.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.preprocessors.inject_md_decorator.html#bluesky.preprocessors.inject_md_decorator" title="bluesky.preprocessors.inject_md_decorator"><code class="xref py py-obj docutils literal"><span class="pre">inject_md_decorator</span></code></a></td>
<td>Inject additional metadata into a run.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.preprocessors.inject_md_wrapper.html#bluesky.preprocessors.inject_md_wrapper" title="bluesky.preprocessors.inject_md_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">inject_md_wrapper</span></code></a></td>
<td>Inject additional metadata into a run.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.preprocessors.lazily_stage_decorator.html#bluesky.preprocessors.lazily_stage_decorator" title="bluesky.preprocessors.lazily_stage_decorator"><code class="xref py py-obj docutils literal"><span class="pre">lazily_stage_decorator</span></code></a></td>
<td>This is a preprocessor that inserts ‘stage’ messages and appends ‘unstage’.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.preprocessors.lazily_stage_wrapper.html#bluesky.preprocessors.lazily_stage_wrapper" title="bluesky.preprocessors.lazily_stage_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">lazily_stage_wrapper</span></code></a></td>
<td>This is a preprocessor that inserts ‘stage’ messages and appends ‘unstage’.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.preprocessors.monitor_during_decorator.html#bluesky.preprocessors.monitor_during_decorator" title="bluesky.preprocessors.monitor_during_decorator"><code class="xref py py-obj docutils literal"><span class="pre">monitor_during_decorator</span></code></a></td>
<td>Monitor (asynchronously read) devices during runs.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.preprocessors.monitor_during_wrapper.html#bluesky.preprocessors.monitor_during_wrapper" title="bluesky.preprocessors.monitor_during_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">monitor_during_wrapper</span></code></a></td>
<td>Monitor (asynchronously read) devices during runs.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.preprocessors.relative_set_decorator.html#bluesky.preprocessors.relative_set_decorator" title="bluesky.preprocessors.relative_set_decorator"><code class="xref py py-obj docutils literal"><span class="pre">relative_set_decorator</span></code></a></td>
<td>Interpret ‘set’ messages on devices as relative to initial position.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.preprocessors.relative_set_wrapper.html#bluesky.preprocessors.relative_set_wrapper" title="bluesky.preprocessors.relative_set_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">relative_set_wrapper</span></code></a></td>
<td>Interpret ‘set’ messages on devices as relative to initial position.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.preprocessors.reset_positions_decorator.html#bluesky.preprocessors.reset_positions_decorator" title="bluesky.preprocessors.reset_positions_decorator"><code class="xref py py-obj docutils literal"><span class="pre">reset_positions_decorator</span></code></a></td>
<td>Return movable devices to their initial positions at the end.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.preprocessors.reset_positions_wrapper.html#bluesky.preprocessors.reset_positions_wrapper" title="bluesky.preprocessors.reset_positions_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">reset_positions_wrapper</span></code></a></td>
<td>Return movable devices to their initial positions at the end.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.preprocessors.run_decorator.html#bluesky.preprocessors.run_decorator" title="bluesky.preprocessors.run_decorator"><code class="xref py py-obj docutils literal"><span class="pre">run_decorator</span></code></a></td>
<td>Enclose in ‘open_run’ and ‘close_run’ messages.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.preprocessors.run_wrapper.html#bluesky.preprocessors.run_wrapper" title="bluesky.preprocessors.run_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">run_wrapper</span></code></a></td>
<td>Enclose in ‘open_run’ and ‘close_run’ messages.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.preprocessors.stage_decorator.html#bluesky.preprocessors.stage_decorator" title="bluesky.preprocessors.stage_decorator"><code class="xref py py-obj docutils literal"><span class="pre">stage_decorator</span></code></a></td>
<td>‘Stage’ devices (i.e., prepare them for use, ‘arm’ them) and then unstage.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.preprocessors.stage_wrapper.html#bluesky.preprocessors.stage_wrapper" title="bluesky.preprocessors.stage_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">stage_wrapper</span></code></a></td>
<td>‘Stage’ devices (i.e., prepare them for use, ‘arm’ them) and then unstage.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.preprocessors.subs_decorator.html#bluesky.preprocessors.subs_decorator" title="bluesky.preprocessors.subs_decorator"><code class="xref py py-obj docutils literal"><span class="pre">subs_decorator</span></code></a></td>
<td>Subscribe callbacks to the document stream; finally, unsubscribe.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.preprocessors.subs_wrapper.html#bluesky.preprocessors.subs_wrapper" title="bluesky.preprocessors.subs_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">subs_wrapper</span></code></a></td>
<td>Subscribe callbacks to the document stream; finally, unsubscribe.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.preprocessors.suspend_decorator.html#bluesky.preprocessors.suspend_decorator" title="bluesky.preprocessors.suspend_decorator"><code class="xref py py-obj docutils literal"><span class="pre">suspend_decorator</span></code></a></td>
<td>Install suspenders to the RunEngine, and remove them at the end.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.preprocessors.suspend_wrapper.html#bluesky.preprocessors.suspend_wrapper" title="bluesky.preprocessors.suspend_wrapper"><code class="xref py py-obj docutils literal"><span class="pre">suspend_wrapper</span></code></a></td>
<td>Install suspenders to the RunEngine, and remove them at the end.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="custom-preprocessors">
<h3>Custom Preprocessors<a class="headerlink" href="#custom-preprocessors" title="Permalink to this headline">¶</a></h3>
<p>The preprocessors are implemented using <a class="reference internal" href="generated/bluesky.preprocessors.msg_mutator.html#bluesky.preprocessors.msg_mutator" title="bluesky.preprocessors.msg_mutator"><code class="xref py py-func docutils literal"><span class="pre">msg_mutator()</span></code></a> (for altering
messages in place) and <a class="reference internal" href="generated/bluesky.preprocessors.plan_mutator.html#bluesky.preprocessors.plan_mutator" title="bluesky.preprocessors.plan_mutator"><code class="xref py py-func docutils literal"><span class="pre">plan_mutator()</span></code></a> (for inserting
messages into the plan or removing messages).</p>
<p>It’s easiest to learn this by example, studying the implementations of the built-in
processors (catalogued above) in the
<a class="reference external" href="https://github.com/NSLS-II/bluesky/blob/master/bluesky/plans.py">the source of the plans module</a>.</p>
</div>
</div>
<div class="section" id="customize-step-scans-with-per-step">
<span id="per-step-hook"></span><h2>Customize Step Scans with <code class="docutils literal"><span class="pre">per_step</span></code><a class="headerlink" href="#customize-step-scans-with-per-step" title="Permalink to this headline">¶</a></h2>
<p>The one-dimensional and multi-dimensional plans are composed (1) setup,
(2) a loop over a plan to perform at each position, (3) cleanup.</p>
<p>We provide a hook for customizing step (2). This enables you to write a
variation of an existing plan without starting from scratch.</p>
<p>For one-dimensional plans, the default inner loop is:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bluesky.plan_stubs</span> <span class="kn">import</span> <span class="n">checkpoint</span><span class="p">,</span> <span class="n">abs_set</span><span class="p">,</span> <span class="n">trigger_and_read</span>

<span class="k">def</span> <span class="nf">one_1d_step</span><span class="p">(</span><span class="n">detectors</span><span class="p">,</span> <span class="n">motor</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Inner loop of a 1D step scan</span>

<span class="sd">    This is the default function for ``per_step`` param in 1D plans.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">yield from</span> <span class="n">checkpoint</span><span class="p">()</span>
    <span class="k">yield from</span> <span class="n">abs_set</span><span class="p">(</span><span class="n">motor</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="k">yield from</span> <span class="n">trigger_and_read</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">detectors</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">motor</span><span class="p">]))</span>
</pre></div>
</div>
<p>Some user-defined function, <code class="docutils literal"><span class="pre">custom_step</span></code>, with the same signature can be
used in its place:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">scan</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">motor</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">per_step</span><span class="o">=</span><span class="n">custom_step</span><span class="p">)</span>
</pre></div>
</div>
<p>For convenience, this could be wrapped into the definition of a new plan:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">custom_scan</span><span class="p">(</span><span class="n">detectors</span><span class="p">,</span> <span class="n">motor</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">md</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">yield from</span> <span class="n">scan</span><span class="p">([</span><span class="n">det</span><span class="p">],</span> <span class="n">motor</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">md</span><span class="o">=</span><span class="n">md</span>
                    <span class="n">per_step</span><span class="o">=</span><span class="n">custom_step</span><span class="p">)</span>
</pre></div>
</div>
<p>For multi-dimensional plans, the default inner loop is:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bluesky.utils</span> <span class="kn">import</span> <span class="n">short_uid</span>
<span class="kn">from</span> <span class="nn">bluesky.plan_stubs</span> <span class="kn">import</span> <span class="n">checkpoint</span><span class="p">,</span> <span class="n">abs_set</span><span class="p">,</span> <span class="n">wait</span><span class="p">,</span> <span class="n">trigger_and_read</span>

<span class="k">def</span> <span class="nf">one_nd_step</span><span class="p">(</span><span class="n">detectors</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">pos_cache</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Inner loop of an N-dimensional step scan</span>

<span class="sd">    This is the default function for ``per_step`` param in ND plans.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    detectors : iterable</span>
<span class="sd">        devices to read</span>
<span class="sd">    step : dict</span>
<span class="sd">        mapping motors to positions in this step</span>
<span class="sd">    pos_cache : dict</span>
<span class="sd">        mapping motors to their last-set positions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">move</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">checkpoint</span><span class="p">()</span>
        <span class="n">grp</span> <span class="o">=</span> <span class="n">short_uid</span><span class="p">(</span><span class="s1">&#39;set&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">motor</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">step</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="n">pos_cache</span><span class="p">[</span><span class="n">motor</span><span class="p">]:</span>
                <span class="c1"># This step does not move this motor.</span>
                <span class="k">continue</span>
            <span class="k">yield from</span> <span class="n">abs_set</span><span class="p">(</span><span class="n">motor</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">grp</span><span class="p">)</span>
            <span class="n">pos_cache</span><span class="p">[</span><span class="n">motor</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="k">yield from</span> <span class="n">wait</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">grp</span><span class="p">)</span>

    <span class="n">motors</span> <span class="o">=</span> <span class="n">step</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="k">yield from</span> <span class="n">move</span><span class="p">()</span>
    <span class="k">yield from</span> <span class="n">trigger_and_read</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">detectors</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">motors</span><span class="p">))</span>
</pre></div>
</div>
<p>Likewise, a custom function with the same signature may be passed into the
<code class="docutils literal"><span class="pre">per_step</span></code> argument of any of the multi-dimensional plans.</p>
</div>
<div class="section" id="asynchronous-plans-fly-scans-and-monitoring">
<h2>Asynchronous Plans: “Fly Scans” and “Monitoring”<a class="headerlink" href="#asynchronous-plans-fly-scans-and-monitoring" title="Permalink to this headline">¶</a></h2>
<p>See the section on <a class="reference internal" href="async.html"><span class="doc">Asynchronous Acquisition</span></a> for some context on these terms and, near the
end of the section, some example plans.</p>
</div>
<div class="section" id="plan-utilities">
<span id="plan-utils"></span><h2>Plan Utilities<a class="headerlink" href="#plan-utilities" title="Permalink to this headline">¶</a></h2>
<p>These are useful utilities for defining custom plans and plan preprocessors.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.preprocessors.pchain.html#bluesky.preprocessors.pchain" title="bluesky.preprocessors.pchain"><code class="xref py py-obj docutils literal"><span class="pre">pchain</span></code></a></td>
<td>Like <cite>itertools.chain</cite> but using <cite>yield from</cite></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.preprocessors.msg_mutator.html#bluesky.preprocessors.msg_mutator" title="bluesky.preprocessors.msg_mutator"><code class="xref py py-obj docutils literal"><span class="pre">msg_mutator</span></code></a></td>
<td>A simple preprocessor that mutates or deletes single messages in a plan</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.preprocessors.plan_mutator.html#bluesky.preprocessors.plan_mutator" title="bluesky.preprocessors.plan_mutator"><code class="xref py py-obj docutils literal"><span class="pre">plan_mutator</span></code></a></td>
<td>Alter the contents of a plan on the fly by changing or inserting messages.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.preprocessors.single_gen.html#bluesky.preprocessors.single_gen" title="bluesky.preprocessors.single_gen"><code class="xref py py-obj docutils literal"><span class="pre">single_gen</span></code></a></td>
<td>Turn a single message into a plan</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.preprocessors.make_decorator.html#bluesky.preprocessors.make_decorator" title="bluesky.preprocessors.make_decorator"><code class="xref py py-obj docutils literal"><span class="pre">make_decorator</span></code></a></td>
<td>Turn a generator instance wrapper into a generator function decorator.</td>
</tr>
</tbody>
</table>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/bluesky.plan_stubs.broadcast_msg.html#bluesky.plan_stubs.broadcast_msg" title="bluesky.plan_stubs.broadcast_msg"><code class="xref py py-obj docutils literal"><span class="pre">broadcast_msg</span></code></a></td>
<td>Generate many copies of a mesasge, applying it to a list of devices.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/bluesky.plan_stubs.repeat.html#bluesky.plan_stubs.repeat" title="bluesky.plan_stubs.repeat"><code class="xref py py-obj docutils literal"><span class="pre">repeat</span></code></a></td>
<td>Repeat a plan num times with delay and checkpoint between each repeat.</td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="generated/bluesky.plans.count.html" class="btn btn-neutral float-right" title="bluesky.plans.count" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tutorial.html" class="btn btn-neutral float-left" title="Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Brookhaven National Lab

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>